<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:sfshared="clr-namespace:Syncfusion.Windows.Shared"
    xmlns:theme="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero">


    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Syncfusion.Shared.WPF;component/SkinManager/Brushes.xaml"/>
    </ResourceDictionary.MergedDictionaries>

    <!-- Button -->   


    <ControlTemplate TargetType="{x:Type ButtonBase}" x:Key="Office2003ButtonBaseTemplate">
        <theme:ButtonChrome Name="Chrome" 
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        RenderDefaulted="{TemplateBinding Button.IsDefaulted}"                                        
                                        SnapsToDevicePixels="true">

            <ContentPresenter Margin="{TemplateBinding Padding}"                                                 
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          RecognizesAccessKey="True"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>


        </theme:ButtonChrome>

        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonMouseOverBorderBrush.Blue}"/>
                <Setter TargetName="Chrome" Property="Background" Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonPressedBorderBrush.Blue}"/>
                <Setter TargetName="Chrome" Property="Background" Value="{StaticResource ButtonPressedBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter TargetName="Chrome" Property="Opacity" Value="0.5"/>
            </Trigger>
            <!--<Trigger Property="IsKeyboardFocused"
                                 Value="true">
                <Setter TargetName="Chrome" Property="RenderDefaulted"
                                    Value="True"/>             
            </Trigger>-->
            <!--<MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="Button.IsDefaulted" Value="True"/>
                    <Condition Property="IsKeyboardFocused" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="Chrome" Property="RenderDefaulted"
                                    Value="True"/>
            </MultiTrigger>-->
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- Toggle Button -->

    <ControlTemplate TargetType="{x:Type ToggleButton}" x:Key="Office2003ToggleButtonBaseTemplate">
        <Border Name="Chrome" CornerRadius="4" Background="{TemplateBinding Background}" BorderThickness="{TemplateBinding BorderThickness}"  BorderBrush="{TemplateBinding BorderBrush}">
            <ContentPresenter Margin="{TemplateBinding Padding}"                                                 
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          RecognizesAccessKey="True"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter TargetName="Chrome" Property="Background" Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter TargetName="Chrome" Property="Background" Value="{StaticResource ButtonPressedBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter TargetName="Chrome" Property="Opacity" Value="0.5"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="true">
                <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter TargetName="Chrome" Property="Background" Value="{StaticResource ToggleCheckedBrush.Office2003}"/>
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsMouseOver" Value="True"/>
                    <Condition Property="IsChecked" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter Property="BorderBrush" TargetName="Chrome" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Chrome" Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsPressed" Value="True"/>
                    <Condition Property="IsChecked" Value="True"/>

                </MultiTrigger.Conditions>
                <Setter Property="BorderBrush" TargetName="Chrome" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Chrome" Value="{StaticResource ButtonPressedBrush.Office2003}"/>
            </MultiTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- RepeatButton -->
    <ControlTemplate TargetType="{x:Type ButtonBase}" x:Key="Office2003RepeatButtonBaseTemplate">
        <Border Name="Chrome"  Background="{TemplateBinding Background}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="4"  BorderBrush="{TemplateBinding BorderBrush}">
            <ContentPresenter Margin="{TemplateBinding Padding}"                                                 
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          RecognizesAccessKey="True"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter TargetName="Chrome" Property="Background" Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter TargetName="Chrome" Property="Background" Value="{StaticResource ToggleCheckedBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="False">
                <Setter TargetName="Chrome" Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- CheckBox -->

    <Style x:Key="CheckRadioFocusVisual.Blue">
        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate>
                    <Rectangle Margin="14,0,0,0"
                               StrokeThickness="1"
                               Stroke="Black"
                               StrokeDashArray="1 2"
                               SnapsToDevicePixels="true"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate TargetType="{x:Type CheckBox}" x:Key="Office2003CheckBoxTemplate">
        <BulletDecorator SnapsToDevicePixels="true" Background="Transparent">
            <BulletDecorator.Bullet>
                <Border x:Name="border1" Width="13" Height="13" BorderBrush="{StaticResource CheckBoxOuterBorderBrush.Blue}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}">
                    <Border x:Name="border2" BorderBrush="{StaticResource CheckInnerBorderBrush.Blue}" BorderThickness="1">
                        <Border x:Name="border3" BorderThickness="1" Background="{StaticResource CheckBoxInnerFillBrush.Blue}" BorderBrush="{StaticResource CheckBoxInnerBorderBrush.Blue}">
                            <Canvas SnapsToDevicePixels="True">
                                <Path x:Name="path">
                                    <Path.Data>
                                        <PathGeometry>
                                            <PathFigure StartPoint="2,4">
                                                <LineSegment Point="3,6"/>
                                                <LineSegment Point="5,-1"/>
                                                <LineSegment Point="7,-1"/>
                                                <LineSegment Point="4,8"/>
                                                <LineSegment Point="2,8"/>
                                                <LineSegment Point="0,5"/>
                                            </PathFigure>
                                        </PathGeometry>
                                    </Path.Data>
                                </Path>
                            </Canvas>
                        </Border>
                    </Border>
                </Border>
            </BulletDecorator.Bullet>
            <ContentPresenter Margin="{TemplateBinding Padding}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          RecognizesAccessKey="True"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </BulletDecorator>
        <ControlTemplate.Triggers>
            <Trigger Property="HasContent" Value="true">
                <Setter Property="FocusVisualStyle" Value="{StaticResource CheckRadioFocusVisual.Blue}"/>
                <Setter Property="Padding" Value="4,0,0,0"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="True">
                <Setter Property="Fill" TargetName="path" Value="{StaticResource PathFill.Blue}"/>
            </Trigger>
            <Trigger  Property="IsEnabled" Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsEnabled" Value="True"/>
                    <Condition Property="IsMouseOver" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="border1" Property="BorderBrush" Value="{StaticResource CheckBoxBorderBrushHover.Blue}" />
                <Setter TargetName="border3" Property="BorderBrush" Value="{StaticResource CheckBoxOverInnerBorderBrush.Blue}" />
                <Setter TargetName="border3" Property="Background" Value="{StaticResource ButtonMouseOverBrush.Office2003}" />
            </MultiTrigger>
            <!--<Trigger Property="IsMouseOver" Value="True">                
                <Setter TargetName="border1"  Property="Background" Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                <Setter TargetName="border1"  Property="BorderBrush" Value="{StaticResource CheckBoxBorderBrushHover.Blue}"/>
            </Trigger>-->
            <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="border1" Property="BorderBrush" Value="{StaticResource CheckBoxBorderBrushHover.Blue}" />

                <Setter TargetName="border3"  Property="BorderBrush" Value="{StaticResource PressedBorderBrush.Blue}"/>
                <Setter TargetName="border3" Property="Background" Value="{StaticResource PressedBackgroundBrush.Blue}"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="{x:Null}">
                <Setter TargetName="border3" Property="Background" Value="{StaticResource PathFill.Blue}" />
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- ComboBox -->

    <Geometry x:Key="DownArrowGeometry">M 0 0 L 3.5 4 L 7 0 Z</Geometry>

    <Style x:Key="BlueComboBoxEditableTextBox"
           TargetType="{x:Type TextBox}">
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="AllowDrop"
                Value="true"/>
        <Setter Property="MinWidth"
                Value="0"/>
        <Setter Property="MinHeight"
                Value="0"/>
        <Setter Property="FocusVisualStyle"
                Value="{x:Null}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type TextBox}">
                    <ScrollViewer x:Name="PART_ContentHost"
                                  Focusable="false"
                                  HorizontalScrollBarVisibility="Hidden"
                                  VerticalScrollBarVisibility="Hidden"
                                  Background="Transparent"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="Office2003ComboBoxReadonlyToggleButton"
           TargetType="{x:Type ToggleButton}">
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="IsTabStop"
                Value="false"/>
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Background"
                Value="{StaticResource ComboBoxBackground.Blue}"/>
        <Setter Property="BorderBrush"
                Value="{StaticResource ButtonBorderBrush.Office2003}"/>
        <Setter Property="ClickMode"
                Value="Press"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">

                    <Border Name="Chrome1"  BorderThickness="{TemplateBinding BorderThickness}"                               
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"                                       
                                        SnapsToDevicePixels="true">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto" SharedSizeGroup="ComboBoxButton"/>
                            </Grid.ColumnDefinitions>

                            <Border Name="Chrome"  Background="{TemplateBinding Background}" BorderThickness="0"
                                        BorderBrush="{TemplateBinding BorderBrush}"  Grid.Column="1" Width="16">

                                <Path Name="Arrow"                                  
                                  Fill="{StaticResource PathFill.Blue}"
                                  Data="{StaticResource DownArrowGeometry}"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"/>
                            </Border>
                        </Grid>
                    </Border>

                    <ControlTemplate.Triggers>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver"
                                           Value="true" SourceName="Chrome"/>
                                <Condition Property="IsChecked"
                                           Value="True"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonMouseOverBorderBrush.Blue}"/>
                            <Setter TargetName="Chrome" Property="BorderThickness" Value="1,0,0,0"/>

                            <Setter TargetName="Chrome"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                        </MultiTrigger>

                        <Trigger Property="IsChecked"
                                 Value="true">
                            <Setter TargetName="Chrome"
                                    Property="BorderBrush"
                                    Value="{StaticResource ButtonPressedBorderBrush.Blue}"/>
                            <Setter TargetName="Chrome"
                                    Property="Background"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" SourceName="Chrome1" Value="True">
                            <Setter TargetName="Chrome1" Property="BorderThickness" Value="1"/>
                            <Setter TargetName="Chrome" Property="BorderThickness" Value="1,0,0,0"/>

                            <Setter TargetName="Chrome" Property="Background" Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                            <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                            <Setter TargetName="Chrome1" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                            <Setter TargetName="Chrome1" Property="Background" Value="White"/>



                        </Trigger>
                        <Trigger Property="IsKeyboardFocusWithin" SourceName="Chrome1" Value="True">
                            <Setter TargetName="Chrome1" Property="BorderThickness" Value="1"/>
                            <Setter TargetName="Chrome" Property="BorderThickness" Value="1,0,0,0"/>

                            <Setter TargetName="Chrome" Property="Background" Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                            <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                            <Setter TargetName="Chrome1" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                            <Setter TargetName="Chrome1" Property="Background" Value="White"/>



                        </Trigger>

                        <Trigger Property="IsPressed" Value="true">
                            <Setter TargetName="Chrome"
                                    Property="Background"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
                            <Setter TargetName="Chrome" Property="BorderThickness" Value="1,0,0,0"/>
                            <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonPressedBorderBrush.Blue}"/>

                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>

                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ComboBoxButtonStyleBlue"
           TargetType="{x:Type ToggleButton}">
        <Setter Property="MinWidth"
                Value="0"/>
        <Setter Property="MinHeight"
                Value="0"/>
        <Setter Property="Width"
                Value="Auto"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Background"
                Value="{StaticResource ComboBoxBackground.Blue}"/>
        <Setter Property="BorderBrush"
                Value="{StaticResource ButtonBorderBrush.Office2003}"/>
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="ClickMode"
                Value="Press"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Grid >
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"
                                              SharedSizeGroup="ComboBoxButton"/>
                        </Grid.ColumnDefinitions>
                        <Border x:Name="Chrome" 
                                Grid.Column="1"
                                Width="16"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="true">
                            <Path x:Name="ArrowDownPath"
                                  Data="{StaticResource DownArrowGeometry}"
                                  Fill="{StaticResource PathFill.Blue}"
                                  VerticalAlignment="Center" HorizontalAlignment="Center"/>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter TargetName="Chrome"
                                    Property="BorderBrush"
                                    Value="{x:Null}"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver"
                                           Value="true"/>
                                <Condition Property="IsChecked"
                                           Value="false"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                            <Setter TargetName="Chrome"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                        </MultiTrigger>

                        <Trigger Property="IsChecked"
                                 Value="true">
                            <Setter TargetName="Chrome"
                                    Property="BorderBrush"
                                    Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                            <Setter TargetName="Chrome"
                                    Property="Background"
                                    Value="{StaticResource ToggleCheckedBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="true">
                            <Setter TargetName="Chrome"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>




    <ControlTemplate x:Key="Office2003ComboBoxEditableTemplate"
                     TargetType="{x:Type ComboBox}">
        <Grid Name="Placement" Background="{TemplateBinding Background}"
              SnapsToDevicePixels="true">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Popup Name="PART_Popup"
                   Grid.ColumnSpan="2"
                   AllowsTransparency="true"
                   Placement="Bottom"
                   IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                   PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}">
                <theme:SystemDropShadowChrome Name="Shdw"
                                              Color="Transparent" 
                                              MinWidth="{Binding ElementName=Placement,Path=ActualWidth}"
                                              MaxHeight="{TemplateBinding MaxDropDownHeight}">
                    <Border x:Name="DropDownBorder"
                            BorderThickness="1"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            Background="{TemplateBinding Background}">
                        <ScrollViewer>
                            <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Contained"
                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        </ScrollViewer>
                    </Border>
                </theme:SystemDropShadowChrome>
            </Popup>

            <Border x:Name="Border"
                                 Grid.ColumnSpan="2"
                                 BorderThickness="{TemplateBinding BorderThickness}"
                                 BorderBrush="{TemplateBinding BorderBrush}"
                                 Background="{TemplateBinding Background}"/>
            <TextBox Name="PART_EditableTextBox"
                     Margin="{TemplateBinding Padding}"
                     Style="{StaticResource BlueComboBoxEditableTextBox}"
                     IsReadOnly="{Binding Path=IsReadOnly,RelativeSource={RelativeSource TemplatedParent}}"
                     HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                     VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
            <ToggleButton Grid.Column="1" Name="Tb1" BorderBrush="{TemplateBinding BorderBrush}"
                          Style="{StaticResource ComboBoxButtonStyleBlue}"
                          IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}"/>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsKeyboardFocusWithin"
                     Value="true">
                <Setter Property="Foreground"
                        Value="Black"/>
            </Trigger>

            <Trigger Property="HasItems"
                     Value="false">
                <Setter TargetName="DropDownBorder"
                        Property="Height"
                        Value="95"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Tb1" Property="Background" Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                <Setter TargetName="Tb1" Property="BorderBrush" Value="{StaticResource ButtonMouseOverBorderBrush.Blue}"/>
                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter TargetName="Border" Property="Background" Value="White" />
                <Setter TargetName="PART_EditableTextBox" Property="Background" Value="White"/>

            </Trigger>
            <Trigger Property="IsEnabled"
                     Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <Trigger Property="IsGrouping"
                     Value="true">
                <Setter Property="ScrollViewer.CanContentScroll"
                        Value="false"/>
            </Trigger>
            <Trigger SourceName="PART_Popup"
                     Property="Popup.HasDropShadow"
                     Value="true">
                <Setter TargetName="Shdw"
                        Property="Margin"
                        Value="0,0,5,5"/>
                <Setter TargetName="Shdw"
                        Property="Color"
                        Value="#71000000"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>






    <ControlTemplate TargetType="{x:Type ComboBox}" x:Key="Office2003ComboBoxTemplate">
        <Grid Name="MainGrid"
                          SnapsToDevicePixels="true">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" 
                                              Width="0"/>
            </Grid.ColumnDefinitions>
            <Popup Name="PART_Popup"
                               AllowsTransparency="true"
                               Grid.ColumnSpan="2"
                               Placement="Bottom"
                               Margin="1"
                               IsOpen="{Binding Path=IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
                               PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}">
                <theme:SystemDropShadowChrome Name="Shdw"
                                                          Color="Transparent" 
                                                          MinWidth="{Binding ElementName=MainGrid,Path=ActualWidth}"
                                                          MaxHeight="{TemplateBinding MaxDropDownHeight}">
                    <Border x:Name="DropDownBorder"
                                        BorderThickness="1"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        Background="{TemplateBinding Background}">
                        <ScrollViewer CanContentScroll="true">
                            <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Contained"
                                                        SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        </ScrollViewer>
                    </Border>
                </theme:SystemDropShadowChrome>
            </Popup>
            <ToggleButton Grid.ColumnSpan="2" Name="DropDownButton" BorderThickness="{TemplateBinding BorderThickness}"
                                      Background="{TemplateBinding Background}"
                                      BorderBrush="{TemplateBinding BorderBrush}"
                                      Style="{StaticResource Office2003ComboBoxReadonlyToggleButton}"
                                      IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}"/>
            <ContentPresenter IsHitTestVisible="false"
                                          Margin="{TemplateBinding Padding}"
                                          Content="{TemplateBinding SelectionBoxItem}"
                                          ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Grid>

        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>


            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="DropDownButton" Property="BorderThickness" Value="1"/>
                <Setter TargetName="DropDownButton" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsKeyboardFocusWithin" Value="True">
                <Setter TargetName="DropDownButton" Property="BorderThickness" Value="1"/>
                <Setter TargetName="DropDownButton" Property="BorderBrush" Value="{StaticResource ButtonBorderBrush.Office2003}"/>



            </Trigger>




            <Trigger SourceName="PART_Popup"
                                 Property="Popup.HasDropShadow"
                                 Value="true">
                <Setter TargetName="Shdw"
                                    Property="Margin"
                                    Value="0,0,5,5"/>
                <Setter TargetName="Shdw"
                                    Property="SnapsToDevicePixels"
                                    Value="true"/>
                <Setter TargetName="Shdw"
                                    Property="Color"
                                    Value="#71000000"/>

            </Trigger>

            <Trigger Property="HasItems"
                                 Value="false">
                <Setter TargetName="DropDownBorder"
                                    Property="MinHeight"
                                    Value="95"/>
            </Trigger>
            <Trigger Property="IsGrouping"
                                 Value="true">
                <Setter Property="ScrollViewer.CanContentScroll"
                                    Value="false"/>
            </Trigger>
            <Trigger Property="IsEditable"
                                 Value="true">
                <Setter Property="Padding"
                                    Value="2"/>
                <Setter Property="IsTabStop"
                                    Value="false"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>




    <ControlTemplate TargetType="{x:Type ComboBoxItem}" x:Key="Office2003ComboBoxItemTemplate">
        <Border Name="Bd" CornerRadius="4" Margin="2"
                            Background="{TemplateBinding Background}"
                            BorderBrush="Transparent" 
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="true">
            <ContentPresenter Margin="2" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsHighlighted" Value="true">
                <Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Bd" Value="{StaticResource MouseOverBrushIn.Office2003}"/>
            </Trigger>
            <Trigger Property="IsEnabled" Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>


    <ControlTemplate TargetType="{x:Type RadioButton}" x:Key="Office2003RadioButtonTemplate">
        <BulletDecorator Background="Transparent">
            <BulletDecorator.Bullet>
                <Canvas Name="canvas" Width="13" Height="13">
                    <Ellipse x:Name="ellipse1" Width="13" Height="13" Fill="{TemplateBinding Background}" StrokeThickness="{TemplateBinding BorderThickness}" Stroke="{TemplateBinding BorderBrush}">
                    </Ellipse>
                    <Ellipse x:Name="ellipse2" Fill="{StaticResource CheckInnerBorderBrush.Blue}" Canvas.Left="2" Canvas.Top="2" Width="9" Height="9">
                    </Ellipse>
                    <Ellipse x:Name="ellipse3" Fill="{StaticResource CheckBoxInnerFillBrush.Blue}" StrokeThickness="1" Canvas.Left="3" Canvas.Top="3" Width="7" Height="7">
                    </Ellipse>
                    <Ellipse x:Name="ellipse" Canvas.Left="4" Canvas.Top="4" Width="5" Height="5">
                    </Ellipse>
                </Canvas>
            </BulletDecorator.Bullet>
            <ContentPresenter Margin="{TemplateBinding Padding}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          RecognizesAccessKey="True"/>
        </BulletDecorator>
        <ControlTemplate.Triggers>
            <Trigger Property="HasContent"
                                 Value="true">
                <Setter Property="FocusVisualStyle" Value="{StaticResource CheckRadioFocusVisual.Blue}"/>
                <Setter Property="Padding" Value="4,0,0,0"/>
            </Trigger>
            <Trigger  Property="IsEnabled" Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <Trigger Property="IsChecked" Value="True">
                <Setter Property="Fill" TargetName="ellipse" Value="{StaticResource PathFill.Blue}"/>
            </Trigger>
            <Trigger Property="IsPressed" Value="True">
                <Setter TargetName="ellipse1" Property="Stroke" Value="{StaticResource CheckBoxBorderBrushHover.Blue}" />
                <Setter TargetName="ellipse2" Property="Fill" Value="{StaticResource PressedBorderBrush.Blue}"/>
                <Setter TargetName="ellipse3" Property="Fill" Value="{StaticResource PressedBackgroundBrush.Blue}" />
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsEnabled" Value="True"/>
                    <Condition Property="IsMouseOver" Value="True"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="ellipse1" Property="Stroke" Value="{StaticResource CheckBoxBorderBrushHover.Blue}" />
                <Setter TargetName="ellipse2" Property="Fill" Value="{StaticResource CheckInnerBorderBrush.Blue}" />
                <Setter TargetName="ellipse3" Property="Fill" Value="{StaticResource ButtonMouseOverBrush.Office2003}" />
            </MultiTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- ListBox -->

    <ControlTemplate TargetType="{x:Type ListBox}" x:Key="Office2003ListBoxTemplate">
        <Border Name="Bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="true"
                            Padding="1">
            <ScrollViewer Padding="{TemplateBinding Padding}"
                                      Focusable="false">
                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            </ScrollViewer>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <Trigger Property="IsGrouping"
                                 Value="true">
                <Setter Property="ScrollViewer.CanContentScroll"
                                    Value="false"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="true">
                <Setter Property="Background" TargetName="Bd" Value="{StaticResource ListBoxMouseOver.Blue}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- ListBoxItem -->
    <ControlTemplate TargetType="{x:Type ListBoxItem}" x:Key="Office2003ListBoxItemTemplate">
        <Border Name="Bd" CornerRadius="2" 
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="1"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="true">
            <ContentPresenter  Margin="2" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsSelected"
                                 Value="true">
                <Setter TargetName="Bd"
                                    Property="Background"
                                    Value="{StaticResource MouseOverBrushIn.Office2003}"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource BorderBrush.Office2003}"/>

            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="true"/>
                    <Condition Property="Selector.IsSelectionActive"
                                           Value="false"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="Bd"
                                    Property="Background"
                                    Value="{StaticResource MouseOverBrushIn.Office2003}"/>
                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource BorderBrush.Office2003}"/>

            </MultiTrigger>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="Background" Value="{StaticResource MouseOverBrushIn.Office2003}"/>
                <Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource BorderBrush.Office2003}"/>
            </Trigger>

        </ControlTemplate.Triggers>
    </ControlTemplate>


    <!-- Menu -->
    <MenuScrollingVisibilityConverter x:Key="MenuScrollingVisibilityConverter"/>

    <Geometry x:Key="DownArrow">M 0,0 L 3.5,4 L 7,0 Z</Geometry>
    <Geometry x:Key="UpArrow">M 0,4 L 3.5,0 L 7,4 Z</Geometry>
    <Geometry x:Key="RightArrow">M 0,0 L 4,3.5 L 0,7 Z</Geometry>
    <Geometry x:Key="ToolBarCheckmark">M 0,2.5 L 2.5,5 L 7,0.5</Geometry>
    <Geometry x:Key="Checkmark">M 0,5.1 L 1.7,5.2 L 3.4,7.1 L 8,0.4 L 9.2,0 L 3.3,10.8 Z</Geometry>

    <ControlTemplate x:Key="BlueSubmenuContent"
                     TargetType="{x:Type ContentControl}">
        <Border Background="#F5F5F5"
                BorderBrush="#868686"
                BorderThickness="1" CornerRadius="3,3,3,3">
            <Grid>
                <Rectangle Fill="{StaticResource MenuItemLeftBarBackground.Blue}"
                           HorizontalAlignment="Left"
                           Width="28"
                           Margin="2"
                           RadiusX="2"
                           RadiusY="2"/>
                <Rectangle HorizontalAlignment="Left"
                                           Width="1"
                                           Margin="30,2,0,2"
                                           Fill="{StaticResource MenuItemBorderBrush.Blue}"/>
                <Rectangle HorizontalAlignment="Left"
                           Width="1"
                           Margin="32,2,0,2"
                           Fill="#FAFAFA"/>

                <ContentPresenter Grid.ColumnSpan="2" Margin="3"/>
            </Grid>
        </Border>
    </ControlTemplate>

    <Style x:Key="MenuScrollButton"
           TargetType="{x:Type RepeatButton}"
           BasedOn="{x:Null}">
        <Setter Property="ClickMode"
                Value="Hover"/>
        <Setter Property="MinWidth"
                Value="0"/>
        <Setter Property="MinHeight"
                Value="0"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <DockPanel Background="Transparent"
                               SnapsToDevicePixels="true">
                        <Rectangle DockPanel.Dock="Right"
                                   x:Name="R1"
                                   Width="1"
                                   Fill="Transparent"/>
                        <Rectangle DockPanel.Dock="Bottom"
                                   x:Name="B1"
                                   Height="1"
                                   Fill="Transparent"/>
                        <Rectangle DockPanel.Dock="Left"
                                   x:Name="L1"
                                   Width="1"
                                   Fill="Transparent"/>
                        <Rectangle DockPanel.Dock="Top"
                                   x:Name="T1"
                                   Height="1"
                                   Fill="Transparent"/>
                        <ContentPresenter x:Name="ContentContainer"
                                          Margin="2,2,2,2"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="Center"/>
                    </DockPanel>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsPressed"
                                 Value="true">
                            <Setter TargetName="R1"
                                    Property="Fill"
                                    Value="{DynamicResource {x:Static SystemColors.ControlLightLightBrushKey}}"/>
                            <Setter TargetName="B1"
                                    Property="Fill"
                                    Value="{DynamicResource {x:Static SystemColors.ControlLightLightBrushKey}}"/>
                            <Setter TargetName="L1"
                                    Property="Fill"
                                    Value="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}"/>
                            <Setter TargetName="T1"
                                    Property="Fill"
                                    Value="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}"/>
                            <Setter TargetName="ContentContainer"
                                    Property="Margin"
                                    Value="3,3,1,1"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <Style x:Key="{ComponentResourceKey TypeInTargetAssembly={x:Type FrameworkElement}, ResourceId=MenuScrollViewer}"
           TargetType="{x:Type ScrollViewer}"
           BasedOn="{x:Null}">
        <Setter Property="HorizontalScrollBarVisibility"
                Value="Hidden"/>
        <Setter Property="VerticalScrollBarVisibility"
                Value="Auto"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ScrollViewer}">
                    <Grid SnapsToDevicePixels="true">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Border Grid.Row="1"
                                Grid.Column="0">
                            <ScrollContentPresenter Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <RepeatButton
                                      Style="{StaticResource MenuScrollButton}"
                                      Grid.Row="0"
                                      Grid.Column="0"
                                      Command="{x:Static ScrollBar.LineUpCommand}"
                                      CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                      Focusable="false">
                            <RepeatButton.Visibility>
                                <MultiBinding FallbackValue="Visibility.Collapsed"
                                              Converter="{StaticResource MenuScrollingVisibilityConverter}"
                                              ConverterParameter="0">
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}"
                                             Path="ComputedVerticalScrollBarVisibility"/>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}"
                                             Path="VerticalOffset"/>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}"
                                             Path="ExtentHeight"/>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}"
                                             Path="ViewportHeight"/>
                                </MultiBinding>
                            </RepeatButton.Visibility>
                            <Path Fill="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}"
                                  Data="{StaticResource UpArrow}"/>
                        </RepeatButton>
                        <RepeatButton
                                      Style="{StaticResource MenuScrollButton}"
                                      Grid.Row="2"
                                      Grid.Column="0"
                                      Command="{x:Static ScrollBar.LineDownCommand}"
                                      CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}"
                                      Focusable="false">
                            <RepeatButton.Visibility>
                                <MultiBinding FallbackValue="Visibility.Collapsed"
                                              Converter="{StaticResource MenuScrollingVisibilityConverter}"
                                              ConverterParameter="100">
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}"
                                             Path="ComputedVerticalScrollBarVisibility"/>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}"
                                             Path="VerticalOffset"/>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}"
                                             Path="ExtentHeight"/>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}"
                                             Path="ViewportHeight"/>
                                </MultiBinding>
                            </RepeatButton.Visibility>
                            <Path Fill="{DynamicResource {x:Static SystemColors.MenuTextBrushKey}}"
                                  Data="{StaticResource DownArrow}"/>
                        </RepeatButton>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <ControlTemplate  x:Key="MenuTemplateOffice2003" TargetType="{x:Type Menu}">
        <ControlTemplate.Resources>
            <Style x:Key="{x:Static MenuItem.SeparatorStyleKey}" TargetType="{x:Type Separator}">

                <Setter Property="Border.BorderThickness" Value="0,0,0,1"/>
                <Setter Property="FrameworkElement.MinHeight" Value="2"/>
                <Setter Property="UIElement.SnapsToDevicePixels" Value="True"/>
                <Setter Property="Height" Value="1" />
                <Setter Property="Margin" Value="26,2,2,2"/>
                <Setter Property="Background" Value="{StaticResource ButtonBorderBrush.Office2003}"/>

                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Separator">
                            <Border Margin="{TemplateBinding Padding}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" SnapsToDevicePixels="True" />
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <!--<Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Foreground" Value="Red" />
                    </Trigger>
                </Style.Triggers>-->
            </Style>
            <!--<Style x:Key="{x:Type Menu}" TargetType="{x:Type Menu}">
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Foreground" Value="Red"/>  
                    </Trigger>
                </Style.Triggers>
            </Style>-->
            <Style x:Key="{x:Type MenuItem}"
                   TargetType="{x:Type MenuItem}">
                <Setter Property="OverridesDefaultStyle" 
                        Value="true" />
                <Setter Property="HorizontalContentAlignment"
                        Value="{Binding Path=HorizontalContentAlignment,RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
                <Setter Property="VerticalContentAlignment"
                        Value="{Binding Path=VerticalContentAlignment,RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
                <Setter Property="Background"
                        Value="Transparent"/>
                <Setter Property="Foreground"
                        Value="{StaticResource ForegroundBrush.Blue}"/>
                <Setter Property="BorderThickness"
                        Value="1"/>
                <Setter Property="Margin"
                        Value="0,1,0,0"/>
                <Setter Property="Padding"
                        Value="8,3,8,3"/>
                <Setter Property="DockPanel.Dock"
                        Value="Top"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type MenuItem}">
                            <Grid Background="Transparent"
                                  SnapsToDevicePixels="true">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition MinWidth="24"
                                                      Width="Auto"
                                                      SharedSizeGroup="MenuItemIconColumnGroup"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"
                                                      SharedSizeGroup="MenuItemIGTColumnGroup"/>
                                    <ColumnDefinition Width="14"/>
                                </Grid.ColumnDefinitions>
                                <Border Name="Border"
                                        Background="{TemplateBinding Background}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        Grid.ColumnSpan="4"
                                        Margin="1,0"/>
                                <ContentPresenter x:Name="Icon"
                                                  Margin="0"
                                                  VerticalAlignment="Center"
                                                  ContentSource="Icon"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                <Border Name="GlyphPanel"
                                        Margin="0,1"
                                        Width="20"
                                        Height="20"
                                        Visibility="Hidden"
                                        BorderBrush="{StaticResource BorderBrush.Office2003}"
                                        Background="#FFFFA600"
                                        BorderThickness="1">
                                    <Path VerticalAlignment="Center"
                                          HorizontalAlignment="Center"
                                          FlowDirection="LeftToRight"
                                          Stroke="{TemplateBinding Foreground}"
                                          StrokeThickness="1.2"
                                          Data="{StaticResource ToolBarCheckmark}"/>
                                </Border>

                                <ContentPresenter Grid.Column="1"
                                                  ContentSource="Header" Name="content"
                                                  Margin="{TemplateBinding Padding}"
                                                  RecognizesAccessKey="True"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                <TextBlock Grid.Column="2"
                                           Text="{TemplateBinding InputGestureText}"
                                           Margin="4,3,2,3" 
                                           HorizontalAlignment="Right"/>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="Icon"
                                         Value="{x:Null}">
                                    <Setter TargetName="Icon"
                                            Property="Visibility"
                                            Value="Collapsed"/>
                                </Trigger>
                                <Trigger Property="IsChecked"
                                         Value="true">
                                    <Setter TargetName="GlyphPanel"
                                            Property="Visibility"
                                            Value="Visible"/>
                                    <Setter TargetName="Icon"
                                            Property="Visibility"
                                            Value="Collapsed"/>
                                </Trigger>
                                <Trigger Property="IsHighlighted"
                                         Value="true">
                                    <Setter TargetName="Border"
                                            Property="BorderBrush"
                                            Value="{StaticResource BorderBrush.Office2003}"/>
                                    <Setter TargetName="Border"
                                            Property="Background"
                                            Value="#83FFD152"/>
                                    <Setter TargetName="GlyphPanel"
                                            Property="BorderBrush"
                                            Value="{StaticResource BorderBrush.Office2003}"/>
                                    <Setter TargetName="GlyphPanel"
                                            Property="Background"
                                            Value="{StaticResource BorderBrush.Office2003}"/>
                                    <Setter TargetName="content" Property="TextBlock.Foreground" Value="{StaticResource ForegroundBrush.Blue}"/>
                                </Trigger>
                                <Trigger Property="IsEnabled"
                                         Value="false">
                                    <Setter Property="Foreground"
                                            Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>

                    <Trigger Property="Role"
                             Value="TopLevelHeader">
                        <Setter Property="Padding"
                                Value="6,2,7,2"/>
                        <Setter Property="Grid.IsSharedSizeScope"
                                Value="true"/>
                        <Setter Property="Foreground" Value="{StaticResource ForegroundBrush.Blue}"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type MenuItem}">
                                    <Border Name="Border"
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="1"
                                            SnapsToDevicePixels="true">
                                        <DockPanel Name="Header">
                                            <ContentPresenter x:Name="Icon"
                                                              Margin="4,0,6,0"
                                                              VerticalAlignment="Center"
                                                              ContentSource="Icon"
                                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                            <Path x:Name="GlyphPanel"
                                                  Margin="4,0,6,0"
                                                  Visibility="Collapsed"
                                                  VerticalAlignment="Center"
                                                  FlowDirection="LeftToRight"
                                                  Stroke="{TemplateBinding Foreground}"
                                                  StrokeThickness="1.2"
                                                  Data="{StaticResource ToolBarCheckmark}"/>
                                            <ContentPresenter ContentSource="Header" Name="content"
                                                              Margin="{TemplateBinding Padding}"
                                                              RecognizesAccessKey="True"
                                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                            <Popup x:Name="PART_Popup"
                                                   Placement="Bottom"
                                                   HorizontalOffset="-1"
                                                   IsOpen="{Binding Path=IsSubmenuOpen,RelativeSource={RelativeSource TemplatedParent}}"
                                                   Focusable="false"
                                                   PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"
                                                   AllowsTransparency="true">
                                                <theme:SystemDropShadowChrome Name="Shdw"
                                                                              Color="Transparent">
                                                    <Border Background="#F5F5F5"   BorderBrush="{StaticResource ButtonBorderBrush.Office2003}"
                                                            BorderThickness="1">
                                                        <Grid Grid.IsSharedSizeScope="true">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition MinWidth="24"
                                                                                  Width="Auto"
                                                                                  SharedSizeGroup="MenuItemIconColumnGroup"/>
                                                                <ColumnDefinition Width="*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Rectangle Fill="{StaticResource MenuItemLeftBarBackground.Blue}"
                                                                       Margin="0,1"/>
                                                            <Rectangle Fill="{StaticResource MenuItemBorderBrush.Blue}"
                                                                       Grid.ColumnSpan="2"
                                                                       Margin="0,-1,0,0"
                                                                       VerticalAlignment="Top"
                                                                       HorizontalAlignment="Left"
                                                                       Height="1"
                                                                       Width="{Binding ElementName=Header, Path=ActualWidth}" />
                                                            <ScrollViewer CanContentScroll="true"
                                                                          Style="{DynamicResource {ComponentResourceKey TypeInTargetAssembly={x:Type FrameworkElement}, ResourceId=MenuScrollViewer}}"
                                                                          Grid.ColumnSpan="2">
                                                                <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                                KeyboardNavigation.TabNavigation="Cycle"
                                                                                Margin="0,0,0,1"
                                                                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                                            </ScrollViewer>
                                                        </Grid>
                                                    </Border>
                                                </theme:SystemDropShadowChrome>
                                            </Popup>
                                        </DockPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSuspendingPopupAnimation"
                                                 Value="true">
                                            <Setter TargetName="PART_Popup"
                                                    Property="PopupAnimation"
                                                    Value="None"/>
                                        </Trigger>
                                        <Trigger Property="Icon"
                                                 Value="{x:Null}">
                                            <Setter TargetName="Icon"
                                                    Property="Visibility"
                                                    Value="Collapsed"/>
                                        </Trigger>
                                        <Trigger Property="IsChecked"
                                                 Value="true">
                                            <Setter TargetName="GlyphPanel"
                                                    Property="Visibility"
                                                    Value="Visible"/>
                                            <Setter TargetName="Icon"
                                                    Property="Visibility"
                                                    Value="Collapsed"/>
                                        </Trigger>
                                        <Trigger Property="IsHighlighted"
                                                 Value="true">
                                            <Setter TargetName="Border"
                                                    Property="BorderBrush"
                                                    Value="{StaticResource BorderBrush.Office2003}"/>
                                            <Setter TargetName="Border"
                                                    Property="Background"
                                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                                            <Setter TargetName="content" Property="TextBlock.Foreground" Value="{StaticResource ForegroundBrush.Blue}"/>
                                        </Trigger>
                                        <Trigger Property="IsSubmenuOpen"
                                                 Value="true">
                                            <Setter TargetName="Border"
                                                    Property="BorderBrush"
                                                    Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                                            <Setter TargetName="Border"
                                                    Property="Background"
                                                    Value="{StaticResource ToolBarButtonHover.Blue}"/>
                                        </Trigger>
                                        <Trigger SourceName="PART_Popup"
                                                  Property="Popup.HasDropShadow"
                                                  Value="true">
                                            <Setter TargetName="Shdw"
                                                     Property="Margin"
                                                     Value="0,0,5,5"/>
                                            <Setter TargetName="Shdw"
                                                     Property="SnapsToDevicePixels"
                                                     Value="true"/>
                                            <Setter TargetName="Shdw"
                                                     Property="Color"
                                                     Value="#71000000"/>
                                        </Trigger>
                                        <Trigger Property="IsKeyboardFocused"
                                                 Value="true">
                                            <Setter TargetName="Border"
                                                    Property="BorderBrush"
                                                    Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                                            <Setter TargetName="Border"
                                                    Property="Background"
                                                    Value="{StaticResource ToolBarButtonHover.Blue}"/>
                                        </Trigger>
                                        <Trigger Property="IsEnabled"
                                                 Value="false">
                                            <Setter Property="Opacity" Value="0.5"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                    <Trigger Property="Role"
                             Value="TopLevelItem">
                        <Setter Property="Margin"
                                Value="0,1,0,1"/>
                        <Setter Property="Padding"
                                Value="7,1,8,2"/>
                        <Setter Property="Foreground" Value="{StaticResource ForegroundBrush.Blue}"/>

                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type MenuItem}">
                                    <Border Name="Border"
                                            Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="1"
                                            SnapsToDevicePixels="true">
                                        <DockPanel>
                                            <ContentPresenter x:Name="Icon"
                                                              Margin="4,0,6,0"
                                                              VerticalAlignment="Center"
                                                              ContentSource="Icon"
                                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                            <Path x:Name="GlyphPanel"
                                                  Margin="4,0,6,0"
                                                  Visibility="Collapsed"
                                                  VerticalAlignment="Center"
                                                  FlowDirection="LeftToRight"
                                                  Stroke="{TemplateBinding Foreground}"
                                                  StrokeThickness="1.2"
                                                  Data="{StaticResource ToolBarCheckmark}"/>
                                            <ContentPresenter ContentSource="Header" Name="content"
                                                              Margin="{TemplateBinding Padding}"
                                                              RecognizesAccessKey="True"
                                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                        </DockPanel>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="Icon"
                                                 Value="{x:Null}">
                                            <Setter TargetName="Icon"
                                                    Property="Visibility"
                                                    Value="Collapsed"/>
                                        </Trigger>
                                        <Trigger Property="IsChecked"
                                                 Value="true">
                                            <Setter TargetName="GlyphPanel"
                                                    Property="Visibility"
                                                    Value="Visible"/>
                                            <Setter TargetName="Icon"
                                                    Property="Visibility"
                                                    Value="Collapsed"/>
                                        </Trigger>
                                        <Trigger Property="IsHighlighted"
                                                 Value="true">
                                            <Setter TargetName="Border"
                                                    Property="BorderBrush"
                                                    Value="{StaticResource BorderBrush.Office2003}"/>
                                            <Setter TargetName="Border"
                                                    Property="Background"
                                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                                            <Setter TargetName="content" Property="TextBlock.Foreground" Value="{StaticResource ForegroundBrush.Blue}"/>
                                        </Trigger>
                                        <Trigger Property="IsKeyboardFocused"
                                                 Value="true">
                                            <Setter TargetName="Border"
                                                    Property="BorderBrush"
                                                    Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                                            <Setter TargetName="Border"
                                                    Property="Background"
                                                    Value="{StaticResource ToolBarButtonHover.Blue}"/>
                                        </Trigger>
                                        <Trigger Property="IsEnabled"
                                                 Value="false">
                                            <Setter Property="Opacity" Value="0.5"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                    <Trigger Property="Role"
                             Value="SubmenuHeader">
                        <Setter Property="DockPanel.Dock"
                                Value="Top"/>
                        <Setter Property="Padding"
                                Value="8,3,8,3"/>
                        <Setter Property="Grid.IsSharedSizeScope"
                                Value="true"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type MenuItem}">
                                    <Grid Background="Transparent"
                                          SnapsToDevicePixels="true">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition MinWidth="24"
                                                              Width="Auto"
                                                              SharedSizeGroup="MenuItemIconColumnGroup"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"
                                                              SharedSizeGroup="MenuItemIGTColumnGroup"/>
                                            <ColumnDefinition Width="14"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Name="Border"
                                                Background="{TemplateBinding Background}"
                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                Grid.ColumnSpan="4"
                                                Margin="1,0"/>
                                        <ContentPresenter x:Name="Icon"
                                                          Margin="3"
                                                          VerticalAlignment="Center"
                                                          ContentSource="Icon"
                                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                        <Border Name="GlyphPanel"
                                                Margin="0,1"
                                                Width="20"
                                                Height="20"
                                                Visibility="Hidden"
                                                BorderBrush="{StaticResource BorderBrush.Office2003}"
                                                Background="#FFFFA600"
                                                BorderThickness="1">
                                            <Path VerticalAlignment="Center"
                                                  HorizontalAlignment="Center"
                                                  FlowDirection="LeftToRight"
                                                  Stroke="{TemplateBinding Foreground}"
                                                  StrokeThickness="1.2"
                                                  Data="{StaticResource ToolBarCheckmark}"/>
                                        </Border>
                                        <ContentPresenter Grid.Column="1"
                                                          ContentSource="Header" Name="content"
                                                          Margin="{TemplateBinding Padding}"
                                                          RecognizesAccessKey="True"
                                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                        <Path Grid.Column="3"
                                              DockPanel.Dock="Right"
                                              VerticalAlignment="Center"
                                              Margin="4,0,6,0"
                                              Fill="{TemplateBinding Foreground}"
                                              Data="{StaticResource RightArrow}"/>
                                        <Popup x:Name="PART_Popup"
                                               Placement="Right"
                                               IsOpen="{Binding Path=IsSubmenuOpen,RelativeSource={RelativeSource TemplatedParent}}"
                                               Focusable="false"
                                               PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"
                                               AllowsTransparency="true">
                                            <theme:SystemDropShadowChrome Name="Shdw"
                                                                          Color="Transparent">
                                                <Border Background="#F5F5F5" BorderBrush="{StaticResource ButtonBorderBrush.Office2003}"
                                                        BorderThickness="1"
                                                        Grid.IsSharedSizeScope="true">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition MinWidth="24"
                                                                              Width="Auto"
                                                                              SharedSizeGroup="MenuItemIconColumnGroup"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Rectangle Fill="{StaticResource MenuItemLeftBarBackground.Blue}"
                                                                       Margin="0,1"/>
                                                        <Rectangle Fill="{StaticResource MenuItemBorderBrush.Blue}"
                                                                       Grid.ColumnSpan="2"
                                                                       Margin="0,-1,0,0"
                                                                       VerticalAlignment="Top"
                                                                       HorizontalAlignment="Left"
                                                                       Height="1"
                                                                       Width="{Binding ElementName=Header, Path=ActualWidth}" />
                                                        <ScrollViewer CanContentScroll="true"
                                                                      Style="{DynamicResource {ComponentResourceKey TypeInTargetAssembly={x:Type FrameworkElement}, ResourceId=MenuScrollViewer}}"
                                                                      Grid.ColumnSpan="2">
                                                            <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Cycle"
                                                                            KeyboardNavigation.TabNavigation="Cycle"
                                                                            Margin="0,0,0,1"
                                                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                                        </ScrollViewer>
                                                    </Grid>
                                                </Border>
                                            </theme:SystemDropShadowChrome>
                                        </Popup>
                                    </Grid>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSuspendingPopupAnimation"
                                                 Value="true">
                                            <Setter TargetName="PART_Popup"
                                                    Property="PopupAnimation"
                                                    Value="None"/>
                                        </Trigger>
                                        <Trigger Property="Icon"
                                                 Value="{x:Null}">
                                            <Setter TargetName="Icon"
                                                    Property="Visibility"
                                                    Value="Collapsed"/>
                                        </Trigger>
                                        <Trigger Property="IsChecked"
                                                 Value="true">
                                            <Setter TargetName="GlyphPanel"
                                                    Property="Visibility"
                                                    Value="Visible"/>
                                            <Setter TargetName="Icon"
                                                    Property="Visibility"
                                                    Value="Collapsed"/>
                                        </Trigger>
                                        <Trigger Property="IsHighlighted"
                                                 Value="true">
                                            <Setter TargetName="Border"
                                                    Property="BorderBrush"
                                                    Value="{StaticResource BorderBrush.Office2003}"/>
                                            <Setter TargetName="Border"
                                                    Property="Background"
                                                    Value="#83FFD152"/>
                                            <Setter TargetName="content" Property="TextBlock.Foreground" Value="{StaticResource ForegroundBrush.Blue}"/>
                                            <Setter TargetName="GlyphPanel"
                                                    Property="BorderBrush"
                                                    Value="{StaticResource BorderBrush.Office2003}"/>
                                            <Setter TargetName="GlyphPanel"
                                                    Property="Background"
                                                    Value="{StaticResource BorderBrush.Office2003}"/>
                                        </Trigger>
                                        <Trigger SourceName="PART_Popup"
                                                  Property="Popup.HasDropShadow"
                                                  Value="true">
                                            <Setter TargetName="Shdw"
                                                     Property="Margin"
                                                     Value="0,0,5,5"/>
                                            <Setter TargetName="Shdw"
                                                     Property="SnapsToDevicePixels"
                                                     Value="true"/>
                                            <Setter TargetName="Shdw"
                                                     Property="Color"
                                                     Value="#71000000"/>
                                        </Trigger>
                                        <Trigger Property="IsEnabled"
                                                 Value="false">
                                            <Setter Property="Opacity" Value="0.5"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </ControlTemplate.Resources>
        <!--<ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Foreground" Value="Green"/>
            </Trigger>
        </ControlTemplate.Triggers>-->
        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="true">
            <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>

    </ControlTemplate>


    <ControlTemplate TargetType="Separator" x:Key="Office2003MenuSeparatorTemplate">
        <Border Margin="28,2,2,2" Height="1" Background="{StaticResource MenuSeparatorBrush.Blue}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" />
    </ControlTemplate>


    <ControlTemplate x:Key="Office2003TopLevelItemTemplate"
                     TargetType="{x:Type MenuItem}">

        <Grid SnapsToDevicePixels="true">
            <Rectangle x:Name="OuterBorder"
                       RadiusX="2"
                       RadiusY="2"/>
            <Rectangle Name="Bg"
                       Margin="1"
                       Fill="{TemplateBinding MenuItem.Background}"
                       Stroke="{TemplateBinding MenuItem.BorderBrush}"
                       StrokeThickness="1"
                       RadiusX="1"
                       RadiusY="1"/>
            <Rectangle x:Name="InnerBorder"
                       Margin="2"/>
            <DockPanel>
                <ContentPresenter x:Name="Icon"
                                  Margin="4,0,6,0"
                                  VerticalAlignment="Center"
                                  ContentSource="Icon"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                <Border x:Name="GlyphPanel" Grid.Column="0" Visibility="Collapsed"
                Width="21" Height="21" BorderThickness="1" BorderBrush="#F29536"
                Background="#FFE395" CornerRadius="2">
                    <Path Stroke="Black" StrokeThickness="1.4">
                        <Path.Data>
                            <GeometryGroup>
                                <LineGeometry StartPoint="6 9" EndPoint="9 16"/>
                                <LineGeometry StartPoint="9 16" EndPoint="13 3"/>
                            </GeometryGroup>
                        </Path.Data>
                    </Path>
                </Border>

                <ContentPresenter ContentSource="Header"
                                  Margin="{TemplateBinding MenuItem.Padding}"
                                  RecognizesAccessKey="True"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            </DockPanel>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="Icon"
                     Value="{x:Null}">
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed"/>
            </Trigger>
            <Trigger Property="IsChecked"
                     Value="true">
                <Setter TargetName="GlyphPanel"
                        Property="Visibility"
                        Value="Visible"/>
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed"/>
            </Trigger>
            <Trigger Property="IsHighlighted"
                     Value="true">
                <Setter TargetName="Bg"
                        Property="Stroke"
                        Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter TargetName="Bg"
                        Property="Fill"
                        Value="{StaticResource MouseOverBrushIn.Office2003}"/>


            </Trigger>
            <Trigger Property="IsKeyboardFocused"
                     Value="true">
                <Setter TargetName="Bg"
                        Property="Stroke"
                        Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter TargetName="Bg"
                        Property="Fill"
                        Value="{StaticResource MenuKeyBoardFill.Blue}"/>
            </Trigger>
            <Trigger Property="IsEnabled"
                     Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate x:Key="Office2003TopLevelHeaderTemplate"
                     TargetType="{x:Type MenuItem}">


        <Grid SnapsToDevicePixels="true">
            <Rectangle x:Name="OuterBorder"
                       RadiusX="2"
                       RadiusY="2"/>
            <Rectangle Name="Bg"
                       Margin="1"
                       Fill="{TemplateBinding MenuItem.Background}"
                       Stroke="{TemplateBinding MenuItem.BorderBrush}"
                       StrokeThickness="1"
                       RadiusX="1"
                       RadiusY="1"/>
            <Rectangle x:Name="InnerBorder"
                       Margin="2"/>
            <DockPanel>
                <ContentPresenter x:Name="Icon"
                                  Margin="4,0,6,0"
                                  VerticalAlignment="Center"
                                  ContentSource="Icon"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>

                <Border x:Name="GlyphPanel" Grid.Column="0" Visibility="Collapsed"
                Width="21" Height="21" BorderThickness="1" BorderBrush="#F29536"
                Background="#FFE395" CornerRadius="2">
                    <Path Stroke="Black" StrokeThickness="1.4">
                        <Path.Data>
                            <GeometryGroup>
                                <LineGeometry StartPoint="6 9" EndPoint="9 16"/>
                                <LineGeometry StartPoint="9 16" EndPoint="13 3"/>
                            </GeometryGroup>
                        </Path.Data>
                    </Path>
                </Border>
                <ContentPresenter ContentSource="Header"
                                  Margin="{TemplateBinding MenuItem.Padding}"
                                  RecognizesAccessKey="True"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            </DockPanel>
            <Popup x:Name="PART_Popup"
                   HorizontalOffset="1"
                   VerticalOffset="-1"
                   AllowsTransparency="true"
                   Placement="Bottom"
                   IsOpen="{Binding Path=IsSubmenuOpen,RelativeSource={RelativeSource TemplatedParent}}"
                   Focusable="false"
                   PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                <theme:SystemDropShadowChrome Name="Shdw"
                                              Color="Transparent">
                    <ContentControl Name="SubMenuBorder"
                                    Template="{DynamicResource BlueSubmenuContent}"
                                    IsTabStop="false">
                        <ScrollViewer CanContentScroll="true"
                                      Style="{DynamicResource {ComponentResourceKey TypeInTargetAssembly={x:Type FrameworkElement}, ResourceId=MenuScrollViewer}}">
                            <ItemsPresenter Margin="2"
                                            KeyboardNavigation.TabNavigation="Cycle"
                                            KeyboardNavigation.DirectionalNavigation="Cycle"
                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                            Grid.IsSharedSizeScope="true"/>
                        </ScrollViewer>
                    </ContentControl>
                </theme:SystemDropShadowChrome>
            </Popup>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsSuspendingPopupAnimation"
                     Value="true">
                <Setter TargetName="PART_Popup"
                        Property="PopupAnimation"
                        Value="None"/>
            </Trigger>
            <Trigger Property="Icon"
                     Value="{x:Null}">
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed"/>
            </Trigger>
            <Trigger Property="IsChecked"
                     Value="true">
                <Setter TargetName="GlyphPanel"
                        Property="Visibility"
                        Value="Visible"/>
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed"/>
            </Trigger>
            <Trigger SourceName="PART_Popup"
                     Property="Popup.HasDropShadow"
                     Value="true">
                <Setter TargetName="Shdw"
                        Property="Margin"
                        Value="0,0,5,5"/>
                <Setter TargetName="Shdw"
                        Property="Color"
                        Value="#71000000"/>
            </Trigger>
            <Trigger Property="IsHighlighted"
                     Value="true">
                <Setter TargetName="Bg"
                        Property="Stroke"
                        Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter TargetName="Bg"
                        Property="Fill"
                        Value="{StaticResource MouseOverBrushIn.Office2003}"/>


            </Trigger>
            <Trigger Property="IsKeyboardFocused"
                     Value="true">
                <Setter TargetName="Bg"
                        Property="Stroke"
                        Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter TargetName="Bg"
                        Property="Fill"
                        Value="{StaticResource MenuKeyBoardFill.Blue}"/>
            </Trigger>
            <Trigger Property="IsSubmenuOpen"
                     Value="true">
                <Setter TargetName="Bg"
                        Property="Stroke"
                        Value="{StaticResource ButtonBorderBrush.Office2003}"/>
                <Setter TargetName="Bg"
                        Property="Fill"
                        Value="{StaticResource MenuKeyBoardFill.Blue}"/>
            </Trigger>
            <Trigger Property="IsEnabled"
                     Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>


    <ControlTemplate x:Key="Office2003SubmenuItemTemplate"
                     TargetType="{x:Type MenuItem}">


        <Grid SnapsToDevicePixels="true">
            <Rectangle Name="Bg"
                       Fill="{TemplateBinding MenuItem.Background}"
                       Stroke="{TemplateBinding MenuItem.BorderBrush}"
                       StrokeThickness="1"
                       RadiusX="2"
                       RadiusY="2"/>
            <Rectangle x:Name="InnerBorder"
                       Margin="1"
                       RadiusX="2"
                       RadiusY="2"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition MinWidth="24"
                                      Width="Auto"
                                      SharedSizeGroup="MenuItemIconColumnGroup"/>
                    <ColumnDefinition Width="4"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="37"/>
                    <ColumnDefinition Width="Auto"
                                      SharedSizeGroup="MenuItemIGTColumnGroup"/>
                    <ColumnDefinition Width="17"/>
                </Grid.ColumnDefinitions>
                <ContentPresenter x:Name="Icon"
                                  Margin="1"
                                  VerticalAlignment="Center"
                                  ContentSource="Icon"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                <Border x:Name="GlyphPanel"
                        BorderBrush="#F29536"
                        Background="#FFE395"
                        BorderThickness="1"
                        CornerRadius="3"
                        Margin="1"
                        Visibility="Hidden"
                        Width="22" 
                        Height="22">

                    <Path Stroke="Black" StrokeThickness="1.4">
                        <Path.Data>
                            <GeometryGroup>
                                <LineGeometry StartPoint="6 9" EndPoint="9 16"/>
                                <LineGeometry StartPoint="9 16" EndPoint="13 3"/>
                            </GeometryGroup>
                        </Path.Data>
                    </Path>

                </Border>
                <ContentPresenter Grid.Column="2"
                                  ContentSource="Header"
                                  Margin="{TemplateBinding MenuItem.Padding}"
                                  RecognizesAccessKey="True"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                <TextBlock Grid.Column="4"
                           Text="{TemplateBinding MenuItem.InputGestureText}"
                           Margin="{TemplateBinding MenuItem.Padding}"/>
            </Grid>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="Icon"
                     Value="{x:Null}">
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed"/>
            </Trigger>
            <Trigger Property="IsChecked"
                     Value="true">
                <Setter TargetName="GlyphPanel"
                        Property="Visibility"
                        Value="Visible"/>
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed"/>
            </Trigger>
            <Trigger Property="IsHighlighted"
                     Value="true">
                <Setter TargetName="Bg"
                        Property="Fill"
                        Value="{StaticResource MouseOverBrushIn.Office2003}"/>
                <Setter TargetName="Bg"
                        Property="Stroke"
                        Value="{StaticResource BorderBrush.Office2003}"/>

            </Trigger>
            <Trigger Property="IsEnabled"
                     Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>







    <ControlTemplate x:Key="Office2003SubmenuHeaderTemplate"
                     TargetType="{x:Type MenuItem}">

        <Grid SnapsToDevicePixels="true">
            <Rectangle Name="Bg"
                       Fill="{TemplateBinding MenuItem.Background}"
                       Stroke="{TemplateBinding MenuItem.BorderBrush}"
                       StrokeThickness="1"
                       RadiusX="2"
                       RadiusY="2"/>
            <Rectangle x:Name="InnerBorder"
                       Margin="1"
                       Stroke="Transparent"
                       StrokeThickness="1"
                       RadiusX="2"
                       RadiusY="2"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition MinWidth="24"
                                      Width="Auto"
                                      SharedSizeGroup="MenuItemIconColumnGroup"/>
                    <ColumnDefinition Width="4"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="37"/>
                    <ColumnDefinition Width="Auto"
                                      SharedSizeGroup="MenuItemIGTColumnGroup"/>
                    <ColumnDefinition Width="17"/>
                </Grid.ColumnDefinitions>
                <ContentPresenter x:Name="Icon"
                                  Margin="1"
                                  VerticalAlignment="Center"
                                  ContentSource="Icon"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                <Border x:Name="GlyphPanel"
                        BorderBrush="#F29536"
                        Background="#FFE395"
                        BorderThickness="1"
                        CornerRadius="3"
                        Margin="1"
                        Visibility="Hidden"
                        Width="22" 
                        Height="22">

                    <Path Stroke="Black" StrokeThickness="1.4">
                        <Path.Data>
                            <GeometryGroup>
                                <LineGeometry StartPoint="6 9" EndPoint="9 16"/>
                                <LineGeometry StartPoint="9 16" EndPoint="13 3"/>
                            </GeometryGroup>
                        </Path.Data>
                    </Path>

                </Border>
                <ContentPresenter Grid.Column="2"
                                  ContentSource="Header"
                                  Margin="{TemplateBinding MenuItem.Padding}"
                                  RecognizesAccessKey="True"
                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                <TextBlock Grid.Column="4"
                           Text="{TemplateBinding MenuItem.InputGestureText}"
                           Margin="{TemplateBinding MenuItem.Padding}"
                           Visibility="Collapsed"/>
                <Path Grid.Column="5"
                      VerticalAlignment="Center"
                      Margin="4,0,0,0"
                      Fill="{TemplateBinding MenuItem.Foreground}"
                      Data="{StaticResource RightArrow}"/>
            </Grid>
            <Popup x:Name="PART_Popup"
                   AllowsTransparency="true"
                   Placement="Right"
                   VerticalOffset="-3"
                   HorizontalOffset="-2"
                   IsOpen="{Binding Path=IsSubmenuOpen,RelativeSource={RelativeSource TemplatedParent}}"
                   Focusable="false"
                   PopupAnimation="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}">
                <theme:SystemDropShadowChrome Name="Shdw"
                                              Color="Transparent">
                    <ContentControl Name="SubMenuBorder"
                                    Template="{DynamicResource BlueSubmenuContent}"
                                    IsTabStop="false">
                        <ScrollViewer CanContentScroll="true"
                                      Style="{DynamicResource {ComponentResourceKey TypeInTargetAssembly={x:Type FrameworkElement}, ResourceId=MenuScrollViewer}}">
                            <ItemsPresenter Margin="2"
                                            KeyboardNavigation.TabNavigation="Cycle"
                                            KeyboardNavigation.DirectionalNavigation="Cycle"
                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                            Grid.IsSharedSizeScope="true"/>
                        </ScrollViewer>
                    </ContentControl>
                </theme:SystemDropShadowChrome>
            </Popup>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsSuspendingPopupAnimation"
                     Value="true">
                <Setter TargetName="PART_Popup"
                        Property="PopupAnimation"
                        Value="None"/>
            </Trigger>

            <Trigger Property="Icon"
                     Value="{x:Null}">
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed"/>
            </Trigger>
            <Trigger Property="IsChecked"
                     Value="true">
                <Setter TargetName="GlyphPanel"
                        Property="Visibility"
                        Value="Visible"/>
                <Setter TargetName="Icon"
                        Property="Visibility"
                        Value="Collapsed"/>
            </Trigger>
            <Trigger SourceName="PART_Popup"
                     Property="Popup.HasDropShadow"
                     Value="true">
                <Setter TargetName="Shdw"
                        Property="Margin"
                        Value="0,0,5,5"/>
                <Setter TargetName="Shdw"
                        Property="Color"
                        Value="#71000000"/>
            </Trigger>
            <Trigger Property="IsHighlighted"
                     Value="true">
                <Setter TargetName="Bg"
                        Property="Fill"
                        Value="{StaticResource MouseOverBrushIn.Office2003}"/>
                <Setter TargetName="Bg"
                        Property="Stroke"
                        Value="{StaticResource BorderBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsEnabled"
                     Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type ContextMenu}" x:Key="Office2003ContextMenuTemplate">
        <theme:SystemDropShadowChrome Name="Shdw"
                                                  Color="#00FFFFFF"
                                                  SnapsToDevicePixels="true">
            <Border Background="{TemplateBinding Panel.Background}" CornerRadius="3,3,3,3"
                                BorderBrush="{TemplateBinding Border.BorderBrush}"
                                BorderThickness="{TemplateBinding Border.BorderThickness}">
                <Grid>
                    <Rectangle Fill="{StaticResource MenuItemLeftBarBackground.Blue}"
                                           HorizontalAlignment="Left"
                                           Width="28"
                                           Margin="1,1,1,1"
                                           RadiusX="2"
                                           RadiusY="2"/>
                    <Rectangle HorizontalAlignment="Left"
                                           Width="1"
                                           Margin="26,1,0,1"
                                           Fill="{StaticResource MenuItemBorderBrush.Blue}"/>
                    <Rectangle HorizontalAlignment="Left"
                                           Width="1"
                                           Margin="27,1,0,1"
                                           Fill="#FAFAFA"/>
                    <ScrollViewer Margin="1,0,1,0" CanContentScroll="true"
                                              Grid.ColumnSpan="2" 
                                              Style="{DynamicResource {ComponentResourceKey TypeInTargetAssembly={x:Type FrameworkElement}, ResourceId=MenuScrollViewer}}">
                        <ItemsPresenter Margin="{TemplateBinding Control.Padding}"
                                                    KeyboardNavigation.DirectionalNavigation="Cycle"
                                                    SnapsToDevicePixels="{TemplateBinding UIElement.SnapsToDevicePixels}"/>
                    </ScrollViewer>
                </Grid>
            </Border>
        </theme:SystemDropShadowChrome>
        <ControlTemplate.Triggers>
            <Trigger Property="ContextMenuService.HasDropShadow"
                                 Value="true">
                <Setter TargetName="Shdw"
                                    Property="FrameworkElement.Margin"
                                    Value="0,0,5,5"/>
                <Setter TargetName="Shdw"
                                    Property="theme:SystemDropShadowChrome.Color"
                                    Value="#71000000"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- ToolTip -->
    <ControlTemplate TargetType="{x:Type ToolTip}" x:Key="Office2003ToolTipTemplate">
        <theme:SystemDropShadowChrome Name="Shdw"
                                                  Color="Transparent"
                                                  SnapsToDevicePixels="true"
                                                  CornerRadius="2">
            <Border Background="{TemplateBinding Background}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="2">
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            </Border>
        </theme:SystemDropShadowChrome>
        <ControlTemplate.Triggers>
            <Trigger Property="HasDropShadow"
                                 Value="true">
                <Setter TargetName="Shdw"
                                    Property="Margin"
                                    Value="0,0,5,5"/>
                <Setter TargetName="Shdw"
                                    Property="Color"
                                    Value="#71000000"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- TreeView -->
    <ControlTemplate TargetType="{x:Type TreeView}" x:Key="Office2003TreeViewTemplate">
        <Border Name="Bd"
                            CornerRadius="2"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="true">
            <ScrollViewer Background="{TemplateBinding Background}"
                                      Focusable="false"
                                      CanContentScroll="false"
                                      HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
                                      VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}"
                                      Padding="{TemplateBinding Padding}"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
                <ItemsPresenter/>
            </ScrollViewer>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <Style x:Key="BlueExpandCollapseToggleStyle"
           TargetType="{x:Type ToggleButton}">
        <Setter Property="Focusable"
                Value="False"/>
        <Setter Property="Width"
                Value="12"/>
        <Setter Property="Height"
                Value="12"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border Height="11" 
                                           BorderBrush="{StaticResource TreeViewFill.Blue}"
                                            CornerRadius="1" 
                                            Width="11" 
                                            BorderThickness="1" 
                                            SnapsToDevicePixels="True"
                                            Background="{StaticResource ToolTipBackground.Blue}">
                        <Path Margin="2" Data="M0,2L0,3 2,3 2,5 3,5 3,3 5,3 5,2 3,2 3,0 2,0 2,2z" 
                                              Fill="{StaticResource TreeViewFill.Blue}" Name="ExpandPath" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="ToggleButton.IsChecked" Value="True">
                            <Setter Property="Path.Data" TargetName="ExpandPath" Value="M0,2L0,3 5,3 5,2z"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <ControlTemplate TargetType="{x:Type TreeViewItem}" x:Key="Office2003TreeViewItemTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition MinWidth="19"
                                              Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <StackPanel Name="Part_Select" Orientation="Horizontal" Grid.ColumnSpan="3" Grid.Column="0">

                <ToggleButton x:Name="Expander"
                                      Style="{StaticResource BlueExpandCollapseToggleStyle}"
                                      IsChecked="{Binding Path=IsExpanded,RelativeSource={RelativeSource TemplatedParent}}"
                                      ClickMode="Press"/>
                <Border Name="Bd"
                                Grid.Column="1"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}"
                                SnapsToDevicePixels="true">
                    <ContentPresenter x:Name="PART_Header"
                                              ContentSource="Header"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                </Border>
            </StackPanel>
            <ItemsPresenter x:Name="ItemsHost"
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Grid.ColumnSpan="2"/>


        </Grid>

        <ControlTemplate.Triggers>
            <Trigger Property="IsExpanded"
                                 Value="false">
                <Setter TargetName="ItemsHost"
                                    Property="Visibility"
                                    Value="Collapsed"/>
            </Trigger>
            <Trigger Property="HasItems"
                                 Value="false">
                <Setter TargetName="Expander"
                                    Property="Visibility"
                                    Value="Hidden"/>
            </Trigger>
            <Trigger Property="IsSelected"
                                 Value="true">
                <Setter TargetName="Part_Select"
                                    Property="Background"
                                    Value="{StaticResource MouseOverBrushIn.Office2003}"/>
                <!--<Setter TargetName="Bd"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Office2003}"/>-->
                <!--<Setter Property="Foreground"
                                    Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>-->
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="true"/>
                    <Condition Property="IsSelectionActive"
                                           Value="false"/>
                </MultiTrigger.Conditions>
                <!--<Setter TargetName="Part_Select"
                                    Property="Background"
                                    Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>-->
                <Setter TargetName="Part_Select"
                                    Property="Background"
                                    Value="{StaticResource MouseOverBrushIn.Office2003}"/>
                <!--<Setter TargetName="Bd"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Office2003}"/>-->
                <!--<Setter Property="Foreground"
                                    Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>-->
            </MultiTrigger>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity"
                                    Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- TextBoxBase -->

    <ControlTemplate TargetType="{x:Type TextBoxBase}" x:Key="Office2003TextBoxBaseTemplate">
        <theme:ListBoxChrome x:Name="Bd"
                                         BorderThickness="{TemplateBinding BorderThickness}"
                                         BorderBrush="{TemplateBinding BorderBrush}"                                         
                                         Background="{TemplateBinding Background}"
                                         RenderMouseOver="{TemplateBinding IsMouseOver}"
                                         RenderFocused="{TemplateBinding IsKeyboardFocusWithin}"
                                         SnapsToDevicePixels="true">
            <ScrollViewer x:Name="PART_ContentHost"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </theme:ListBoxChrome>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource TextBoxBorderBrushHover.Blue}"/>
                <Setter TargetName="Bd" Property="Background" Value="White"/>
            </Trigger>
            <Trigger Property="IsKeyboardFocused" Value="True">
                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource TextBoxBorderBrushHover.Blue}"/>
                <Setter TargetName="Bd" Property="Background" Value="White"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- PasswordBox -->
    <ControlTemplate TargetType="{x:Type PasswordBox}" x:Key="Office2003PasswordBoxTemplate">
        <theme:ListBoxChrome x:Name="Bd"
                                         BorderThickness="{TemplateBinding BorderThickness}"
                                         BorderBrush="{TemplateBinding BorderBrush}"
                                         Background="{TemplateBinding Background}"
                                         RenderMouseOver="{TemplateBinding IsMouseOver}"
                                         RenderFocused="{TemplateBinding IsKeyboardFocusWithin}"
                                         SnapsToDevicePixels="true">
            <ScrollViewer x:Name="PART_ContentHost"
                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </theme:ListBoxChrome>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource TextBoxBorderBrushHover.Blue}"/>
                <Setter TargetName="Bd" Property="Background" Value="White"/>
            </Trigger>
            <Trigger Property="IsKeyboardFocused" Value="True">
                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource TextBoxBorderBrushHover.Blue}"/>
                <Setter TargetName="Bd" Property="Background" Value="White"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- Expander -->

    <Style x:Key="BlueExpanderDownHeaderStyle"
           TargetType="{x:Type ToggleButton}">


        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border Padding="{TemplateBinding Padding}">
                        <Grid Background="Transparent"
                              SnapsToDevicePixels="False">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="19"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Ellipse x:Name="circle"
                                     Width="19"
                                     Height="19"                                  
                                     Stroke="{StaticResource TreeViewFill.Blue}"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center"
                                     Fill="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                            <Path x:Name="arrow"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"
                                  Stroke="{StaticResource PathFill.Blue}"
                                  StrokeThickness="2"
                                  SnapsToDevicePixels="false"
                                  Data="M 1,1.5 L 4.5,5 L 8,1.5"/>
                            <ContentPresenter Grid.Column="1"
                                              Margin="4,0,0,0"
                                              HorizontalAlignment="Left"
                                              VerticalAlignment="Center"
                                              SnapsToDevicePixels="True"
                                              RecognizesAccessKey="True"/>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked"
                                 Value="true">
                            <Setter Property="Data"
                                    Value="M 1,4.5  L 4.5,1  L 8,4.5"
                                    TargetName="arrow"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver"
                                 Value="true">
                            <Setter Property="Stroke"
                                    Value="#CAB583"
                                    TargetName="circle"/>
                            <Setter Property="Fill"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"
                                    TargetName="circle"/>
                            <Setter Property="Stroke"
                                    Value="{StaticResource PathFill.Blue}"
                                    TargetName="arrow"/>
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="true">
                            <Setter Property="Stroke"
                                    Value="#CAB583"
                                    TargetName="circle"/>
                            <Setter Property="StrokeThickness"
                                    Value="1.5"
                                    TargetName="circle"/>
                            <Setter Property="Fill"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"
                                    TargetName="circle"/>
                            <Setter Property="Stroke"
                                    Value="{StaticResource PathFill.Blue}"
                                    TargetName="arrow"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="BlueExpanderUpHeaderStyle"
           TargetType="{x:Type ToggleButton}">

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border Padding="{TemplateBinding Padding}">
                        <Grid Background="Transparent"
                              SnapsToDevicePixels="False">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="19"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid>
                                <Grid.LayoutTransform>
                                    <TransformGroup>
                                        <TransformGroup.Children>
                                            <TransformCollection>
                                                <RotateTransform Angle="180"/>
                                            </TransformCollection>
                                        </TransformGroup.Children>
                                    </TransformGroup>
                                </Grid.LayoutTransform>
                                <Ellipse x:Name="circle"
                                         Width="19"
                                         Height="19"                                       
                                         Stroke="{StaticResource TreeViewFill.Blue}"
                                         HorizontalAlignment="Center"
                                         VerticalAlignment="Center"
                                         Fill="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                                <Path x:Name="arrow"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      Stroke="{StaticResource PathFill.Blue}"
                                      StrokeThickness="2"
                                      SnapsToDevicePixels="false"
                                      Data="M 1,1.5 L 4.5,5 L 8,1.5"/>
                            </Grid>
                            <ContentPresenter Grid.Column="1"
                                              Margin="4,0,0,0"
                                              HorizontalAlignment="Left"
                                              VerticalAlignment="Center"
                                              SnapsToDevicePixels="True"
                                              RecognizesAccessKey="True"/>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked"
                                 Value="true">
                            <Setter Property="Data"
                                    Value="M 1,4.5  L 4.5,1  L 8,4.5"
                                    TargetName="arrow"/>
                        </Trigger>

                        <Trigger Property="IsMouseOver"
                                 Value="true">
                            <Setter Property="Stroke"
                                    Value="#CAB583"
                                    TargetName="circle"/>
                            <Setter Property="Fill"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"
                                    TargetName="circle"/>
                            <Setter Property="Stroke"
                                    Value="{StaticResource PathFill.Blue}"
                                    TargetName="arrow"/>
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="true">
                            <Setter Property="Stroke"
                                    Value="#CAB583"
                                    TargetName="circle"/>
                            <Setter Property="StrokeThickness"
                                    Value="1.5"
                                    TargetName="circle"/>
                            <Setter Property="Fill"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"
                                    TargetName="circle"/>
                            <Setter Property="Stroke"
                                    Value="{StaticResource PathFill.Blue}"
                                    TargetName="arrow"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="BlueExpanderLeftHeaderStyle"
           TargetType="{x:Type ToggleButton}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border Padding="{TemplateBinding Padding}">
                        <Grid Background="Transparent"
                              SnapsToDevicePixels="False">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="19"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Grid>
                                <Grid.LayoutTransform>
                                    <TransformGroup>
                                        <TransformGroup.Children>
                                            <TransformCollection>
                                                <RotateTransform Angle="90"/>
                                            </TransformCollection>
                                        </TransformGroup.Children>
                                    </TransformGroup>
                                </Grid.LayoutTransform>
                                <Ellipse x:Name="circle"
                                         Width="19"
                                         Height="19"                                       
                                         Stroke="{StaticResource TreeViewFill.Blue}"
                                         HorizontalAlignment="Center"
                                         VerticalAlignment="Center"
                                         Fill="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                                <Path x:Name="arrow"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      Stroke="{StaticResource PathFill.Blue}"
                                      StrokeThickness="2"
                                      SnapsToDevicePixels="false"
                                      Data="M 1,1.5 L 4.5,5 L 8,1.5"/>
                            </Grid>
                            <ContentPresenter Grid.Row="1"
                                              Margin="0,4,0,0"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Top"
                                              SnapsToDevicePixels="True"
                                              RecognizesAccessKey="True"/>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked"
                                 Value="true">
                            <Setter Property="Data"
                                    Value="M 1,4.5  L 4.5,1  L 8,4.5"
                                    TargetName="arrow"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver"
                                 Value="true">
                            <Setter Property="Stroke"
                                    Value="#CAB583"
                                    TargetName="circle"/>
                            <Setter Property="Fill"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"
                                    TargetName="circle"/>
                            <Setter Property="Stroke"
                                    Value="{StaticResource PathFill.Blue}"
                                    TargetName="arrow"/>
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="true">
                            <Setter Property="Stroke"
                                    Value="#CAB583"
                                    TargetName="circle"/>
                            <Setter Property="StrokeThickness"
                                    Value="1.5"
                                    TargetName="circle"/>
                            <Setter Property="Fill"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"
                                    TargetName="circle"/>
                            <Setter Property="Stroke"
                                    Value="{StaticResource PathFill.Blue}"
                                    TargetName="arrow"/>
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="BlueExpanderRightHeaderStyle"
           TargetType="{x:Type ToggleButton}">

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border Padding="{TemplateBinding Padding}">
                        <Grid Background="Transparent"
                              SnapsToDevicePixels="False">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="19"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Grid>
                                <Grid.LayoutTransform>
                                    <TransformGroup>
                                        <TransformGroup.Children>
                                            <TransformCollection>
                                                <RotateTransform Angle="-90"/>
                                            </TransformCollection>
                                        </TransformGroup.Children>
                                    </TransformGroup>
                                </Grid.LayoutTransform>
                                <Ellipse x:Name="circle"
                                         Width="19"
                                         Height="19"                                        
                                         Stroke="{StaticResource TreeViewFill.Blue}"
                                         HorizontalAlignment="Center"
                                         VerticalAlignment="Center"
                                         Fill="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                                <Path x:Name="arrow"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      Stroke="{StaticResource PathFill.Blue}"
                                      StrokeThickness="2"
                                      SnapsToDevicePixels="false"
                                      Data="M 1,1.5 L 4.5,5 L 8,1.5"/>
                            </Grid>
                            <ContentPresenter Grid.Row="1"
                                              Margin="0,4,0,0"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Top"
                                              SnapsToDevicePixels="True"
                                              RecognizesAccessKey="True"/>
                        </Grid>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked"
                                 Value="true">
                            <Setter Property="Data"
                                    Value="M 1,4.5  L 4.5,1  L 8,4.5"
                                    TargetName="arrow"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver"
                                 Value="true">
                            <Setter Property="Stroke"
                                    Value="#CAB583"
                                    TargetName="circle"/>
                            <Setter Property="Fill"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"
                                    TargetName="circle"/>
                            <Setter Property="Stroke"
                                    Value="{StaticResource PathFill.Blue}"
                                    TargetName="arrow"/>
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="true">
                            <Setter Property="Stroke"
                                    Value="#CAB583"
                                    TargetName="circle"/>
                            <Setter Property="StrokeThickness"
                                    Value="1.5"
                                    TargetName="circle"/>
                            <Setter Property="Fill"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"
                                    TargetName="circle"/>
                            <Setter Property="Stroke"
                                    Value="{StaticResource PathFill.Blue}"
                                    TargetName="arrow"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate TargetType="{x:Type Expander}" x:Key="Office2003ExpanderTemplate">
        <Border BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Background="{TemplateBinding Background}"
                            CornerRadius="3"
                            SnapsToDevicePixels="true">
            <DockPanel>
                <ToggleButton x:Name="HeaderSite"
                                          DockPanel.Dock="Top"
                                          Margin="1"
                                          MinWidth="0"
                                          MinHeight="0"
                                          Style="{StaticResource BlueExpanderDownHeaderStyle}"                                        
                                          IsChecked="{Binding Path=IsExpanded,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}"
                                          Content="{TemplateBinding Header}"
                                          ContentTemplate="{TemplateBinding HeaderTemplate}"
                                          ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}"
                                          Foreground="{TemplateBinding Foreground}"
                                          Padding="{TemplateBinding Padding}"
                                          FontFamily="{TemplateBinding FontFamily}"
                                          FontSize="{TemplateBinding FontSize}"
                                          FontStyle="{TemplateBinding FontStyle}"
                                          FontStretch="{TemplateBinding FontStretch}"
                                          FontWeight="{TemplateBinding FontWeight}"
                                          HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
                <ContentPresenter x:Name="ExpandSite"
                                              DockPanel.Dock="Bottom"
                                              Visibility="Collapsed"
                                              Focusable="false"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                              Margin="{TemplateBinding Padding}"/>
            </DockPanel>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsExpanded"
                                 Value="true">
                <Setter Property="Visibility"
                                    Value="Visible"
                                    TargetName="ExpandSite"/>
            </Trigger>
            <Trigger Property="ExpandDirection"
                                 Value="Right">
                <Setter Property="DockPanel.Dock"
                                    Value="Right"
                                    TargetName="ExpandSite"/>
                <Setter Property="DockPanel.Dock"
                                    Value="Left"
                                    TargetName="HeaderSite"/>
                <Setter Property="Style"
                                    Value="{StaticResource BlueExpanderRightHeaderStyle}"
                                    TargetName="HeaderSite"/>
            </Trigger>
            <Trigger Property="ExpandDirection"
                                 Value="Up">
                <Setter Property="DockPanel.Dock"
                                    Value="Top"
                                    TargetName="ExpandSite"/>
                <Setter Property="DockPanel.Dock"
                                    Value="Bottom"
                                    TargetName="HeaderSite"/>
                <Setter Property="Style"
                                    Value="{StaticResource BlueExpanderUpHeaderStyle}"
                                    TargetName="HeaderSite"/>
            </Trigger>
            <Trigger Property="ExpandDirection"
                                 Value="Left">
                <Setter Property="DockPanel.Dock"
                                    Value="Left"
                                    TargetName="ExpandSite"/>
                <Setter Property="DockPanel.Dock"
                                    Value="Right"
                                    TargetName="HeaderSite"/>
                <Setter Property="Style"
                                    Value="{StaticResource BlueExpanderLeftHeaderStyle}"
                                    TargetName="HeaderSite"/>
            </Trigger>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Foreground"
                                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- GroupBox -->
    <BorderGapMaskConverter x:Key="BorderGapMaskConverter"/>

    <ControlTemplate TargetType="{x:Type GroupBox}" x:Key="Office2003GroupBoxTemplate">
        <Grid SnapsToDevicePixels="true">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="6"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="6"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="6"/>
            </Grid.RowDefinitions>
            <Border CornerRadius="4"
                                Grid.Row="1"
                                Grid.RowSpan="3"
                                Grid.Column="0"
                                Grid.ColumnSpan="4"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="Transparent"
                                Background="{TemplateBinding Background}"/>
            <Border x:Name="Header"
                                Padding="3,1,3,0"
                                Grid.Row="0"
                                Grid.RowSpan="2"
                                Grid.Column="1">
                <ContentPresenter ContentSource="Header" 
                                              RecognizesAccessKey="True" 
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            </Border>
            <ContentPresenter Grid.Row="2"
                                          Grid.Column="1"
                                          Grid.ColumnSpan="2"
                                          Margin="{TemplateBinding Padding}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            <Border CornerRadius="4"
                                Grid.Row="1"
                                Grid.RowSpan="3"
                                Grid.ColumnSpan="4"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{StaticResource ButtonBorderBrush.Office2003}">
                <Border.OpacityMask>
                    <MultiBinding Converter="{StaticResource BorderGapMaskConverter}"
                                              ConverterParameter="7">
                        <Binding ElementName="Header"
                                             Path="ActualWidth"/>
                        <Binding RelativeSource="{RelativeSource Self}"
                                             Path="ActualWidth"/>
                        <Binding RelativeSource="{RelativeSource Self}"
                                             Path="ActualHeight"/>
                    </MultiBinding>
                </Border.OpacityMask>

                <Border BorderThickness="{TemplateBinding BorderThickness}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    CornerRadius="3">
                    <Border BorderThickness="{TemplateBinding BorderThickness}"
                                        BorderBrush="{StaticResource ButtonBorderBrush.Office2003}"
                                        CornerRadius="2"/>
                </Border>
            </Border>
        </Grid>
    </ControlTemplate>

    <!-- StatusBar -->
    <ControlTemplate TargetType="{x:Type Separator}" x:Key="Office2003StatusBarSeparatorTemplate">
        <Border Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="true"/>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type StatusBarItem}" x:Key="Office2003StatusBarItemTemplate">

        <Border Background="{TemplateBinding Background}" Name="bd"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="true">
            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>

        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- ProgressBar -->

    <LinearGradientBrush x:Key="ProgressBarIndicatorAnimatedFill1" 
                         MappingMode="Absolute"
                         StartPoint="-100,0"
                         EndPoint="0,0">
        <LinearGradientBrush.GradientStops>
            <GradientStop Color="#00000000"
                          Offset="0"/>
            <GradientStop Color="#FF000000"
                          Offset="0.4"/>
            <GradientStop Color="#FF000000"
                          Offset="0.6"/>
            <GradientStop Color="#00000000"
                          Offset="1"/>
        </LinearGradientBrush.GradientStops>
    </LinearGradientBrush>
    <ControlTemplate TargetType="{x:Type ProgressBar}" x:Key="Office2003ProgressBarTemplate">
        <Grid Name="Background"
                          SnapsToDevicePixels="true">
            <Rectangle Fill="{TemplateBinding Background}"
                                   RadiusX="2"
                                   RadiusY="2"/>
            <Border Background="{StaticResource  ProgressBarGlassyHighlightBrush.Blue}"
                                Margin="1"
                                CornerRadius="2"/>
            <Border BorderBrush="#80FFFFFF"
                                Background="{StaticResource  ProgressBarTopHighlightBrush.Blue}"
                                BorderThickness="1,0,1,1"
                                Margin="1"/>
            <Rectangle Name="PART_Track"
                                   Margin="1" Fill="{StaticResource DefaultThumbBrush.Blue}" Stroke="DarkGray" StrokeThickness="0.5"/>

            <Decorator x:Name="PART_Indicator"
                                   HorizontalAlignment="Left"
                                   Margin="1">
                <Grid Name="Foreground">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition MaxWidth="15"/>
                        <ColumnDefinition Width="0.1*"/>
                        <ColumnDefinition MaxWidth="15"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <Rectangle x:Name="Indicator"
                                           Grid.RowSpan="2"
                                           Grid.ColumnSpan="3"
                                           Fill="{TemplateBinding Foreground}"/>
                    <Rectangle x:Name="Animation"
                                           Grid.RowSpan="2"
                                           Grid.ColumnSpan="3"
                                           Fill="{TemplateBinding Foreground}">
                        <Rectangle.OpacityMask>
                            <MultiBinding>
                                <MultiBinding.Converter>
                                    <theme:ProgressBarHighlightConverter/>
                                </MultiBinding.Converter>
                                <Binding Source="{StaticResource ProgressBarIndicatorAnimatedFill1}"/>
                                <Binding Path="ActualWidth"
                                                     ElementName="Background"/>
                                <Binding Path="ActualHeight"
                                                     ElementName="Background"/>
                            </MultiBinding>
                        </Rectangle.OpacityMask>
                    </Rectangle>
                    <Rectangle x:Name="LeftDark"
                                           Grid.RowSpan="2"
                                           Fill="{StaticResource  ProgressBarIndicatorDarkEdgeLeftBrush.Blue}"
                                           RadiusX="1"
                                           RadiusY="1"
                                           Margin="1,1,0,1"/>
                    <Rectangle x:Name="RightDark"
                                           Grid.RowSpan="2"
                                           Grid.Column="2"
                                           RadiusX="1"
                                           RadiusY="1"
                                           Fill="{StaticResource  ProgressBarIndicatorDarkEdgeRightBrush.Blue}"
                                           Margin="0,1,1,1"/>
                    <Rectangle x:Name="LeftLight"
                                           Grid.Column="0"
                                           Grid.Row="2"
                                           Fill="{StaticResource  ProgressBarIndicatorLightingEffectLeftBrush.Blue}"/>
                    <Rectangle x:Name="CenterLight"
                                           Grid.Column="1"
                                           Grid.Row="2"
                                           Fill="{StaticResource  ProgressBarIndicatorLightingEffectBrush.Blue}"/>
                    <Rectangle x:Name="RightLight"
                                           Grid.Column="2"
                                           Grid.Row="2"
                                           Fill="{StaticResource  ProgressBarIndicatorLightingEffectRightBrush.Blue}"/>
                    <Border x:Name="Highlight1"
                                        Grid.RowSpan="2"
                                        Grid.ColumnSpan="3"
                                        Background="{StaticResource  ProgressBarIndicatorGlassyHighlightBrush.Blue}"/>
                    <Border x:Name="Highlight2"
                                        Grid.RowSpan="2" 
                                        Grid.ColumnSpan="3"
                                        Background="{StaticResource  ProgressBarTopHighlightBrush.Blue}"/>

                </Grid>

            </Decorator>


            <Border BorderThickness="{TemplateBinding BorderThickness}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                CornerRadius="2"/>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="Orientation"
                                 Value="Vertical">
                <Setter TargetName="Background"
                                    Property="LayoutTransform">
                    <Setter.Value>
                        <RotateTransform Angle="-90"/>
                    </Setter.Value>
                </Setter>
                <Setter TargetName="PART_Track"
                                    Property="LayoutTransform">
                    <Setter.Value>
                        <RotateTransform Angle="90"/>
                    </Setter.Value>
                </Setter>
                <Setter TargetName="PART_Indicator"
                                    Property="LayoutTransform">
                    <Setter.Value>
                        <RotateTransform Angle="90"/>
                    </Setter.Value>
                </Setter>
                <Setter TargetName="Foreground"
                                    Property="LayoutTransform">
                    <Setter.Value>
                        <RotateTransform Angle="-90"/>
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="IsIndeterminate"
                                 Value="true">
                <Setter TargetName="LeftDark"
                                    Property="Visibility"
                                    Value="Collapsed"/>
                <Setter TargetName="RightDark"
                                    Property="Visibility"
                                    Value="Collapsed"/>
                <Setter TargetName="LeftLight"
                                    Property="Visibility"
                                    Value="Collapsed"/>
                <Setter TargetName="CenterLight"
                                    Property="Visibility"
                                    Value="Collapsed"/>
                <Setter TargetName="RightLight"
                                    Property="Visibility"
                                    Value="Collapsed"/>
                <Setter TargetName="Indicator"
                                    Property="Visibility"
                                    Value="Collapsed"/>
            </Trigger>
            <Trigger Property="IsIndeterminate"
                                 Value="false">
                <Setter TargetName="Animation"
                                    Property="Fill"
                                    Value="{StaticResource ProgressBarFill.Blue}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- Slider -->
    <Geometry x:Key="SliderPointedThumbOuterBorderGeometry">M 4.5,-7.5 A 1 1 0 0 0 3.5,-8.5 L -3.5,-8.5 A 1 1 0 0 0 -4.5,-7.5 L -4.5,4.5 L -0.5,8.5 L 0.5,8.5 L 4.5,4.5 Z
    </Geometry>

    <Geometry x:Key="SliderPointedThumbMiddleBorderGeometry">M 3.5,-7.5 L -3.5,-7.5 L -3.5,4.5 L 0,8 L 3.5,4.5 Z
    </Geometry>

    <Geometry x:Key="SliderPointedThumbInnerBorderGeometry">M 2.5,-6.5 L -2.5,-6.5 L -2.5,4.5 L 0,7 L 2.5 4.5 Z
    </Geometry>

    <Geometry x:Key="SliderPointedThumbDisabledGeometry">M 4.5,-8.5 L -4.5,-8.5 L -4.5,4.5 L -0.5,8.5 L 0.5,8.5 L 4.5,4.5 Z
    </Geometry>

    <Geometry x:Key="SliderThumbOuterBorderGeometry">M -5,-9.5 A 1 1 0 0 1 -4,-10.5 L 4,-10.5 A 1 1 0 0 1 5,-9.5 L 5,9.5 A 1 1 0 0 1 4,10.5 L -4,10.5 A 1 1 0 0 1 -5,9.5 Z
    </Geometry>

    <Geometry x:Key="SliderThumbMiddleBorderGeometry">M -4,-9.5 L 4,-9.5 L 4,9.5 L -4,9.5 Z
    </Geometry>

    <Geometry x:Key="SliderThumbDisabledGeometry">M -5,-10.5 L 5,-10.5 L 5,10.5 L -5,10.5 Z
    </Geometry>

    <Style x:Key="SliderRepeatButtonStyleBlue"
           TargetType="{x:Type RepeatButton}">
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="IsTabStop"
                Value="false"/>
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Rectangle Fill="Transparent"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="HorizontalSliderThumbStyleBlue"
           TargetType="{x:Type Thumb}">
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="Height"
                Value="22"/>
        <Setter Property="Width"
                Value="11"/>
        <Setter Property="Foreground"
                Value="Gray"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Canvas SnapsToDevicePixels="true">
                        <Canvas.RenderTransform>
                            <TranslateTransform X="5.5"
                                                Y="11"/>
                        </Canvas.RenderTransform>
                        <Path x:Name="Background"
                              Fill="{StaticResource ButtonBackgroundBrush.Office2003}"
                              Data="{StaticResource SliderThumbOuterBorderGeometry}"/>
                        <Path x:Name="InnerBorder"
                              Stroke="Transparent"
                              Data="{StaticResource SliderThumbMiddleBorderGeometry}"/>
                        <Path x:Name="OuterBorder"
                              Stroke="#FF929292"
                              Data="{StaticResource SliderThumbOuterBorderGeometry}"/>
                    </Canvas>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" 
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                            <Setter TargetName="OuterBorder"
                                    Property="Stroke" Value="{StaticResource ButtonMouseOverBorderBrush.Blue}"/>

                        </Trigger>

                        <Trigger Property="IsDragging"
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource ButtonPressedBrush.Office2003}"/>

                            <Setter TargetName="OuterBorder"
                                    Property="Stroke"
                                    Value="{StaticResource ButtonPressedBorderBrush.Blue}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="HorizontalSliderUpThumbStyleBlue"
           TargetType="{x:Type Thumb}">
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="Height"
                Value="18"/>
        <Setter Property="Width"
                Value="10"/>
        <Setter Property="Foreground"
                Value="Gray"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Canvas SnapsToDevicePixels="true">
                        <Canvas.RenderTransform>
                            <TransformGroup>
                                <TransformGroup.Children>
                                    <TransformCollection>
                                        <RotateTransform Angle="180"/>
                                        <TranslateTransform X="5"
                                                            Y="9"/>
                                    </TransformCollection>
                                </TransformGroup.Children>
                            </TransformGroup>
                        </Canvas.RenderTransform>
                        <Path x:Name="Background"
                              Fill="{StaticResource HorizontalSliderThumbNormalBackgroundInverted.Office2003}"
                              Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"/>
                        <Path x:Name="InnerBorder"
                              Stroke="Transparent"
                              StrokeThickness="1"
                              Data="{StaticResource SliderPointedThumbMiddleBorderGeometry}"/>
                        <Path x:Name="OuterBorder"
                              Stroke="#FF929292"
                              StrokeThickness="1"
                              Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"/>
                    </Canvas>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" 
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbMouseOver.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>
                            <Setter TargetName="OuterBorder"
                                    Property="Stroke" Value="{StaticResource BorderBrush.Office2003}"/>

                        </Trigger>

                        <Trigger Property="IsDragging"
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbSelected.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>

                            <Setter TargetName="OuterBorder"
                                    Property="Stroke"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="HorizontalSliderDownThumbStyleBlue"
           TargetType="{x:Type Thumb}">
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="Height"
                Value="18"/>
        <Setter Property="Width"
                Value="10"/>
        <Setter Property="Foreground"
                Value="Gray"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Canvas SnapsToDevicePixels="true">
                        <Canvas.RenderTransform>

                            <TranslateTransform X="5"
                                                Y="9"/>
                        </Canvas.RenderTransform>
                        <Path x:Name="Background"
                              Fill="{StaticResource HorizontalSliderThumbNormalBackground.Office2003}"
                              Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"/>
                        <Path x:Name="InnerBorder"
                              Stroke="Transparent"
                              StrokeThickness="1"
                              Data="{StaticResource SliderPointedThumbMiddleBorderGeometry}"/>
                        <Path x:Name="OuterBorder"
                              Stroke="#FF929292"
                              StrokeThickness="1"
                              Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"/>
                    </Canvas>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" 
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbMouseOver.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>
                            <Setter TargetName="OuterBorder"
                                    Property="Stroke" Value="{StaticResource BorderBrush.Office2003}"/>

                        </Trigger>

                        <Trigger Property="IsDragging"
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbSelected.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>

                            <Setter TargetName="OuterBorder"
                                    Property="Stroke"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="VerticalSliderThumbStyleBlue"
           TargetType="{x:Type Thumb}">
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="Height"
                Value="11"/>
        <Setter Property="Width"
                Value="22"/>
        <Setter Property="Foreground"
                Value="Gray"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Canvas SnapsToDevicePixels="true">
                        <Canvas.RenderTransform>
                            <TransformGroup>
                                <TransformGroup.Children>
                                    <TransformCollection>
                                        <RotateTransform Angle="90"/>
                                        <TranslateTransform X="11"
                                                            Y="5.5"/>
                                    </TransformCollection>
                                </TransformGroup.Children>
                            </TransformGroup>
                        </Canvas.RenderTransform>
                        <Path x:Name="Background"
                              Fill="{StaticResource VerticalSliderThumbNormalBackground.Office2003}"
                              Data="{StaticResource SliderThumbOuterBorderGeometry}"/>
                        <Path x:Name="InnerBorder"
                              Stroke="Transparent"
                              StrokeThickness="1"
                              Data="{StaticResource SliderThumbMiddleBorderGeometry}"/>
                        <Path x:Name="OuterBorder"
                              Stroke="#FF929292"
                              StrokeThickness="1"
                              Data="{StaticResource SliderThumbOuterBorderGeometry}"/>
                    </Canvas>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" 
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbMouseOver.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>
                            <Setter TargetName="OuterBorder"
                                    Property="Stroke" Value="{StaticResource BorderBrush.Office2003}"/>

                        </Trigger>

                        <Trigger Property="IsDragging"
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbSelected.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>

                            <Setter TargetName="OuterBorder"
                                    Property="Stroke"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="VerticalSliderLeftThumbStyleBlue"
           TargetType="{x:Type Thumb}">
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="Height"
                Value="10"/>
        <Setter Property="Width"
                Value="18"/>
        <Setter Property="Foreground"
                Value="Gray"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Canvas SnapsToDevicePixels="true">
                        <Canvas.RenderTransform>
                            <TransformGroup>
                                <TransformGroup.Children>
                                    <TransformCollection>
                                        <RotateTransform Angle="90"/>
                                        <TranslateTransform X="9"
                                                            Y="5"/>
                                    </TransformCollection>
                                </TransformGroup.Children>
                            </TransformGroup>
                        </Canvas.RenderTransform>
                        <Path x:Name="Background"
                              Fill="{StaticResource VerticalSliderThumbNormalBackground.Office2003}"
                              Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"/>
                        <Path x:Name="InnerBorder"
                              Stroke="Transparent"
                              StrokeThickness="1"
                              Data="{StaticResource SliderPointedThumbMiddleBorderGeometry}"/>
                        <Path x:Name="OuterBorder"
                              Stroke="#FF929292"
                              StrokeThickness="1"
                              Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"/>
                    </Canvas>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" 
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbMouseOver.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>
                            <Setter TargetName="OuterBorder"
                                    Property="Stroke" Value="{StaticResource BorderBrush.Office2003}"/>

                        </Trigger>

                        <Trigger Property="IsDragging"
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbSelected.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>

                            <Setter TargetName="OuterBorder"
                                    Property="Stroke"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="VerticalSliderRightThumbStyleBlue"
           TargetType="{x:Type Thumb}">
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="Height"
                Value="10"/>
        <Setter Property="Width"
                Value="18"/>
        <Setter Property="Foreground"
                Value="Gray"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Canvas SnapsToDevicePixels="true">
                        <Canvas.RenderTransform>
                            <TransformGroup>
                                <TransformGroup.Children>
                                    <TransformCollection>
                                        <RotateTransform Angle="-90"/>
                                        <TranslateTransform X="9"
                                                            Y="5"/>
                                    </TransformCollection>
                                </TransformGroup.Children>
                            </TransformGroup>
                        </Canvas.RenderTransform>
                        <Path x:Name="Background"
                              Fill="{StaticResource VerticalSliderThumbNormalBackgroundInverted.Office2003}"
                              Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"/>
                        <Path x:Name="InnerBorder"
                              Stroke="Transparent"
                              StrokeThickness="1"
                              Data="{StaticResource SliderPointedThumbMiddleBorderGeometry}"/>
                        <Path x:Name="OuterBorder"
                              Stroke="#FF929292"
                              StrokeThickness="1"
                              Data="{StaticResource SliderPointedThumbOuterBorderGeometry}"/>
                    </Canvas>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" 
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbMouseOver.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>
                            <Setter TargetName="OuterBorder"
                                    Property="Stroke" Value="{StaticResource BorderBrush.Office2003}"/>

                        </Trigger>

                        <Trigger Property="IsDragging"
                                 Value="true">
                            <Setter TargetName="Background"
                                    Property="Fill"
                                    Value="{StaticResource SliderThumbSelected.Blue}"/>
                            <Setter TargetName="InnerBorder" Property="Fill" Value="{StaticResource SelectedBrush.Blue}"/>

                            <Setter TargetName="OuterBorder"
                                    Property="Stroke"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate TargetType="{x:Type Slider}" x:Key="Office2003HorizontalSliderTemplate">
        <Border Name="OuterBorder" Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            SnapsToDevicePixels="true">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"
                                               MinHeight="{TemplateBinding Slider.MinHeight}"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <TickBar x:Name="TopTick"
                                     Grid.Row="0"
                                     Visibility="Collapsed"
                                     Placement="Top"
                                     Fill="{TemplateBinding Foreground}"
                                     Height="4"/>
                <TickBar x:Name="BottomTick"
                                     Grid.Row="2"
                                     Visibility="Collapsed"
                                     Placement="Bottom"
                                     Fill="{TemplateBinding Foreground}"
                                     Height="4"/>
                <Border x:Name="TrackBackground"
                                    Grid.Row="1"
                                    Margin="5,0"
                                    VerticalAlignment="center"
                                    BorderBrush="{StaticResource ButtonBorderBrush.Office2003}"
                                    BorderThickness="1"
                                    CornerRadius="1"
                                    Background="{StaticResource ButtonBackgroundBrush.Office2003}"
                                    Height="4.0">
                    <Canvas Margin="-6,-1">
                        <Rectangle x:Name="PART_SelectionRange"
                                               Fill="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"
                                               Height="4.0"
                                               Visibility="Hidden"
                                               StrokeThickness="1.0"
                                               Stroke="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}"/>
                    </Canvas>
                </Border>
                <Track Grid.Row="1"
                                   Name="PART_Track">
                    <Track.DecreaseRepeatButton>
                        <RepeatButton  Style="{StaticResource SliderRepeatButtonStyleBlue}"
                                                  Command="{x:Static Slider.DecreaseLarge}"/>
                    </Track.DecreaseRepeatButton>
                    <Track.IncreaseRepeatButton>
                        <RepeatButton  Style="{StaticResource SliderRepeatButtonStyleBlue}"
                                                  Command="{x:Static Slider.IncreaseLarge}"/>
                    </Track.IncreaseRepeatButton>
                    <Track.Thumb>
                        <Thumb x:Name="Thumb"
                                           Style="{StaticResource HorizontalSliderThumbStyleBlue}"/>
                    </Track.Thumb>
                </Track>

            </Grid>
        </Border>

        <ControlTemplate.Triggers>

            <Trigger Property="TickPlacement"
                                 Value="TopLeft">
                <Setter TargetName="TopTick"
                                    Property="Visibility"
                                    Value="Visible"/>
                <Setter TargetName="Thumb"
                                    Property="Style"
                                    Value="{StaticResource HorizontalSliderUpThumbStyleBlue}"/>
                <Setter TargetName="TrackBackground"
                                    Property="Margin"
                                    Value="5,2,5,0"/>
            </Trigger>

            <Trigger Property="TickPlacement"
                                 Value="BottomRight">
                <Setter TargetName="BottomTick"
                                    Property="Visibility"
                                    Value="Visible"/>
                <Setter TargetName="Thumb"
                                    Property="Style"
                                    Value="{StaticResource HorizontalSliderDownThumbStyleBlue}"/>
                <Setter TargetName="TrackBackground"
                                    Property="Margin"
                                    Value="5,0,5,2"/>
            </Trigger>
            <Trigger Property="TickPlacement"
                                 Value="Both">
                <Setter TargetName="TopTick"
                                    Property="Visibility"
                                    Value="Visible"/>
                <Setter TargetName="BottomTick"
                                    Property="Visibility"
                                    Value="Visible"/>
            </Trigger>
            <Trigger Property="IsSelectionRangeEnabled"
                                 Value="true">
                <Setter TargetName="PART_SelectionRange"
                                    Property="Visibility"
                                    Value="Visible"/>
            </Trigger>
            <Trigger Property="IsKeyboardFocused"
                                 Value="true">
                <Setter TargetName="Thumb"
                                    Property="Foreground"
                                    Value="Blue"/>
            </Trigger>

        </ControlTemplate.Triggers>
    </ControlTemplate>


    <ControlTemplate TargetType="{x:Type Slider}" x:Key="Office2003VerticalSliderTemplate">
        <Border Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    SnapsToDevicePixels="true">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"
                                                          MinWidth="{TemplateBinding Slider.MinWidth}"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TickBar x:Name="TopTick"
                                             Grid.Column="0"
                                             Visibility="Collapsed"
                                             Placement="Left"
                                             Fill="{TemplateBinding Foreground}"
                                             Width="4"/>
                <TickBar x:Name="BottomTick"
                                             Grid.Column="2"
                                             Visibility="Collapsed"
                                             Placement="Right"
                                             Fill="{TemplateBinding Foreground}"
                                             Width="4"/>
                <Border Name="TrackBackground"
                                            Grid.Column="1"
                                            Margin="0,5"
                                            HorizontalAlignment="center"
                                            BorderBrush="{StaticResource VerticalSliderTrackNormalBorder.Blue}"
                                            BorderThickness="1"
                                            CornerRadius="1"
                                            Background="{StaticResource VerticalSliderThumbNormalBackground.Office2003}"
                                            Width="4.0">

                    <Canvas Margin="-1,-6">
                        <Rectangle x:Name="PART_SelectionRange"
                                                       Fill="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"
                                                       Width="4.0"
                                                       Visibility="Hidden"
                                                       StrokeThickness="1.0"
                                                       Stroke="{DynamicResource {x:Static SystemColors.ControlDarkDarkBrushKey}}"/>
                    </Canvas>
                </Border>

                <Track Grid.Column="1"
                                           Name="PART_Track">
                    <Track.DecreaseRepeatButton>
                        <RepeatButton Style="{StaticResource SliderRepeatButtonStyleBlue}"
                                                          Command="{x:Static Slider.DecreaseLarge}"/>
                    </Track.DecreaseRepeatButton>
                    <Track.IncreaseRepeatButton>
                        <RepeatButton Style="{StaticResource SliderRepeatButtonStyleBlue}"
                                                          Command="{x:Static Slider.IncreaseLarge}"/>
                    </Track.IncreaseRepeatButton>
                    <Track.Thumb>
                        <Thumb x:Name="Thumb"
                                                   Style="{StaticResource VerticalSliderThumbStyleBlue}"/>
                    </Track.Thumb>
                </Track>
            </Grid>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="TickPlacement"
                                         Value="TopLeft">
                <Setter TargetName="TopTick"
                                            Property="Visibility"
                                            Value="Visible"/>
                <Setter TargetName="Thumb"
                                            Property="Style"
                                            Value="{StaticResource VerticalSliderLeftThumbStyleBlue}"/>
                <Setter TargetName="TrackBackground"
                                            Property="Margin"
                                            Value="2,5,0,5"/>
            </Trigger>
            <Trigger Property="TickPlacement"
                                         Value="BottomRight">
                <Setter TargetName="BottomTick"
                                            Property="Visibility"
                                            Value="Visible"/>
                <Setter TargetName="Thumb"
                                            Property="Style"
                                            Value="{StaticResource VerticalSliderRightThumbStyleBlue}"/>
                <Setter TargetName="TrackBackground"
                                            Property="Margin"
                                            Value="0,5,2,5"/>
            </Trigger>
            <Trigger Property="TickPlacement"
                                         Value="Both">
                <Setter TargetName="TopTick"
                                            Property="Visibility"
                                            Value="Visible"/>
                <Setter TargetName="BottomTick"
                                            Property="Visibility"
                                            Value="Visible"/>
            </Trigger>
            <Trigger Property="IsSelectionRangeEnabled"
                                         Value="true">
                <Setter TargetName="PART_SelectionRange"
                                            Property="Visibility"
                                            Value="Visible"/>
            </Trigger>
            <Trigger Property="IsKeyboardFocused"
                                         Value="true">
                <Setter TargetName="Thumb"
                                            Property="Foreground"
                                            Value="Blue"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>



    <!-- TabControl -->
    <ControlTemplate TargetType="{x:Type TabControl}" x:Key="Office2003TabControlTemplate">
        <Grid KeyboardNavigation.TabNavigation="Local" 
                          SnapsToDevicePixels="true"
                          ClipToBounds="true">
            <Grid.ColumnDefinitions>
                <ColumnDefinition x:Name="ColumnDefinition0"/>
                <ColumnDefinition x:Name="ColumnDefinition1"
                                              Width="0"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition x:Name="RowDefinition0"
                                           Height="Auto"/>
                <RowDefinition x:Name="RowDefinition1"
                                           Height="*"/>
            </Grid.RowDefinitions>
            <TabPanel x:Name="HeaderPanel"
                                  Panel.ZIndex ="1" 
                                  KeyboardNavigation.TabIndex="1"
                                  Grid.Column="0" 
                                  Grid.Row="0"
                                  Margin="2,2,2,0"
                                  IsItemsHost="true" Background="{StaticResource TabHeaderPanelBackground.Blue}"/>
            <Border x:Name="ContentPanel" CornerRadius="5"
                                Background="{TemplateBinding Background}"
                                BorderThickness="2,0,2,0"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                KeyboardNavigation.TabNavigation="Local"
                                KeyboardNavigation.DirectionalNavigation="Contained"
                                KeyboardNavigation.TabIndex="2"
                                Grid.Column="0"
                                Grid.Row="1">
                <ContentPresenter x:Name="PART_SelectedContentHost"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                              Margin="{TemplateBinding Padding}"
                                              ContentSource="SelectedContent"/>
            </Border>
        </Grid>
        <ControlTemplate.Triggers>

            <Trigger Property="TabStripPlacement"
                                 Value="Bottom">
                <Setter Property="Grid.Row"
                                    Value="1"
                                    TargetName="HeaderPanel"/>
                <Setter Property="Grid.Row"
                                    Value="0"
                                    TargetName="ContentPanel"/>
                <Setter Property="Height"
                                    Value="*"
                                    TargetName="RowDefinition0"/>
                <Setter Property="Height"
                                    Value="Auto"
                                    TargetName="RowDefinition1"/>
                <Setter Property="Margin"
                                    Value="2,0,2,2"
                                    TargetName="HeaderPanel"/>
            </Trigger>
            <Trigger Property="TabStripPlacement"
                                 Value="Left">
                <Setter Property="Grid.Row"
                                    Value="0"
                                    TargetName="HeaderPanel"/>
                <Setter Property="Grid.Row"
                                    Value="0"
                                    TargetName="ContentPanel"/>
                <Setter Property="Grid.Column"
                                    Value="0"
                                    TargetName="HeaderPanel"/>
                <Setter Property="Grid.Column"
                                    Value="1"
                                    TargetName="ContentPanel"/>
                <Setter Property="Width"
                                    Value="Auto"
                                    TargetName="ColumnDefinition0"/>
                <Setter Property="Width"
                                    Value="*"
                                    TargetName="ColumnDefinition1"/>
                <Setter Property="Height"
                                    Value="*"
                                    TargetName="RowDefinition0"/>
                <Setter Property="Height"
                                    Value="0"
                                    TargetName="RowDefinition1"/>
                <Setter Property="Margin"
                                    Value="2,2,0,2"
                                    TargetName="HeaderPanel"/>
            </Trigger>
            <Trigger Property="TabStripPlacement"
                                 Value="Right">
                <Setter Property="Grid.Row"
                                    Value="0"
                                    TargetName="HeaderPanel"/>
                <Setter Property="Grid.Row"
                                    Value="0"
                                    TargetName="ContentPanel"/>
                <Setter Property="Grid.Column"
                                    Value="1"
                                    TargetName="HeaderPanel"/>
                <Setter Property="Grid.Column"
                                    Value="0"
                                    TargetName="ContentPanel"/>
                <Setter Property="Width"
                                    Value="*"
                                    TargetName="ColumnDefinition0"/>
                <Setter Property="Width"
                                    Value="Auto"
                                    TargetName="ColumnDefinition1"/>
                <Setter Property="Height"
                                    Value="*"
                                    TargetName="RowDefinition0"/>
                <Setter Property="Height"
                                    Value="0"
                                    TargetName="RowDefinition1"/>
                <Setter Property="Margin"
                                    Value="0,2,2,2"
                                    TargetName="HeaderPanel"/>
            </Trigger>
            <Trigger Property="IsEnabled" 
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>
    <ControlTemplate TargetType="{x:Type TabItem}" x:Key="Office2003TabItemTemplate">
        <Grid Margin="2,3,2,0" SnapsToDevicePixels="true">
            <Border Height="23" Name="Bd" 
                  Background="Transparent">

                <Grid  ClipToBounds="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="7"></ColumnDefinition>
                        <ColumnDefinition></ColumnDefinition>
                        <ColumnDefinition Width="7"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Path Name="leftPath" Fill="{TemplateBinding BorderBrush}" Grid.Column="0">
                        <Path.Data>
                            <PathGeometry>
                                <PathFigure StartPoint="0,30">
                                    <LineSegment Point="0,21.5" />
                                    <ArcSegment Point="2,19" Size="2,2" RotationAngle="0" SweepDirection="Counterclockwise"/>
                                    <LineSegment Point="2,5" />
                                    <ArcSegment Point="7,0" Size="5,5" RotationAngle="0" SweepDirection="Clockwise"/>
                                    <LineSegment Point="7,30" />
                                    <LineSegment Point="0,30" />
                                </PathFigure>
                            </PathGeometry>
                        </Path.Data>
                    </Path>
                    <Path Name="PART_leftPath"  Fill="{TemplateBinding Background}" Grid.Column="0">
                        <Path.Data>
                            <PathGeometry>
                                <PathFigure StartPoint="0,23">
                                    <ArcSegment Point="3,21" Size="3,3" RotationAngle="0" SweepDirection="Counterclockwise"/>
                                    <LineSegment Point="3,5" />
                                    <ArcSegment Point="7,1" Size="4,4" RotationAngle="0" SweepDirection="Clockwise"/>
                                    <LineSegment Point="7,23" />
                                    <LineSegment Point="0,23" />
                                </PathFigure>
                            </PathGeometry>
                        </Path.Data>
                    </Path>

                    <Border Name="PART_highlightBorder"
                      Grid.Column="1"
                    
                      Margin="-5.7,-3.5,-5.7,0"
                      BorderThickness="2,2,2,0"
                      CornerRadius="4,4,0,0"
                      Height="20"
                      Opacity="0.75"/>

                    <Border Name="PART_highlightContour" Grid.Column="1"/>

                    <Border  Name="MainButton"
                      
                      Margin="-1,0,-1,0"
                      Grid.Column="1"
                      BorderThickness="0,1,0,0"
                      BorderBrush="{TemplateBinding BorderBrush}"
                      Background="{TemplateBinding Background}">

                        <ContentPresenter Name="Content"
                                              ContentSource="Header"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                              HorizontalAlignment="{Binding Path=HorizontalContentAlignment,RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                              VerticalAlignment="{Binding Path=VerticalContentAlignment,RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"
                                              RecognizesAccessKey="True"/>



                    </Border>

                    <Path Name="rightPath" Fill="{TemplateBinding BorderBrush}" Grid.Column="2">
                        <Path.Data>
                            <PathGeometry>
                                <PathFigure StartPoint="7,28">
                                    <LineSegment Point="7,21.5"/>
                                    <ArcSegment Point="5,19" Size="2,2" RotationAngle="0" SweepDirection="Clockwise"/>
                                    <LineSegment Point="5,5" />
                                    <ArcSegment Point="0,0" Size="5,5" RotationAngle="0" SweepDirection="Counterclockwise"/>
                                    <LineSegment Point="0,28" />
                                    <LineSegment Point="7,28" />
                                </PathFigure>
                            </PathGeometry>
                        </Path.Data>
                    </Path>
                    <Path Name="PART_rightPath" Fill="{TemplateBinding Background}" Grid.Column="2">
                        <Path.Data>
                            <PathGeometry>
                                <PathFigure StartPoint="7,23">
                                    <ArcSegment Point="4,21" Size="3,3" RotationAngle="0" SweepDirection="Clockwise"/>
                                    <LineSegment Point="4,5" />
                                    <ArcSegment Point="0,1" Size="4,4" RotationAngle="0" SweepDirection="Counterclockwise"/>
                                    <LineSegment Point="0,23" />
                                    <LineSegment Point="7,23" />
                                </PathFigure>
                            </PathGeometry>
                        </Path.Data>
                    </Path>
                </Grid>
            </Border>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="false"/>
                    <Condition Property="IsMouseOver"
                                           Value="true"/>
                </MultiTrigger.Conditions>

                <Setter TargetName="PART_highlightBorder" Property="BorderBrush" Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter TargetName="PART_highlightBorder" Property="BorderThickness" Value="1,1,1,1"/>
                <Setter TargetName="PART_highlightBorder" Property="Height" Value="22.83"/>
                <Setter TargetName="PART_highlightBorder" Property="Margin" Value="-5.7,0,-5.7,0"/>

                <Setter  TargetName="PART_highlightBorder" Property="Background" Value="{StaticResource TabMouseOver.Office2003}"/>

                <Setter TargetName="MainButton" Property="Background" Value="{StaticResource TabMouseOver.Office2003}"/>
                <Setter TargetName="PART_rightPath" Property="Fill" Value="{StaticResource TabMouseOver.Office2003}"/>
                <Setter TargetName="PART_leftPath" Property="Fill" Value="{StaticResource TabMouseOver.Office2003}"/>



            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="True"/>
                    <Condition Property="IsMouseOver" 
                                          Value="false"/>

                </MultiTrigger.Conditions>
                <Setter Property="Panel.ZIndex"
                                    Value="1"/>
                <Setter TargetName="MainButton"
                                    Property="Background"
                                    Value="{StaticResource TabSelected.Office2003}"/>
                <Setter TargetName="PART_leftPath" Property="Fill" Value="{StaticResource TabSelected.Office2003}"/>
                <Setter TargetName="PART_rightPath" Property="Fill" Value="{StaticResource TabSelected.Office2003}"/>

                <Setter TargetName="MainButton"
                                    Property="BorderBrush"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>

                <Setter TargetName="rightPath" Property="Fill" Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                <Setter TargetName="leftPath" Property="Fill" Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                <Setter Property="Foreground" Value="Black"/>
            </MultiTrigger>

            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected" Value="True"/>
                    <Condition Property="IsMouseOver" Value="True"/>
                </MultiTrigger.Conditions>
                <!--#FF8DB2E3highlightborder-->
                <Setter TargetName="MainButton"
                                    Property="Background"
                                    Value="{StaticResource TabSelected.Office2003}"/>
                <Setter TargetName="PART_leftPath" Property="Fill" Value="{StaticResource TabSelected.Office2003}"/>
                <Setter TargetName="PART_rightPath" Property="Fill" Value="{StaticResource TabSelected.Office2003}"/>
                <Setter TargetName="PART_highlightBorder"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush1.Blue}"/>
                <Setter TargetName="MainButton" Property="BorderBrush" Value="{StaticResource BorderBrush1.Blue}"/>
                <Setter TargetName="rightPath" Property="Fill" Value="{StaticResource BorderBrush1.Blue}"/>
                <Setter TargetName="leftPath" Property="Fill" Value="{StaticResource BorderBrush1.Blue}"/>
                <Setter Property="Foreground" Value="Black"/>

            </MultiTrigger>

            <Trigger Property="TabStripPlacement"
                                 Value="Bottom">
                <Setter TargetName="Bd"
                                    Property="BorderThickness"
                                    Value="1,0,1,1"/>
            </Trigger>
            <Trigger Property="TabStripPlacement"
                                 Value="Left">
                <Setter TargetName="Bd"
                                    Property="BorderThickness"
                                    Value="1,1,0,1"/>
            </Trigger>
            <Trigger Property="TabStripPlacement"
                                 Value="Right">
                <Setter TargetName="Bd"
                                    Property="BorderThickness"
                                    Value="0,1,1,1"/>
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="true"/>
                    <Condition Property="TabStripPlacement"
                                           Value="Top"/>
                </MultiTrigger.Conditions>
                <Setter Property="Margin"
                                    Value="-2,-2,-2,-1"/>
                <Setter TargetName="Content"
                                    Property="Margin"
                                    Value="0,0,0,1"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="true"/>
                    <Condition Property="TabStripPlacement"
                                           Value="Bottom"/>
                </MultiTrigger.Conditions>
                <Setter Property="Margin"
                                    Value="-2,-1,-2,-2"/>
                <Setter TargetName="Content"
                                    Property="Margin"
                                    Value="0,1,0,0"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="true"/>
                    <Condition Property="TabStripPlacement"
                                           Value="Left"/>
                </MultiTrigger.Conditions>
                <Setter Property="Margin"
                                    Value="-2,-2,-1,-2"/>
                <Setter TargetName="Content"
                                    Property="Margin"
                                    Value="0,0,1,0"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="true"/>
                    <Condition Property="TabStripPlacement"
                                           Value="Right"/>
                </MultiTrigger.Conditions>
                <Setter Property="Margin"
                                    Value="-1,-2,-2,-2"/>
                <Setter TargetName="Content"
                                    Property="Margin"
                                    Value="1,0,0,0"/>
            </MultiTrigger>


        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- Frame -->
    <LinearGradientBrush x:Key="GridBackground" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStop Offset="0" Color="#D5E3F1"/>
            <GradientStop Offset="0.06" Color="#C8DBEE"/>
            <GradientStop Offset="0.39" Color="#C9DDF6"/>
            <GradientStop Offset="0.45" Color="#C0D4ED"/>
            <GradientStop Offset="0.50" Color="#BCD0E9"/>
            <GradientStop Offset="0.56" Color="#C1D3EC"/>
            <GradientStop Offset="0.66" Color="#C2D5ED"/>
            <GradientStop Offset="0.71" Color="#C6D9F1"/>
            <GradientStop Offset="0.77" Color="#C8DBF3"/>
            <GradientStop Offset="0.94" Color="#D0E1F7"/>
            <GradientStop Offset="1.00" Color="#E3EDFB"/>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>

    <LinearGradientBrush x:Key="NormalBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStop Color="#FFF9D1" Offset="1"/>
            <GradientStop Color="#FFEAA3" Offset="0.65"/>
            <GradientStop Color="#FFD75C" Offset="0.6"/>
            <GradientStop Color="#FFD456" Offset="0.25"/>
            <GradientStop Color="#FFE395" Offset="0.05"/>
            <GradientStop Color="#FFEAAD" Offset="0"/>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetNormalBrush>-->

    <!--<SnippetHorizontalNormalBrush>-->
    <LinearGradientBrush x:Key="HorizontalNormalBrush" StartPoint="0,0" EndPoint="1,0">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#FFF" Offset="0.0"/>
                <GradientStop Color="#CCC" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetHorizontalNormalBrush>-->

    <!--<SnippetLightBrush>-->
    <LinearGradientBrush x:Key="LightBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#FFF" Offset="0.0"/>
                <GradientStop Color="#EEE" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetLightBrush>-->

    <!--<SnippetHorizontalLightBrush>-->
    <LinearGradientBrush x:Key="HorizontalLightBrush" StartPoint="0,0" EndPoint="1,0">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#FFF" Offset="0.0"/>
                <GradientStop Color="#EEE" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetHorizontalLightBrush>-->

    <!--<SnippetDarkBrush>-->
    <LinearGradientBrush x:Key="DarkBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStop Color="#FED5A8" Offset="1"/>
            <GradientStop Color="#FCBC7A" Offset="0.65"/>
            <GradientStop Color="#F99630" Offset="0.6"/>
            <GradientStop Color="#FCC869" Offset="0.25"/>
            <GradientStop Color="#FDECA2" Offset="0.05"/>
            <GradientStop Color="#FDF1B0" Offset="0"/>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetDarkBrush>-->

    <!--<SnippetPressedBrush>-->
    <LinearGradientBrush x:Key="PressedBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStop Color="#F6B96B" Offset="1"/>
            <GradientStop Color="#FDAA63" Offset="0.65"/>
            <GradientStop Color="#FC8F3C" Offset="0.6"/>
            <GradientStop Color="#FFBC61" Offset="0.25"/>
            <GradientStop Color="#FFCB7F" Offset="0.05"/>
            <GradientStop Color="#FFD086" Offset="0"/>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetPressedBrush>-->

    <!--<SnippetDisabledForegroundBrush>-->
    <SolidColorBrush x:Key="DisabledForegroundBrush" Color="#888" />
    <!--</SnippetDisabledForegroundBrush>-->

    <!--<SnippetDisabledBackgroundBrush>-->
    <SolidColorBrush x:Key="DisabledBackgroundBrush" Color="#EEE" />
    <!--</SnippetDisabledBackgroundBrush>-->

    <!--<SnippetWindowBackgroundBrush>-->
    <SolidColorBrush x:Key="WindowBackgroundBrush" Color="#FFF" />
    <!--</SnippetWindowBackgroundBrush>-->

    <!--<SnippetSelectedBackgroundBrush>-->
    <!--<SolidColorBrush x:Key="SelectedBackgroundBrush" Color="#DDD" />-->
    <!--</SnippetSelectedBackgroundBrush>-->

    <!-- Border Brushes -->
    <LinearGradientBrush x:Key="SelectedBackgroundBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStop Color="#FFF9D1" Offset="1"/>
            <GradientStop Color="#FFEAA3" Offset="0.65"/>
            <GradientStop Color="#FFD75C" Offset="0.6"/>
            <GradientStop Color="#FFD456" Offset="0.25"/>
            <GradientStop Color="#FFE395" Offset="0.05"/>
            <GradientStop Color="#FFEAAD" Offset="0"/>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--<SnippetNormalBorderBrush>-->
    <LinearGradientBrush x:Key="NormalBorderBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStop Offset="0" Color="#D5E3F1"/>
            <GradientStop Offset="0.06" Color="#C8DBEE"/>
            <GradientStop Offset="0.39" Color="#C9DDF6"/>
            <GradientStop Offset="0.45" Color="#C0D4ED"/>
            <GradientStop Offset="0.50" Color="#BCD0E9"/>
            <GradientStop Offset="0.56" Color="#C1D3EC"/>
            <GradientStop Offset="0.66" Color="#C2D5ED"/>
            <GradientStop Offset="0.71" Color="#C6D9F1"/>
            <GradientStop Offset="0.77" Color="#C8DBF3"/>
            <GradientStop Offset="0.94" Color="#D0E1F7"/>
            <GradientStop Offset="1.00" Color="#E3EDFB"/>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetNormalBorderBrush>-->

    <!--<SnippetHorizontalNormalBorderBrush>-->
    <LinearGradientBrush x:Key="HorizontalNormalBorderBrush" StartPoint="0,0" EndPoint="1,0">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#CCC" Offset="0.0"/>
                <GradientStop Color="#444" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetHorizontalNormalBorderBrush>-->

    <!--<SnippetDefaultedBorderBrush>-->
    <LinearGradientBrush x:Key="DefaultedBorderBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#777" Offset="0.0"/>
                <GradientStop Color="#000" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetDefaultedBorderBrush>-->



    <!--<SnippetPressedBorderBrush>-->
    <LinearGradientBrush x:Key="PressedBorderBrush" StartPoint="0,0" EndPoint="0,1">
        <GradientBrush.GradientStops>
            <GradientStopCollection>
                <GradientStop Color="#444" Offset="0.0"/>
                <GradientStop Color="#888" Offset="1.0"/>
            </GradientStopCollection>
        </GradientBrush.GradientStops>
    </LinearGradientBrush>
    <!--</SnippetPressedBorderBrush>-->

    <!--<SnippetDisabledBorderBrush>-->
    <SolidColorBrush x:Key="DisabledBorderBrush" Color="#AAA" />
    <!--</SnippetDisabledBorderBrush>-->

    <!--<SnippetSolidBorderBrush>-->
    <SolidColorBrush x:Key="SolidBorderBrush" Color="#888" />
    <!--</SnippetSolidBorderBrush>-->

    <!--<SnippetLightBorderBrush>-->
    <SolidColorBrush x:Key="LightBorderBrush" Color="#AAA" />
    <!--</SnippetLightBorderBrush>-->

    <!-- Miscellaneous Brushes -->
    <!--<SnippetGlyphBrush>-->
    <SolidColorBrush x:Key="GlyphBrush" Color="#444" />
    <!--</SnippetGlyphBrush>-->

    <!--<SnippetLightColorBrush>-->
    <SolidColorBrush x:Key="LightColorBrush" Color="#DDD" />


    <Style x:Key="FrameButtonStyle" TargetType="Button">
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="Command" Value="NavigationCommands.BrowseBack"/>
        <Setter Property="Focusable" Value="false"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid>
                        <Ellipse 
              Name="Ellipse" 
              Fill="{StaticResource NormalBrush}"
              Stroke="Transparent"
              StrokeThickness="1" 
              Width="16"
              Height="16"/>

                        <Path 
              x:Name="Arrow"
              Margin="0,0,2,0"
              Fill="{StaticResource GlyphBrush}"
              HorizontalAlignment="Center"
              VerticalAlignment="Center"
              Data="M 4 0 L 0 4 L 4 8 Z"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="Command"
                     Value="{x:Static NavigationCommands.BrowseForward}">
                            <Setter TargetName="Arrow" Property="Data"
                      Value="M 0 0 L 4 4 L 0 8 z"/>
                            <Setter TargetName="Arrow" Property="Margin" Value="2,0,0,0"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Ellipse" Property="Fill"
                      Value="{StaticResource DarkBrush}"/>
                            <Setter TargetName="Ellipse" Property="Stroke" Value="Orange"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="true">
                            <Setter TargetName="Ellipse" Property="Fill"
                      Value="{StaticResource PressedBrush}" />
                            <Setter TargetName="Ellipse" Property="Stroke"
                      Value="Orange" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter TargetName="Ellipse" Property="Fill"
                      Value="{StaticResource GridBackground}"/>
                            <Setter TargetName="Arrow" Property="Fill"
                      Value="{StaticResource DisabledForegroundBrush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Frame Menu Style -->

    <Style x:Key="FrameMenu" TargetType="Menu">
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="KeyboardNavigation.TabNavigation" Value="None"/>
        <Setter Property="IsMainMenu" Value="false"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Menu">
                    <DockPanel IsItemsHost="true"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Frame Menu Header Style -->

    <Style x:Key="FrameHeaderMenuItem" TargetType="MenuItem">
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="MenuItem">
                    <Grid>
                        <Popup x:Name="PART_Popup"
              Placement="Bottom"
              VerticalOffset="2"
              IsOpen="{TemplateBinding IsSubmenuOpen}"
              AllowsTransparency="True" 
              Focusable="False"
              PopupAnimation="Fade">
                            <Border Name="SubMenuBorder"
                Background="White"
                BorderThickness="1"
                BorderBrush="{StaticResource SolidBorderBrush}">
                                <StackPanel IsItemsHost="true"
                  Margin="2" 
                  KeyboardNavigation.TabNavigation="Cycle"
                  KeyboardNavigation.DirectionalNavigation="Cycle"/>
                            </Border>
                        </Popup>

                        <Grid x:Name="Panel" 
              Width="24" 
              Background="Transparent"
              HorizontalAlignment="Right" >

                            <Border Visibility="Hidden" 
                Name="HighlightBorder" 
                BorderThickness="1" 
                BorderBrush="Orange" 
                Background="Transparent" 
                CornerRadius="2" />
                            <Path x:Name="Arrow"
                SnapsToDevicePixels="false"
                HorizontalAlignment="Right"
                VerticalAlignment="Center"
                Margin="0,2,4,0"
                Fill="{StaticResource GlyphBrush}"
                StrokeLineJoin="Round"
                Data="M 0 0 L 4 4 L 8 0 Z"/>
                        </Grid>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsHighlighted" Value="true">
                            <Setter TargetName="HighlightBorder"
                      Property="Visibility" Value="Visible"/>
                        </Trigger>
                        <Trigger Property="IsSubmenuOpen" Value="true">
                            <Setter TargetName="HighlightBorder"
                      Property="Background" Value="{StaticResource PressedBrush}" />
                            <Setter TargetName="HighlightBorder"
                      Property="BorderBrush" Value="{StaticResource PressedBorderBrush}" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter TargetName="Arrow"
                      Property="Fill"  Value="{StaticResource DisabledForegroundBrush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Frame Menu Item Style -->

    <Style x:Key="FrameSubmenuItem" TargetType="MenuItem">
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="Header" Value="{Binding Path=(JournalEntry.Name)}"/>
        <Setter Property="Command" Value="NavigationCommands.NavigateJournal"/>
        <Setter Property="CommandTarget"
            Value="{Binding RelativeSource={RelativeSource AncestorType={x:Type Menu}},
                            Path=TemplatedParent}"/>
        <Setter Property="CommandParameter"
            Value="{Binding RelativeSource={RelativeSource Self}}"/>
        <Setter Property="JournalEntryUnifiedViewConverter.JournalEntryPosition"
            Value="{Binding (JournalEntryUnifiedViewConverter.JournalEntryPosition)}"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="MenuItem">
                    <Grid Name="Panel"
            Background="Transparent"
            SnapsToDevicePixels="true">
                        <Path Name="Glyph"
              SnapsToDevicePixels="false"
              Margin="7,5"
              Width="10"
              Height="10"
              HorizontalAlignment="Left"
              StrokeStartLineCap="Triangle"
              StrokeEndLineCap="Triangle"
              StrokeThickness="2"
              Stroke="{StaticResource GlyphBrush}" />

                        <ContentPresenter ContentSource="Header"
              Margin="24,5,50,5"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="JournalEntryUnifiedViewConverter.JournalEntryPosition"
                     Value="Current">
                            <Setter TargetName="Glyph"
                      Property="Data" Value="M 0,5 L 2.5,8 L 7,3 "/>
                        </Trigger>
                        <Trigger Property="IsHighlighted" Value="true">
                            <Setter TargetName="Panel" Property="Background"
                      Value="{StaticResource NormalBrush}"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="MenuItem.IsHighlighted" Value="true"/>
                                <Condition Property="JournalEntryUnifiedViewConverter.JournalEntryPosition"
                           Value="Forward"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Glyph" Property="Data" Value="M 3 1 L 7 5 L 3 9 z"/>
                            <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource GlyphBrush}"/>
                            <Setter TargetName="Glyph" Property="Stroke" Value="{x:Null}"/>
                        </MultiTrigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="MenuItem.IsHighlighted" Value="true"/>
                                <Condition Property="JournalEntryUnifiedViewConverter.JournalEntryPosition"
                           Value="Back"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Glyph" Property="Data" Value="M 7 1 L 3 5 L 7 9 z"/>
                            <Setter TargetName="Glyph" Property="Fill" Value="{StaticResource GlyphBrush}"/>
                            <Setter TargetName="Glyph" Property="Stroke" Value="{x:Null}"/>
                        </MultiTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <!-- Merges Back and Forward Navigation Stacks -->

    <JournalEntryUnifiedViewConverter x:Key="JournalEntryUnifiedViewConverter"/>

    <!-- SimpleStyles: Frame -->
    <ControlTemplate TargetType="Frame" x:Key="Office2003FrameNavChromeTemplate">
        <DockPanel>
            <Grid Background="{StaticResource GridBackground}"
              DockPanel.Dock="Top"
              Height="22">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Menu Name="NavMenu"
                Grid.ColumnSpan="3"
                Height="16"
                Margin="1,0,0,0"
                VerticalAlignment="Center" 
                Style="{StaticResource FrameMenu}">
                    <MenuItem Style="{StaticResource FrameHeaderMenuItem}"
                  ItemContainerStyle="{StaticResource FrameSubmenuItem}"
                  IsSubmenuOpen="{Binding Path=(MenuItem.IsSubmenuOpen),Mode=TwoWay,
                                  RelativeSource={RelativeSource TemplatedParent}}">
                        <MenuItem.ItemsSource>
                            <MultiBinding Converter="{StaticResource JournalEntryUnifiedViewConverter}">
                                <MultiBinding.Bindings>
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}" 
                          Path="BackStack" />
                                    <Binding RelativeSource="{RelativeSource TemplatedParent}" 
                          Path="ForwardStack" />
                                </MultiBinding.Bindings>
                            </MultiBinding>
                        </MenuItem.ItemsSource>
                    </MenuItem>
                </Menu>

                <Path Grid.Column="0" 
                SnapsToDevicePixels="false"
                IsHitTestVisible="false"
                Margin="2,0,0,0"
                Grid.ColumnSpan="3"
                StrokeThickness="1" 
                HorizontalAlignment="Left" 
                VerticalAlignment="Center" 
                Data="M15,14 Q18,12.9 20.9,14 A8.3,8.3,0,0,0,35.7,8.7 A8.3,8.3,0,0,0,25.2,0.6 Q18,
                      3.3 10.8,0.6 A8.3,8.3,0,0,0,0.3,8.7 A8.3,8.3,0,0,0,15,14 z"
                Fill="{StaticResource GridBackground}"
                Stroke="{StaticResource LightBorderBrush}"/>
                <Button Style="{StaticResource FrameButtonStyle}"
                Command="NavigationCommands.BrowseBack"
                Content="M 4 0 L 0 4 L 4 8 Z"
                Margin="2.7,0,1.3,0" 
                Grid.Column="0"/>
                <Button Style="{StaticResource FrameButtonStyle}"
                Command="NavigationCommands.BrowseForward"
                Content="M 4 0 L 0 4 L 4 8 Z"
                Margin="1.3,0,0,0" 
                Grid.Column="1"/>
            </Grid>
            <ContentPresenter x:Name="PART_FrameCP"/>
        </DockPanel>
        <ControlTemplate.Triggers>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="CanGoForward" Value="false"/>
                    <Condition Property="CanGoBack" Value="false"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="NavMenu" Property="IsEnabled" Value="false"/>
            </MultiTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- GridView -->
    <ControlTemplate TargetType="{x:Type ScrollViewer}" x:Key="Office2003GridViewScrollViewerTemplate">
        <Grid Background="{TemplateBinding Background}"
                          SnapsToDevicePixels="true">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <DockPanel Margin="{TemplateBinding Padding}">
                <ScrollViewer DockPanel.Dock="Top"
                                          HorizontalScrollBarVisibility="Hidden"
                                          VerticalScrollBarVisibility="Hidden"
                                          Focusable="false">
                    <GridViewHeaderRowPresenter Columns="{Binding Path=TemplatedParent.View.Columns,RelativeSource={RelativeSource TemplatedParent}}"
                                                            ColumnHeaderContainerStyle="{Binding Path=TemplatedParent.View.ColumnHeaderContainerStyle,RelativeSource={RelativeSource TemplatedParent}}"
                                                            ColumnHeaderTemplate="{Binding Path=TemplatedParent.View.ColumnHeaderTemplate,RelativeSource={RelativeSource TemplatedParent}}"
                                                            ColumnHeaderTemplateSelector="{Binding Path=TemplatedParent.View.ColumnHeaderTemplateSelector,RelativeSource={RelativeSource TemplatedParent}}"
                                                            AllowsColumnReorder="{Binding Path=TemplatedParent.View.AllowsColumnReorder,RelativeSource={RelativeSource TemplatedParent}}"
                                                            ColumnHeaderContextMenu="{Binding Path=TemplatedParent.View.ColumnHeaderContextMenu,RelativeSource={RelativeSource TemplatedParent}}"
                                                            ColumnHeaderToolTip="{Binding Path=TemplatedParent.View.ColumnHeaderToolTip,RelativeSource={RelativeSource TemplatedParent}}"
                                                            SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                </ScrollViewer>
                <ScrollContentPresenter Name="PART_ScrollContentPresenter"
                                                    KeyboardNavigation.DirectionalNavigation="Local"
                                                    Content="{TemplateBinding Content}"
                                                    ContentTemplate="{TemplateBinding ContentTemplate}"
                                                    CanContentScroll="{TemplateBinding CanContentScroll}"
                                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            </DockPanel>
            <ScrollBar Name="PART_HorizontalScrollBar"
                                   Orientation="Horizontal"
                                   Grid.Row="1"
                                   Minimum="0.0"
                                   Maximum="{TemplateBinding ScrollableWidth}"
                                   ViewportSize="{TemplateBinding ViewportWidth}"
                                   Value="{Binding Path=HorizontalOffset,RelativeSource={RelativeSource TemplatedParent},Mode=OneWay}"
                                   Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"
                                   Cursor="Arrow"/>
            <ScrollBar Name="PART_VerticalScrollBar"
                                   Orientation="Vertical"
                                   Grid.Column="1"
                                   Minimum="0.0"
                                   Maximum="{TemplateBinding ScrollableHeight}"
                                   ViewportSize="{TemplateBinding ViewportHeight}"
                                   Value="{Binding Path=VerticalOffset,RelativeSource={RelativeSource TemplatedParent},Mode=OneWay}"
                                   Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"
                                   Cursor="Arrow"/>
            <DockPanel Grid.Column="1"
                                   Grid.Row="1"
                                   Background="{Binding Path=Background,ElementName=PART_VerticalScrollBar}"
                                   LastChildFill="false">
                <Rectangle DockPanel.Dock="Left"
                                       Width="1"
                                       Fill="White"
                                       Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
                <Rectangle DockPanel.Dock="Top"
                                       Height="1"
                                       Fill="White"
                                       Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>
            </DockPanel>
        </Grid>
    </ControlTemplate>
    <Style x:Key="BlueGridViewColumnHeaderGripper"
           TargetType="{x:Type Thumb}">
        <Setter Property="Canvas.Right"
                Value="-9"/>
        <Setter Property="Width"
                Value="18"/>
        <Setter Property="Height"
                Value="{Binding Path=ActualHeight,RelativeSource={RelativeSource TemplatedParent}}"/>
        <Setter Property="Padding"
                Value="0"/>
        <Setter Property="Background"
                Value="Transparent"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Border Padding="{TemplateBinding Padding}"
                            Background="Transparent">
                        <Rectangle HorizontalAlignment="Center"
                                   Width="1"
                                   Fill="{TemplateBinding Background}"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate TargetType="{x:Type GridViewColumnHeader}" x:Key="Office2003GridViewTemplate">
        <Border Name="HeaderBorder"
                                    BorderThickness="0"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    Background="{TemplateBinding Background}"/>
        <ControlTemplate.Triggers>
            <Trigger Property="Height"
                                         Value="Auto">
                <Setter Property="MinHeight"
                                            Value="20"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type GridViewColumnHeader}" x:Key="Office2003GridViewColumnHeaderTemplate">
        <Grid SnapsToDevicePixels="true">
            <Border Name="HeaderBorder" 
                               BorderThickness="0,0,1,0"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                Background="{TemplateBinding Background}">
                <ContentPresenter Name="HeaderContent"
                                                      Margin="0"
                                                      VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                      HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                      RecognizesAccessKey="True"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>


            </Border>
            <Canvas>
                <Thumb x:Name="PART_HeaderGripper"
                                   Style="{StaticResource BlueGridViewColumnHeaderGripper}"/>
            </Canvas>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver"
                                 Value="true">
                <Setter TargetName="HeaderBorder"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsPressed"
                                 Value="true">
                <Setter TargetName="HeaderBorder"
                                    Property="Background"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
                <Setter TargetName="PART_HeaderGripper"
                                    Property="Visibility"
                                    Value="Hidden"/>
            </Trigger>
            <Trigger Property="Height"
                                 Value="Auto">
                <Setter Property="MinHeight"
                                    Value="20"/>
            </Trigger>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Foreground"
                                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type ListView}" x:Key="Office2003GridListViewTemplate">
        <Border Name="Bd"
                                         BorderThickness="{TemplateBinding BorderThickness}"
                                         BorderBrush="{TemplateBinding BorderBrush}"
                                         Background="{TemplateBinding Background}"
                                        
                                         SnapsToDevicePixels="true">
            <ScrollViewer Style="{DynamicResource {x:Static GridView.GridViewScrollViewerStyleKey}}"
                                      Padding="{TemplateBinding Padding}">
                <ItemsPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
            </ScrollViewer>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsGrouping"
                                 Value="true">
                <Setter Property="ScrollViewer.CanContentScroll"
                                    Value="false"/>
            </Trigger>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter TargetName="Bd"
                                    Property="Background"
                                    Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>
            </Trigger>

        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type ListViewItem}" x:Key="Office2003GridListViewItemTemplate">
        <Border Name="Bd" BorderThickness="0,1,0,0" Height="22" CornerRadius="2"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            Background="{TemplateBinding Background}"
                            SnapsToDevicePixels="true">


            <GridViewRowPresenter VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>


        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver"
                                 Value="true">
                <Setter Property="Background" TargetName="Bd"
                                    Value="{StaticResource MouseOverBrushIn.Office2003}"/>
            </Trigger>
            <Trigger Property="IsSelected"
                                 Value="true">
                <Setter Property="Background" TargetName="Bd"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="true"/>
                    <Condition Property="Selector.IsSelectionActive"
                                           Value="false"/>
                </MultiTrigger.Conditions>
                <Setter Property="Background" TargetName="Bd"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>

            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsSelected"
                                           Value="true"/>
                    <Condition Property="IsMouseOver"
                                           Value="true"/>
                </MultiTrigger.Conditions>
                <Setter Property="Background" TargetName="Bd"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>

            </MultiTrigger>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- Thumb -->

    <ControlTemplate TargetType="{x:Type Thumb}" x:Key="Office2003ThumbTemplate">
        <Border CornerRadius="1" 
									BorderBrush="{StaticResource VerticalScrollBarBackground.Office2003}" BorderThickness="1.5" Name="PART_RepeatThumb" Background="{StaticResource DefaultThumbBrush.Blue}">
            <Grid  VerticalAlignment="Center" HorizontalAlignment="Center">

                <StackPanel Orientation="Vertical">
                    <Line X1="0" Y1="0" X2="5" Y2="0" Stroke="Black" StrokeThickness="0.5" Margin="2,2,2,2"/>
                </StackPanel>
                <StackPanel Orientation="Vertical">
                    <Line X1="0" Y1="1" X2="5" Y2="1" Stroke="Black" StrokeThickness="0.5" Margin="2,3,2,2"/>
                </StackPanel>
                <StackPanel Orientation="Vertical">
                    <Line X1="0" Y1="2" X2="5" Y2="2" Stroke="Black" StrokeThickness="0.5" Margin="2,4,2,2"/>

                </StackPanel>
                <StackPanel Orientation="Vertical">
                    <Line X1="0" Y1="3" X2="5" Y2="3" Stroke="Black" StrokeThickness="0.5" Margin="2,5,2,2"/>

                </StackPanel>
            </Grid>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="BorderThickness" TargetName="PART_RepeatThumb" Value="1.5"/>
                <Setter Property="BorderBrush" TargetName="PART_RepeatThumb" Value="{StaticResource VerticalScrollBarBackground.Office2003}"/>
                <Setter Property="Background" TargetName="PART_RepeatThumb" Value="{StaticResource thumbMouseOverBrush.Blue}" />
            </Trigger>
            <Trigger Property="IsDragging"  Value="True">
                <Setter Property="BorderThickness" TargetName="PART_RepeatThumb" Value="1.5"/>
                <Setter Property="BorderBrush" TargetName="PART_RepeatThumb" Value="{StaticResource VerticalScrollBarBackground.Office2003}"/>
                <Setter Property="Background" TargetName="PART_RepeatThumb" Value="{StaticResource thumbColorBrush.Blue}" />

            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- ResizeGrip -->
    <LinearGradientBrush x:Key="ResizeGripperForegroundBlue"
                          StartPoint="0,0" EndPoint="0,1">
        <GradientStop Offset="0" Color="#D5E3F1"/>
        <GradientStop Offset="0.06" Color="#C8DBEE"/>
        <GradientStop Offset="0.39" Color="#C9DDF6"/>
        <GradientStop Offset="0.45" Color="#C0D4ED"/>
        <GradientStop Offset="0.50" Color="#BCD0E9"/>
        <GradientStop Offset="0.56" Color="#C1D3EC"/>
        <GradientStop Offset="0.66" Color="#C2D5ED"/>
        <GradientStop Offset="0.71" Color="#C6D9F1"/>
        <GradientStop Offset="0.77" Color="#C8DBF3"/>
        <GradientStop Offset="0.94" Color="#D0E1F7"/>
        <GradientStop Offset="1.00" Color="#E3EDFB"/>
    </LinearGradientBrush>

    <ControlTemplate TargetType="{x:Type ResizeGrip}" x:Key="Office2003ResizeGripTemplate">
        <Grid SnapsToDevicePixels="true" Background="{TemplateBinding Background}">
            <Path HorizontalAlignment="Right" 
                              VerticalAlignment="Bottom" 
                              Margin="0,0,2,2"
                              Data="M 8,0 L 10,0 L 10,2 L 8,2 Z M 4,4 L 6,4 L 6,6 L 4,6 Z M 8,4 L 10,4 L 10,6 L 8,6 Z M 0,8 L 2,8 L 2,10 L 0,10 Z M 4,8 L 6,8 L 6,10 L 4,10 Z M 8,8 L 10,8 L 10,10 L 8,10 Z">

                <Path.Fill>
                    <DrawingBrush Viewbox="0,0,3,3"
                                              Viewport="0,0,3,3"
                                              TileMode="Tile"
                                              ViewportUnits="Absolute"
                                              ViewboxUnits="Absolute">
                        <DrawingBrush.Drawing>
                            <DrawingGroup>
                                <DrawingGroup.Children>
                                    <GeometryDrawing Brush="{StaticResource ResizeGripperForegroundBlue}"
                                                                 Geometry="M 0,0 L 3,0 L 3,3 L 0,3 z "/>
                                </DrawingGroup.Children>
                            </DrawingGroup>
                        </DrawingBrush.Drawing>
                    </DrawingBrush>
                </Path.Fill>
            </Path>
        </Grid>
    </ControlTemplate>

    <!-- ToolBar -->

    <ControlTemplate TargetType="{x:Type Button}" x:Key="Office2003ToolBarButtonTemplate">
        <Border Name="Bd"
                            Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="true">
            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsMouseOver"
                                 Value="true">
                <Setter TargetName="Bd"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter TargetName="Bd"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsKeyboardFocused"
                                 Value="true">
                <Setter TargetName="Bd"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter TargetName="Bd"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsPressed"
                                 Value="true">
                <Setter TargetName="Bd"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter TargetName="Bd"
                                    Property="Background"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type ToggleButton}" x:Key="Office2003ToolBarToggleButtonTemplate">
        <Border Name="Bd" Background="{TemplateBinding Background}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="true">
            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <ControlTemplate.Triggers>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsPressed" Value="True"/>
                    <Condition Property="ToggleButton.IsChecked" Value="True"/>

                </MultiTrigger.Conditions>
                <Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Bd" Value="{StaticResource ButtonPressedBrush.Office2003}"/>
            </MultiTrigger>
            <Trigger Property="IsChecked"
                                 Value="true">
                <Setter Property="BorderBrush" TargetName="Bd"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Bd"
                                   Value="{StaticResource ToggleCheckedBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsMouseOver"
                                 Value="true">
                <Setter Property="BorderBrush" TargetName="Bd"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Bd"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsKeyboardFocused"
                                 Value="true">
                <Setter Property="BorderBrush" TargetName="Bd"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Bd"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsMouseOver"
                                           Value="true"/>
                    <Condition Property="IsChecked"
                                           Value="true"/>
                </MultiTrigger.Conditions>
                <Setter Property="BorderBrush" TargetName="Bd"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Bd"
                                   Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsKeyboardFocused"
                                           Value="true"/>
                    <Condition Property="IsChecked"
                                           Value="true"/>
                </MultiTrigger.Conditions>
                <Setter Property="BorderBrush" TargetName="Bd"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Bd"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
            </MultiTrigger>
            <Trigger Property="IsPressed"
                                 Value="true">
                <Setter Property="BorderBrush" TargetName="Bd"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                <Setter Property="Background" TargetName="Bd"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <Style x:Key="ToolBarComboBoxTransparentButtonStyleBlue"
           TargetType="{x:Type ToggleButton}">
        <Setter Property="MinWidth"
                Value="0"/>
        <Setter Property="MinHeight"
                Value="0"/>
        <Setter Property="Width"
                Value="Auto"/>
        <Setter Property="Background"
                Value="{StaticResource MenuKeyBoardFill.Blue}"/>
        <Setter Property="BorderBrush"
                Value="White"/>
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="ClickMode"
                Value="Press"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Grid Background="Transparent">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"
                                              SharedSizeGroup="ComboBoxButton"/>
                        </Grid.ColumnDefinitions>
                        <Border x:Name="Chrome"
                                Grid.Column="1"
                                Width="13"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="true">
                            <Path x:Name="ArrowDownPath"
                                  Data="M0,0L3.5,4 7,0z"
                                  Fill="black"
                                  HorizontalAlignment="Center" 
                                  VerticalAlignment="Center"/>
                        </Border>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter TargetName="Chrome"
                                    Property="BorderBrush"
                                    Value="{x:Null}"/>
                        </Trigger>
                        <MultiTrigger>
                            <MultiTrigger.Conditions>
                                <Condition Property="IsMouseOver"
                                           Value="true"/>
                                <Condition Property="IsChecked"
                                           Value="false"/>
                            </MultiTrigger.Conditions>
                            <Setter TargetName="Chrome" Property="BorderBrush" Value="{StaticResource BorderBrush.Office2003}"/>
                            <Setter TargetName="Chrome"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                        </MultiTrigger>
                        <Trigger Property="IsChecked"
                                 Value="true">
                            <Setter TargetName="Chrome"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="true">
                            <Setter TargetName="Chrome"
                                    Property="Background"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate TargetType="{x:Type ComboBox}" x:Key="Office2003ToolBarComboBoxTemplate">
        <Grid SnapsToDevicePixels="true">
            <Grid Grid.IsSharedSizeScope="true">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"
                                                  SharedSizeGroup="ComboBoxButton"/>
                </Grid.ColumnDefinitions>
                <Border Name="Background"
                                    Background="{TemplateBinding Background}"/>
                <Border Name="SelectedContentBorder"
                                    Margin="2,2,1,2">
                    <ContentPresenter x:Name="ContentSite"
                                                  Content="{TemplateBinding SelectionBoxItem}"
                                                  ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                  ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                                  Margin="{TemplateBinding Padding}"
                                                  VerticalAlignment="Center"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                </Border>
                <Border Name="Border"
                                    Grid.ColumnSpan="2"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    BorderBrush="White"/>
                <ToggleButton BorderBrush="White"
                                          BorderThickness="1"
                                          x:Name="DropDownButton"
                                          Grid.ColumnSpan="2"
                                          Style="{StaticResource ToolBarComboBoxTransparentButtonStyleBlue}"
                                          IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}"/>
                <TextBox Padding="{TemplateBinding Padding}"
                                     Margin="1,1,0,1"
                                     MinHeight="18"
                                     x:Name="PART_EditableTextBox"
                                     Style="{StaticResource BlueComboBoxEditableTextBox}"
                                     Visibility="Collapsed"
                                     IsReadOnly="{Binding Path=IsReadOnly,RelativeSource={RelativeSource TemplatedParent}}"
                                     VerticalAlignment="Center"/>
            </Grid>
            <Popup Name="PART_Popup"
                               AllowsTransparency="true"
                               Placement="Bottom"
                               IsOpen="{Binding Path=IsDropDownOpen,RelativeSource={RelativeSource TemplatedParent}}"
                               Focusable="false"
                               PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}">
                <theme:SystemDropShadowChrome Name="Shdw"
                                                          Color="Transparent" 
                                                          MinWidth="{TemplateBinding ActualWidth}"
                                                          MaxHeight="{TemplateBinding MaxDropDownHeight}">
                    <Border x:Name="DropDownBorder"
                                        Background="{TemplateBinding Background}"
                                        BorderThickness="1"
                                        BorderBrush="{StaticResource ButtonBorderBrush.Office2003}">
                        <ScrollViewer>
                            <ItemsPresenter KeyboardNavigation.DirectionalNavigation="Contained"/>
                        </ScrollViewer>
                    </Border>
                </theme:SystemDropShadowChrome>
            </Popup>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <!--<MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsKeyboardFocusWithin"
                                           Value="true"/>
                    <Condition Property="IsDropDownOpen"
                                           Value="false"/>
                    <Condition Property="IsEditable"
                                           Value="false"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="SelectedContentBorder"
                                    Property="Background"
                                    Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
            </MultiTrigger>-->
            <Trigger Property="IsEditable"
                                 Value="true">
                <Setter TargetName="DropDownButton"
                                    Property="Background"
                                    Value="{x:Null}"/>
                <Setter TargetName="ContentSite"
                                    Property="Visibility"
                                    Value="Collapsed"/>
                <Setter TargetName="PART_EditableTextBox"
                                    Property="Visibility"
                                    Value="Visible"/>
            </Trigger>
            <Trigger Property="IsMouseOver"
                                 Value="true">
                <Setter TargetName="DropDownButton"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Blue}"/>
                <Setter TargetName="DropDownButton"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                <Setter TargetName="Border"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Blue}"/>

            </Trigger>

            <Trigger Property="IsKeyboardFocusWithin"
                                 Value="true">
                <Setter TargetName="DropDownButton"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Blue}"/>
                <Setter TargetName="DropDownButton"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                <Setter TargetName="Border"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Blue}"/>
            </Trigger>



            <Trigger SourceName="PART_Popup"
                                 Property="Popup.HasDropShadow"
                                 Value="true">
                <Setter TargetName="Shdw"
                                    Property="Margin"
                                    Value="0,0,5,5"/>
                <Setter TargetName="Shdw"
                                    Property="SnapsToDevicePixels"
                                    Value="true"/>
                <Setter TargetName="Shdw"
                                    Property="Color"
                                    Value="#71000000"/>
            </Trigger>
            <Trigger Property="HasItems"
                                 Value="false">
                <Setter TargetName="DropDownBorder"
                                    Property="MinHeight"
                                    Value="95"/>
            </Trigger>
            <Trigger Property="IsGrouping"
                                 Value="true">
                <Setter Property="ScrollViewer.CanContentScroll"
                                    Value="false"/>
            </Trigger>
            <!--<MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsKeyboardFocusWithin"
                                           Value="true"/>
                    <Condition Property="IsDropDownOpen"
                                           Value="false"/>
                    <Condition Property="IsEditable"
                                           Value="false"/>
                </MultiTrigger.Conditions>
                <Setter Property="Foreground"
                                    Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
            </MultiTrigger>-->
            <Trigger Property="IsEditable"
                                 Value="true">
                <Setter Property="Padding"
                                    Value="2"/>
                <Setter Property="IsTabStop"
                                    Value="false"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type TextBox}" x:Key="Office2003ToolBarTextBoxTemplate">
        <Border Name="Border" 
                            Background="{TemplateBinding Background}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            SnapsToDevicePixels="true">
            <ScrollViewer x:Name="PART_ContentHost"
                                      VerticalAlignment="Center"
                                      MinHeight="18"/>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <Trigger Property="IsMouseOver"
                                 Value="true">
                <Setter TargetName="Border"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsKeyboardFocusWithin"
                                 Value="true">
                <Setter TargetName="Border"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>




    <Style x:Key="BlueToolBarHorizontalOverflowButtonStyle"
           TargetType="{x:Type ToggleButton}">
        <Setter Property="Background"
                Value="{StaticResource ToolBarOverflowButtonBackground.Blue}"/>
        <Setter Property="MinHeight"
                Value="0"/>
        <Setter Property="MinWidth"
                Value="0"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border Name="Bd"
                            CornerRadius="0,3,3,0"
                            Background="{TemplateBinding Background}"
                            SnapsToDevicePixels="true">
                        <Canvas Width="6"
                                Height="7"
                                Margin="7,2,2,2"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Bottom"
                                SnapsToDevicePixels="true">
                            <Path Stroke="White"
                                  Data="M 1 1.5 L 6 1.5"/>
                            <Path Stroke="{TemplateBinding Foreground}"
                                  Data="M 0 0.5 L 5 0.5"/>
                            <Path Fill="White"
                                  Data="M 0.5 4 L 6.5 4 L 3.5 7 Z"/>
                            <Path Fill="{TemplateBinding Foreground}"
                                  Data="M -0.5 3 L 5.5 3 L 2.5 6 Z"/>
                        </Canvas>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="true">
                            <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource BorderBrush.Office2003}"/>
                            <Setter TargetName="Bd"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                        </Trigger>

                        <Trigger Property="IsKeyboardFocused"
                                 Value="true">
                            <Setter TargetName="Bd"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="BlueToolBarVerticalOverflowButtonStyle"
           TargetType="{x:Type ToggleButton}">
        <Setter Property="Background"
                Value="{StaticResource MenuItemLeftBarBackground.Blue}"/>
        <Setter Property="MinHeight"
                Value="0"/>
        <Setter Property="MinWidth"
                Value="0"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <Border Name="Bd"
                            CornerRadius="0,0,3,3"
                            Background="{TemplateBinding Background}"
                            SnapsToDevicePixels="true">
                        <Canvas Width="7"
                                Height="6"
                                Margin="2,7,2,2"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Bottom"
                                SnapsToDevicePixels="true">
                            <Path Stroke="White"
                                  Data="M 1.5 1 L 1.5 6"/>
                            <Path Stroke="{TemplateBinding Foreground}"
                                  Data="M 0.5 0 L 0.5 5"/>
                            <Path Fill="White"
                                  Data="M 3.5 0.5 L 7 3.5 L 4 6.5 Z"/>
                            <Path Fill="{TemplateBinding Foreground}"
                                  Data="M 3 -0.5 L 6 2.5 L 3 5.5 Z"/>
                        </Canvas>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="true">

                            <Setter TargetName="Bd" 
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsPressed"
                                 Value="true">
                            <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource BorderBrush.Office2003}"/>
                            <Setter TargetName="Bd" 
                                    Property="Background"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
                        </Trigger>

                        <Trigger Property="IsKeyboardFocused"
                                 Value="true">
                            <Setter TargetName="Bd"
                                    Property="Background"
                                    Value="{StaticResource ButtonMouseOverBrush.Office2003}"/>
                        </Trigger>
                        <Trigger Property="IsEnabled"
                                 Value="false">
                            <Setter Property="Opacity" Value="0.5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="BlueToolBarThumbStyle"
           TargetType="{x:Type Thumb}">

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <Border Padding="{TemplateBinding Padding}"
                            Background="Transparent"
                            SnapsToDevicePixels="True">
                        <Rectangle>
                            <Rectangle.Fill>
                                <DrawingBrush Viewbox="0,0,4,4"
                                              Viewport="0,0,4,4"
                                              TileMode="Tile"
                                              ViewportUnits="Absolute"
                                              ViewboxUnits="Absolute">
                                    <DrawingBrush.Drawing>
                                        <DrawingGroup>
                                            <DrawingGroup.Children>
                                                <GeometryDrawing Brush="White"
                                                                 Geometry="M 1 1 L 1 3 L 3 3 L 3 1 z"/>
                                                <GeometryDrawing Brush="#FF7F9DB9"
                                                                 Geometry="M 0 0 L 0 2 L 2 2 L 2 0 z"/>
                                            </DrawingGroup.Children>
                                        </DrawingGroup>
                                    </DrawingBrush.Drawing>
                                </DrawingBrush>
                            </Rectangle.Fill>
                        </Rectangle>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver"
                                 Value="true">
                            <Setter Property="Cursor"
                                    Value="SizeAll"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <ControlTemplate TargetType="{x:Type ToolBar}" x:Key="Office2003ToolBarTemplate">
        <Grid Name="Grid"
                          Margin="3,1,1,1"
                          SnapsToDevicePixels="true">
            <Grid HorizontalAlignment="Right"
                              x:Name="OverflowGrid">
                <ToggleButton x:Name="OverflowButton"
                                          FocusVisualStyle="{x:Null}"
                                          IsEnabled="{TemplateBinding HasOverflowItems}"
                                          Style="{StaticResource BlueToolBarHorizontalOverflowButtonStyle}"
                                          IsChecked="{Binding Path=IsOverflowOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}"
                                          ClickMode="Press"/>
                <Popup x:Name="OverflowPopup"
                                   AllowsTransparency="true"
                                   Placement="Bottom"
                                   IsOpen="{Binding Path=IsOverflowOpen,RelativeSource={RelativeSource TemplatedParent}}"
                                   StaysOpen="false"
                                   Focusable="false"
                                   PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}">
                    <theme:SystemDropShadowChrome Name="Shdw"
                                                              Color="Transparent">
                        <Border Background="{StaticResource MenuItemLeftBarBackground.Blue}"
                                            BorderBrush="{StaticResource TreeViewFill.Blue}"
                                            BorderThickness="1">
                            <ToolBarOverflowPanel x:Name="PART_ToolBarOverflowPanel"
                                                              Margin="2"
                                                              WrapWidth="200"
                                                              Focusable="true" 
                                                              FocusVisualStyle="{x:Null}"
                                                              KeyboardNavigation.TabNavigation="Cycle"
                                                              KeyboardNavigation.DirectionalNavigation="Cycle"
                                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        </Border>
                    </theme:SystemDropShadowChrome>
                </Popup>
            </Grid>
            <Border x:Name="MainPanelBorder"
                                Margin="0,0,11,0"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3,3,3,3"
                                Padding="{TemplateBinding Padding}">
                <DockPanel KeyboardNavigation.TabIndex="1"
                                       KeyboardNavigation.TabNavigation="Local">
                    <Thumb x:Name="ToolBarThumb"
                                       Style="{StaticResource BlueToolBarThumbStyle}"
                                       Margin="-3,-1,0,0"
                                       Width="10"
                                       Padding="6,5,1,6"/>
                    <ContentPresenter x:Name="ToolBarHeader"
                                                  ContentSource="Header"
                                                  HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"
                                                  Margin="4,0,4,0"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                    <ToolBarPanel x:Name="PART_ToolBarPanel"
                                              IsItemsHost="true"
                                              Margin="0,1,2,2"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                </DockPanel>
            </Border>
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsOverflowOpen"
                                 Value="true">
                <Setter TargetName="ToolBarThumb"
                                    Property="IsEnabled"
                                    Value="false"/>
            </Trigger>
            <Trigger Property="Header"
                                 Value="{x:Null}">
                <Setter TargetName="ToolBarHeader"
                                    Property="Visibility"
                                    Value="Collapsed"/>
            </Trigger>
            <Trigger Property="ToolBarTray.IsLocked"
                                 Value="true">
                <Setter TargetName="ToolBarThumb"
                                    Property="Visibility"
                                    Value="Collapsed"/>
            </Trigger>
            <Trigger SourceName="OverflowPopup"
                                 Property="Popup.HasDropShadow"
                                 Value="true">
                <Setter TargetName="Shdw"
                                    Property="Margin"
                                    Value="0,0,5,5"/>
                <Setter TargetName="Shdw"
                                    Property="SnapsToDevicePixels"
                                    Value="true"/>
                <Setter TargetName="Shdw"
                                    Property="Color"
                                    Value="#71000000"/>
            </Trigger>
            <Trigger Property="Orientation"
                                 Value="Vertical">
                <Setter TargetName="Grid"
                                    Property="Margin"
                                    Value="1,3,1,1"/>
                <Setter TargetName="OverflowButton"
                                    Property="Style"
                                    Value="{StaticResource BlueToolBarVerticalOverflowButtonStyle}"/>
                <Setter TargetName="ToolBarThumb"
                                    Property="Height"
                                    Value="10"/>
                <Setter TargetName="ToolBarThumb"
                                    Property="Width"
                                    Value="Auto"/>
                <Setter TargetName="ToolBarThumb"
                                    Property="Margin"
                                    Value="-1,-3,0,0"/>
                <Setter TargetName="ToolBarThumb"
                                    Property="Padding"
                                    Value="5,6,6,1"/>
                <Setter TargetName="ToolBarHeader"
                                    Property="Margin"
                                    Value="0,0,0,4"/>
                <Setter TargetName="PART_ToolBarPanel"
                                    Property="Margin"
                                    Value="1,0,2,2"/>
                <Setter TargetName="ToolBarThumb"
                                    Property="DockPanel.Dock"
                                    Value="Top"/>
                <Setter TargetName="ToolBarHeader"
                                    Property="DockPanel.Dock"
                                    Value="Top"/>
                <Setter TargetName="OverflowGrid"
                                    Property="HorizontalAlignment"
                                    Value="Stretch"/>
                <Setter TargetName="OverflowGrid"
                                    Property="VerticalAlignment"
                                    Value="Bottom"/>
                <Setter TargetName="OverflowPopup"
                                    Property="Placement"
                                    Value="Right"/>
                <Setter TargetName="MainPanelBorder"
                                    Property="Margin"
                                    Value="0,0,0,11"/>
                <Setter Property="Background"
                                    Value="{StaticResource ToolBarTray.Office2003}"/>
            </Trigger>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
            <Trigger Property="ToggleButton.IsPressed"
                                 Value="true">

                <Setter TargetName="OverflowButton"
                                    Property="Background"
                                    Value="{StaticResource ButtonPressedBrush.Office2003}"/>
                <Setter TargetName="OverflowButton"
                                    Property="BorderBrush"
                                    Value="{StaticResource BorderBrush.Office2003}"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type Label}" x:Key="Office2003LabelTemplate">
        <Border Background="{TemplateBinding Background}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            Padding="{TemplateBinding Padding}"
                            SnapsToDevicePixels="true">
            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                          RecognizesAccessKey="True"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
        </Border>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter Property="Opacity" Value="0.5"/>
            </Trigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>

    <!-- Office2003 -->

    <LinearGradientBrush x:Key="TriangleInner" MappingMode="Absolute" StartPoint="241.030762,459.043945" EndPoint="241.030762,464.498047">
        <LinearGradientBrush.GradientStops>
            <GradientStop Offset="0.000000" Color="#ff404761"/>
            <GradientStop Offset="1.000000" Color="#ff617093"/>
            <GradientStop Offset="0.539326" Color="#ff617093"/>
        </LinearGradientBrush.GradientStops>
        <LinearGradientBrush.Transform>
            <MatrixTransform Matrix="1.000000,0.000000,-0.000000,-1.000000,-197.282227,469.465820" />
        </LinearGradientBrush.Transform>
    </LinearGradientBrush>

    <Style x:Key="ScrollBarDownButtonOffice2003" TargetType="{x:Type RepeatButton}">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="Focusable" Value="false"/>
        <Setter Property="BorderThickness" Value="1"/>


        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Border Width="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" CornerRadius="1" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Name="PART_Repeat" Background="{TemplateBinding Background}">
                        <Path Data="M0,0L3.5,4 7,0z" HorizontalAlignment="Center" Fill="{StaticResource TriangleInner}" Name="Arrow" VerticalAlignment="Center" />
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsPressed" Value="true">
                            <Setter TargetName="PART_Repeat" Property="Background" Value="{StaticResource thumbColorBrush.Blue}"/>
                        </Trigger>

                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="PART_Repeat" Property="Background" Value="{StaticResource thumbMouseOverBrush.Blue}"/>
                        </Trigger>

                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="Fill" TargetName="Arrow" Value="{StaticResource TriangleInner}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <Style x:Key="ScrollBarLeftButtonOffice2003" TargetType="{x:Type RepeatButton}">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="Focusable" Value="false"/>
        <Setter Property="BorderThickness" Value="1"/>

        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Border  CornerRadius="1" Height="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"
									BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Name="PART_Repeat" Background="{TemplateBinding Background}">
                        <Path Data=" M 7 1 L 3 5 L 7 9 z" HorizontalAlignment="Center" Fill="{StaticResource TriangleInner}" Name="Arrow" VerticalAlignment="Center" >
                        </Path>

                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsPressed" Value="true">
                            <Setter TargetName="PART_Repeat" Property="Background" Value="{StaticResource thumbColorBrush.Blue}"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="PART_Repeat" Property="Background" Value="{StaticResource thumbMouseOverBrush.Blue}"/>
                        </Trigger>

                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="Fill" TargetName="Arrow" Value="{StaticResource TriangleInner}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <Style x:Key="ScrollBarRightButtonOffice2003" TargetType="{x:Type RepeatButton}">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="Focusable" Value="false"/>
        <Setter Property="BorderThickness" Value="1"/>

        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">

                    <Border CornerRadius="1" Height="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"
									BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Name="PART_Repeat" Background="{TemplateBinding Background}">

                        <Path Data="M 3 1 L 7 5 L 3 9 z" HorizontalAlignment="Center" Fill="{StaticResource TriangleInner}" Name="Arrow" VerticalAlignment="Center" >

                        </Path>

                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsPressed" Value="true">
                            <Setter TargetName="PART_Repeat" Property="Background" Value="{StaticResource thumbColorBrush.Blue}"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="PART_Repeat" Property="Background" Value="{StaticResource thumbMouseOverBrush.Blue}"/>
                        </Trigger>

                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="Fill" TargetName="Arrow" Value="{StaticResource TriangleInner}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <Style x:Key="ScrollBarUpButtonOffice2003" TargetType="{x:Type RepeatButton}">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="Focusable" Value="false"/>
        <Setter Property="BorderThickness" Value="1"/>

        <Setter Property="Control.Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">

                    <Border Width="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" CornerRadius="1" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Name="PART_Repeat" Background="{TemplateBinding Background}">

                        <Path Data="M0,4 L7,4 3.5,0z" HorizontalAlignment="Center" Fill="{StaticResource TriangleInner}" Name="Arrow" VerticalAlignment="Center" >

                        </Path>

                    </Border>

                    <ControlTemplate.Triggers>
                        <Trigger Property="IsPressed" Value="true">
                            <Setter TargetName="PART_Repeat" Property="Background" Value="{StaticResource thumbColorBrush.Blue}"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="true">
                            <Setter TargetName="PART_Repeat" Property="Background" Value="{StaticResource thumbMouseOverBrush.Blue}"/>
                        </Trigger>

                        <Trigger Property="UIElement.IsEnabled" Value="False">
                            <Setter Property="Fill" TargetName="Arrow" Value="{StaticResource TriangleInner}"/>
                        </Trigger>

                    </ControlTemplate.Triggers>

                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <Style x:Key="ScrollBarVerticalThumbOffice2003" TargetType="{x:Type Thumb}">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="IsTabStop" Value="false"/>
        <Setter Property="Focusable" Value="false"/>
        <Setter Property="Control.Template" >
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">
                    <!--<Grid> 
                    <Border CornerRadius="1" 
									BorderBrush="{StaticResource RepeatOuterBrushes.Office2003}" BorderThickness="1" Name="PART_RepeatThumb" Background="{StaticResource DefaultThumbBrush.Blue}"/>
                           
                                <Border Margin="0" Background="Gray" Width="10" Height="1"></Border>
                    <Border Margin="0,6,0,0" Background="Gray" Width="10" Height="1"></Border>
                    <Border Margin="0,12,0,0" Background="Gray" Width="10" Height="1"></Border>
                    <Border Margin="0,18,0,0" Background="Gray" Width="10" Height="1"></Border>
                       
                   </Grid>-->
                    <Grid>


                        <Border CornerRadius="1" 
									BorderBrush="{StaticResource RepeatOuterBrushes.Office2003}" BorderThickness="1" Name="PART_RepeatThumb" Background="{StaticResource DefaultThumbBrush.Blue}"/>

                        <Grid Height="8">
                            <Grid.RowDefinitions>
                                <RowDefinition />
                                <RowDefinition />
                                <RowDefinition />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Background="Gray" Width="10" Height="1"></Border>
                            <Border Grid.Row="1" Background="Gray" Width="10" Height="1"></Border>

                            <Border Grid.Row="2" Background="Gray" Width="10" Height="1"></Border>

                            <Border Grid.Row="3" Background="Gray" Width="10" Height="1"></Border>

                        </Grid>
                    </Grid>


                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" TargetName="PART_RepeatThumb" Value="{StaticResource thumbMouseOverBrush.Blue}" />
                        </Trigger>
                        <Trigger Property="IsDragging"  Value="True">
                            <Setter Property="Background" TargetName="PART_RepeatThumb" Value="{StaticResource thumbColorBrush.Blue}" />
                        </Trigger>

                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>



    <Style x:Key="ScrollBarHorizontalThumbOffice2003" TargetType="{x:Type Thumb}">
        <Setter Property="SnapsToDevicePixels" Value="True"/>
        <Setter Property="OverridesDefaultStyle" Value="true"/>
        <Setter Property="IsTabStop" Value="false"/>
        <Setter Property="Focusable" Value="false"/>




        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Thumb}">

                    <Grid>
                        <Border CornerRadius="1" 
									BorderBrush="{StaticResource RepeatOuterBrushes.Office2003}" BorderThickness="1" Name="PART_RepeatThumb" Background="{StaticResource DefaultThumbBrush.Blue}"/>
                        <Grid Width="8" >
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            <Border Grid.Column="0" Background="Gray" Width="1" Height="10"></Border>
                            <Border Grid.Column="1" Background="Gray" Width="1" Height="10"></Border>
                            <Border Grid.Column="2" Background="Gray" Width="1" Height="10"></Border>
                            <Border Grid.Column="3" Background="Gray" Width="1" Height="10"></Border>
                        </Grid>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" TargetName="PART_RepeatThumb" Value="{StaticResource thumbMouseOverBrush.Blue}" />
                        </Trigger>
                        <Trigger Property="IsDragging"  Value="True">
                            <Setter Property="Background" TargetName="PART_RepeatThumb" Value="{StaticResource thumbColorBrush.Blue}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="HorizontalScrollBarPageButtonOffice2003"
           TargetType="{x:Type RepeatButton}">
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="Background"
                Value="Transparent"/>
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="IsTabStop"
                Value="false"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Rectangle Fill="{TemplateBinding Background}"
                               Width="{TemplateBinding Width}"
                               Height="{TemplateBinding Height}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="VerticalScrollBarPageButtonOffice2003"
           TargetType="{x:Type RepeatButton}">
        <Setter Property="OverridesDefaultStyle"
                Value="true"/>
        <Setter Property="Background"
                Value="Transparent"/>
        <Setter Property="Focusable"
                Value="false"/>
        <Setter Property="IsTabStop"
                Value="false"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type RepeatButton}">
                    <Rectangle Fill="{TemplateBinding Background}"
                               Width="{TemplateBinding Width}"
                               Height="{TemplateBinding Height}"/>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>


    <ControlTemplate TargetType="{x:Type ScrollBar}" x:Key="Office2003VerticalScrollBarTemplate">
        <Grid Name="Bg"
                          Background="{TemplateBinding Background}"
                          SnapsToDevicePixels="true">
            <Grid.RowDefinitions>
                <RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}"/>
                <RowDefinition Height="0.00001*"/>
                <RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}"/>
            </Grid.RowDefinitions>
            <RepeatButton Name="UpButton" Style="{StaticResource ScrollBarUpButtonOffice2003}"
                                      IsEnabled="{TemplateBinding IsMouseOver}"
                                      Command="{x:Static ScrollBar.LineUpCommand}"
                                      />
            <Track Grid.Row="1" Name="PART_Track"
                               IsEnabled="{TemplateBinding IsMouseOver}"
                               IsDirectionReversed="true">
                <Track.DecreaseRepeatButton>
                    <RepeatButton Style="{StaticResource VerticalScrollBarPageButtonOffice2003}" Command="{x:Static ScrollBar.PageUpCommand}"/>
                </Track.DecreaseRepeatButton>
                <Track.Thumb>
                    <Thumb Style="{StaticResource ScrollBarVerticalThumbOffice2003}"/>
                </Track.Thumb>
                <Track.IncreaseRepeatButton>
                    <RepeatButton Style="{StaticResource VerticalScrollBarPageButtonOffice2003}" Command="{x:Static ScrollBar.PageDownCommand}"/>
                </Track.IncreaseRepeatButton>

            </Track>

            <RepeatButton Name="DownButton" Style="{StaticResource ScrollBarDownButtonOffice2003}"
                                    Grid.Row="2"
                                      IsEnabled="{TemplateBinding IsMouseOver}"
                                      Command="{x:Static ScrollBar.LineDownCommand}"
                                     />
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                 Value="false">
                <Setter TargetName="Bg"
                                    Property="Background"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="UpButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="UpButton" Property="Background" Value="{StaticResource RepeatInnerBrushes.Blue}"/>
                <Setter TargetName="DownButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="DownButton" Property="Background" Value="{StaticResource RepeatInnerBrushes.Blue}"/>
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsMouseOver" SourceName="PART_Track"
                                           Value="False"/>
                    <Condition SourceName="UpButton" Property="IsMouseOver"
                                           Value="True"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="UpButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="UpButton" 
                                    Property="Background"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                <Setter TargetName="DownButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="DownButton" 
                                    Property="Background"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsMouseOver" SourceName="PART_Track"
                                           Value="False"/>
                    <Condition SourceName="DownButton" Property="IsMouseOver"
                                           Value="True"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="UpButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="UpButton" 
                                    Property="Background"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                <Setter TargetName="DownButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="DownButton" 
                                    Property="Background"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
            </MultiTrigger>

        </ControlTemplate.Triggers>
    </ControlTemplate>

    <ControlTemplate TargetType="{x:Type ScrollBar}" x:Key="Office2003HorizontalScrollBarTemplate">
        <Grid Name="Bg" Background="{TemplateBinding Background}"
                                  SnapsToDevicePixels="true">
            <Grid.ColumnDefinitions>
                <ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}"/>
                <ColumnDefinition Width="0.00001*"/>
                <ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}"/>
            </Grid.ColumnDefinitions>
            <RepeatButton Name="LeftButton" Style="{StaticResource ScrollBarLeftButtonOffice2003}"
                                              IsEnabled="{TemplateBinding IsMouseOver}"
                                              Command="{x:Static ScrollBar.LineLeftCommand}"
                                              />
            <Track Grid.Column="1"
                                       Name="PART_Track"
                                       IsEnabled="{TemplateBinding IsMouseOver}">
                <Track.DecreaseRepeatButton>
                    <RepeatButton Style="{StaticResource HorizontalScrollBarPageButtonOffice2003}"
                                                      Command="{x:Static ScrollBar.PageLeftCommand}"/>
                </Track.DecreaseRepeatButton>
                <Track.IncreaseRepeatButton>
                    <RepeatButton Style="{StaticResource HorizontalScrollBarPageButtonOffice2003}"
                                                      Command="{x:Static ScrollBar.PageRightCommand}"/>
                </Track.IncreaseRepeatButton>
                <Track.Thumb>
                    <Thumb Style="{StaticResource ScrollBarHorizontalThumbOffice2003}"
                                               />
                </Track.Thumb>
            </Track>
            <RepeatButton Name="RightButton" Style="{StaticResource ScrollBarRightButtonOffice2003}"
                                              Grid.Column="2"
                                              IsEnabled="{TemplateBinding IsMouseOver}"
                                              Command="{x:Static ScrollBar.LineRightCommand}"
                                              />
        </Grid>
        <ControlTemplate.Triggers>
            <Trigger Property="IsEnabled"
                                         Value="false">
                <Setter TargetName="Bg"
                                            Property="Background"
                                            Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="LeftButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="LeftButton" Property="Background" Value="{StaticResource RepeatInnerBrushes.Blue}"/>
            </Trigger>
            <Trigger Property="IsMouseOver" Value="True">
                <Setter TargetName="RightButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>

                <Setter TargetName="RightButton" Property="Background" Value="{StaticResource RepeatInnerBrushes.Blue}"/>
            </Trigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsMouseOver" SourceName="PART_Track"
                                           Value="False"/>
                    <Condition SourceName="LeftButton" Property="IsMouseOver"
                                           Value="True"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="LeftButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="LeftButton" 
                                    Property="Background"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                <Setter TargetName="RightButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="RightButton" 
                                    Property="Background"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
            </MultiTrigger>
            <MultiTrigger>
                <MultiTrigger.Conditions>
                    <Condition Property="IsMouseOver" SourceName="PART_Track"
                                           Value="False"/>
                    <Condition SourceName="RightButton" Property="IsMouseOver"
                                           Value="True"/>
                </MultiTrigger.Conditions>
                <Setter TargetName="LeftButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="LeftButton" 
                                    Property="Background"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
                <Setter TargetName="RightButton" Property="BorderBrush" Value="{StaticResource RepeatOuterBrushes.Office2003}"/>
                <Setter TargetName="RightButton" 
                                    Property="Background"
                                    Value="{StaticResource ButtonBackgroundBrush.Office2003}"/>
            </MultiTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>




</ResourceDictionary>


