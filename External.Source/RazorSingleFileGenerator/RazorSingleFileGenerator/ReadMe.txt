Most of the code in the VSIX is standard boilerplate that comes from the Single File Generator Sample Deep Dive sample: http://code.msdn.microsoft.com/sfgdd.

The only interesting code is the Razor specific stuff in RazorClassGenerator.cs.