(function(b){var a=b.telerik;a.combobox=function(f,g){b.extend(this,g);var d=b(f);this.element=f;this.$element=d;this.loader=new a.list.loader(this);this.trigger=new a.list.trigger(this);this.$text=d.find("> .t-dropdown-wrap > .t-input").attr("autocomplete","off");this.filtering=new a.list.filtering(this);this.filtering.autoFill=function(m,i){if(m.autoFill&&(m.lastKeyCode!=8&&m.lastKeyCode!=46)){var k=m.$text[0];var j=a.caretPos(k);var n=k.value.substring(0,j);var l=i.toLowerCase().indexOf(n.toLowerCase());if(l!=-1){var o=i.substring(l+n.length);k.value=n+o;a.list.selection(k,j,j+o.length)}}};this.dropDown=new a.dropDown({outerHeight:d.outerHeight(),outerWidth:d.outerWidth(),zIndex:a.list.getZIndex(d),attr:this.dropDownAttr,effects:this.effects,onOpen:b.proxy(function(){var m=this.data;var j=this.dropDown;var l=d.offset();j.position(l.top,l.left);if(!j.outerHeight){j.outerHeight=d.outerHeight()}if(!j.outerWidth){j.outerWidth=d.outerWidth();j.$element.css("width",j.outerWidth-2)}if(m.length==0){return}var i=this.$text.val();var k=this.selectedIndex;if(k!=-1&&this.isFiltered){if(i==m[k].Text){this.filteredDataIndexes=[];j.onItemCreate=null;j.dataBind(this.data);this.select(j.$items[k])}else{this.filters[this.filter](this,this.data,i)}this.isFiltered=false}return true},this),onClick:b.proxy(function(i){this.select(i.item);this.trigger.change(this);this.trigger.close()},this)});this.fill=function(p){function l(s){var r=m.$items;var q=s.index;var u=r.filter(".t-state-selected");var v=u.length;var t=q!=-1&&q<r.length?r[q]:v>0?u[v-1]:null;if(t){s.select(t)}else{s.selectedIndex=-1;if(s.highlightFirst){s.highlight(r[0])}}}var o=this.loader;var m=this.dropDown;var i=this.minChars;var n=this.text();var j=n.length;if(!m.$items&&!o.ajaxError){if(o.isAjax()&&j>=i){var k={};k[this.queryString.text]=n;o.ajaxRequest(function(q){this.data=q;m.dataBind(q);l(this);a.trigger(this.element,"dataBound");this.trigger.change();if(p){p()}},{data:k})}else{m.dataBind(this.data);l(this);if(p){p()}}}};this.reload=function(){this.dropDown.$items=null;this.fill()};this.select=function(j){var k=this.highlight(j);if(k==-1){return k}var i=this.filteredDataIndexes;this.selectedIndex=(i&&i.length)>0?i[k]:k;a.list.updateTextAndValue(this,b(this.dropDown.$items[k]).text(),this.data[this.selectedIndex].Value)};this.text=function(i){return this.$text.val(i)};this.value=function(){if(arguments.length){var i=arguments[0];var j=this.select(function(k){return i==k.Value});if(j==-1){this.$input.val(i);this.text(i)}this.previousValue=this.$input.val()}else{return this.$input.val()}};a.list.common.call(this);a.list.filters.call(this);a.list.initialize.call(this);this.$text.bind({change:b.proxy(function(i){i.stopPropagation()},this),keydown:b.proxy(c,this),keypress:b.proxy(e,this),focus:b.proxy(function(k){var l=this.trigger;var j=this.dropDown;if(!j.$items){this.fill(l.open)}else{l.open()}var i=this.$text;a.list.selection(i[0],0,i.val().length)},this)});d.find("> .t-dropdown-wrap > .t-select").click(b.proxy(function(i){this.loader.ajaxError=false;if(!this.dropDown.isOpened()){this.$text[0].focus()}else{this.trigger.close()}},this));function h(i){clearTimeout(i.timeout);i.timeout=setTimeout(function(){i.filtering.filter(i)},i.delay)}function c(p){var j=this.trigger;var q=this.dropDown;var m=p.keyCode||p.which;this.lastKeyCode=m;if(p.altKey&&m==38){j.close();return}if(p.altKey&&m==40){j.open();return}if(!p.shiftKey&&(m==38||m==40)){p.preventDefault();if(!q.$items){this.fill()}var l=q.$items;var k=l.filter(".t-state-selected:first");var n=k.length==0||l.length==1?l.first():(m==38)?k.prev():(m==40)?k.next():[];if(n.length){var i=n[0];this.select(i);q.scrollTo(i);if(!q.isOpened()){j.change()}}}if(m==8||m==46){var o=this.$text;if(o.val()!=""){h(this)}setTimeout(b.proxy(function(){if(o.val()==""){this.selectedIndex=-1;this.$input.val("")}else{this.$input.val(this.$text.val())}},this),0)}if(m==13){if(q.isOpened()){p.preventDefault()}var r=q.$items.filter(".t-state-selected:first");if(r.length>0){this.select(r[0])}else{this.$input.val(this.$text.val())}j.change();j.close();a.list.moveToEnd(this.$text[0])}if(m==27||m==9){j.change();j.close();if(m==27){this.$text.blur()}}}function e(j){var i=j.keyCode||j.charCode;if(i==0||b.inArray(i,a.list.keycodes)!=-1){return true}this.$input.val(this.$text.val()+String.fromCharCode(i));h(this)}};b.fn.tComboBox=function(c){return a.create(this,{name:"tComboBox",init:function(d,e){return new a.combobox(d,e)},options:c})};b.fn.tComboBox.defaults={effects:a.fx.slide.defaults(),index:-1,autoFill:true,highlightFirst:true,filter:0,delay:200,minChars:0,cache:true,queryString:{text:"text"}}})(jQuery);