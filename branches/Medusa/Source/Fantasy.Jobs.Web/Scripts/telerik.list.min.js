(function(c){var b=c.telerik;var a=parseInt(c.browser.version.substring(0,5).replace(".",""));var f=c.browser.mozilla&&a>=180&&a<=191;b.dropDown=function(h){c.extend(this,h);this.$element=c(new b.stringBuilder().cat("<div ").catIf(h.attr,h.attr).cat(' class="t-popup t-group"><ul class="t-reset">').cat("</ul></div>").string()).hide();var i=this.$element[0];if(!i.style.width){i.style.width=(h.outerWidth?h.outerWidth-2:0)+"px"}if(!i.style.overflowY){i.style.overflowY="auto"}function g(o){var j=new b.stringBuilder();if(o){for(var l=0,n=o.length;l<n;l++){var m=o[l];var k={html:m.Text||m,dataItem:m};if(this.onItemCreate){this.onItemCreate(k)}j.cat('<li class="t-item">').cat(k.html).cat("</li>")}}return j.string()}this.position=function(j,k){this.offset={top:j,left:k}};this.open=function(){if(this.isOpened()||(this.onOpen&&!this.onOpen())){return}var j=this.$element;var k=".t-reset > .t-item";j.delegate(k,"mouseenter",b.hover).delegate(k,"mouseleave",b.leave).delegate(k,"click",c.proxy(function(n){if(this.onClick){this.onClick(c.extend(n,{item:c(n.target).closest(".t-item")[0]}))}},this)).appendTo(document.body);var m=this.offset;m.top+=this.outerHeight;var l=this.zIndex||"auto";if(c.browser.msie&&l=="auto"){l=""}b.fx._wrap(j).css(c.extend({position:"absolute",zIndex:l},this.offset));if(f){j.css("overflow","hidden")}b.fx.play(this.effects,j,{direction:"bottom"},c.proxy(function(){if(f){j.css("overflow","auto")}var n=this.$items.filter(".t-state-selected");if(n.length){this.scrollTo(n[0])}},this))};this.close=function(){if(this.onClose&&!this.onClose()){return}var j=this.$element;if(f){j.css("overflow","hidden")}b.fx.rewind(this.effects,j,{direction:"bottom"},function(){if(f){j.css("overflow","auto")}j.parent().remove()})};this.dataBind=function(n){n=n||[];var l=this.$element;var j=l[0].style.height;var k=j&&j!="auto"?l[0].style.height:"200px";var m=c(g.call(this,n));l.find("> ul").html(m);l.css("height",m.length>10?k:"auto");this.$items=m};this.highlight=function(j){return c(j).addClass("t-state-selected").siblings().removeClass("t-state-selected").end().index()};this.isOpened=function(){return this.$element.is(":visible")};this.scrollTo=function(p){if(!p){return}var n=p.offsetTop;var j=p.offsetHeight;var k=this.$element[0];var l=k.scrollTop;var m=k.clientHeight;var o=n+j;k.scrollTop=l>n?n:o>(l+m)?o-m:l}};b.list={initialize:function(){this.$input=this.$element.find("input:last");this.previousValue=this.value();b.bind(this,{dataBinding:this.onDataBinding,dataBound:this.onDataBound,error:this.onError,open:this.onOpen,close:this.onClose,valueChange:this.onChange,load:this.onLoad});c(document).bind("mousedown",c.proxy(function(i){var g=this.dropDown.$element;var h=g&&g.parent().length>0;if(h&&!c.contains(this.element,i.target)&&!c.contains(g.parent()[0],i.target)){this.trigger.change();this.trigger.close()}},this))},common:function(){this.open=function(){if(this.data.length==0){return}var g=this.dropDown;if(g.$items){g.open()}else{this.fill(function(){g.open()})}};this.close=function(){this.dropDown.close()};this.dataBind=function(g){this.data=g||[];this.dropDown.dataBind(this.data)};this.highlight=function(j){var l=-1;var h=function(m){var i=m.previousValue;m.close();m.dataBind(m.data);m.previousValue=i;m.dropDown.$items.removeClass("t-state-selected").eq(l).addClass("t-state-selected")};if(!isNaN(j-0)){if(j>-1&&j<this.data.length){l=j;h(this)}}else{if(c.isFunction(j)){for(var k=0,g=this.data.length;k<g;k++){if(j(this.data[k])){l=k;break}}if(l!=-1){h(this)}}else{l=this.dropDown.highlight(j)}}return l}},filtering:function(){this.filter=function(r){r.isFiltered=true;var n=true;var m=r.data;var o=r.$text[0];var q=o.value;var g=r.trigger;var p=r.dropDown;q=this.multiple(q);if(q.length<r.minChars){return}var k=r.filter;if(r.loader.isAjax()){if(r.cache&&m&&m.length>0){r.filters[k](r,m,q);var t=r.filteredDataIndexes;if((t&&t.length>0)||(k==0&&r.selectedIndex!=-1)){n=false}}if(n){var l={};l[r.queryString.text]=q;r.loader.ajaxRequest(function(x){var v=r.trigger;var u=r.dropDown;if(x&&x.length==0){r.close();r.dataBind();return}r.data=x;b.trigger(r.element,"dataBound");r.filters[k](r,x,q);var w=u.$items;if(w.length>0){if(!u.isOpened()){v.open()}r.filtering.autoFill(r,w.first().text())}else{v.close()}},{data:l})}}else{n=false;r.filters[k](r,r.data,q)}if(!n){var i=p.$items;var j=i.length;var h=r.selectedIndex;var s=k==0?h!=-1?i[h].innerText||i[h].textContent:"":i.length>0?i.first().text():"";this.autoFill(r,s);if(j==0){g.close()}else{if(!p.isOpened()){g.open()}}}};this.multiple=function(g){return g}},filters:function(){this.filters=[function g(k,m,j){if(!m||m.length==0){return}var o=k.dropDown;var n=o.$items;if(n.length==0||k.loader.isAjax()){o.dataBind(m);n=o.$items}for(var h=0,p=m.length;h<p;h++){if(m[h].Text.slice(0,j.length).toLowerCase()==j.toLowerCase()){var l=n[h];k.selectedIndex=h;o.highlight(l);o.scrollTo(l);return}}n.removeClass("t-state-selected");k.selectedIndex=-1;b.list.highlightFirstOnFilter(k,n)},e(false,function(i,h){return h.slice(0,i.length).toLowerCase()==i.toLowerCase()}),e(true,function(i,h){return h&&h.toLowerCase().indexOf(i.toLowerCase())!=-1})]},loader:function(g){this.ajaxError=false;this.component=g;this.isAjax=function(){return g.ajax||g.ws||g.onDataBinding};function h(i,k){var j={url:(g.ajax||g.ws)["selectUrl"],type:"POST",data:{},dataType:"text",error:function(m,l){g.loader.ajaxError=true;if(b.ajaxError(g.element,"error",m,l)){return}},complete:c.proxy(function(){this.hideBusy()},g.loader),success:function(o,l,n){try{o=eval("("+o+")")}catch(m){if(!b.ajaxError(g.element,"error",n,"parseeror")){alert("Error! The requested URL did not return JSON.")}g.loader.ajaxError=true;return}o=o.d||o;if(i){i.call(g,o)}}};c.extend(j,k);if(g.ws){j.data=b.toJson(j.data);j.contentType="application/json; charset=utf-8"}return j}this.ajaxRequest=function(i,j){var k={};if(b.trigger(g.element,"dataBinding",k)){return}if(g.ajax||g.ws){this.showBusy();c.ajax(h(i,{data:c.extend({},j?j.data:{},k.data)}))}else{if(i){i.call(g,g.data)}}},this.showBusy=function(){this.busyTimeout=setTimeout(c.proxy(function(){this.component.$element.find("> .t-dropdown-wrap .t-icon").addClass("t-loading")},this),100)},this.hideBusy=function(){clearTimeout(this.busyTimeout);this.component.$element.find("> .t-dropdown-wrap .t-icon").removeClass("t-loading")}},trigger:function(g){this.component=g;this.change=function(){var m=g.data;var n=g.text();var p=n.toLowerCase();var j=g.previousValue;for(var h=0,o=m.length;h<o;h++){var k=m[h];if((k.Text?k.Text:k).toLowerCase()==p){g.text(k.Text);g.$input.val(m[h].Value);break}}var l=g.value();if(j==undefined||l!=j){b.trigger(g.element,"valueChange",{value:l})}g.previousValue=l};this.open=function(){var h=g.dropDown;if((h.$items&&h.$items.length>0)&&!h.isOpened()&&!b.trigger(g.element,"open")){g.open()}};this.close=function(){if(!g.dropDown.$element.is(":animated")&&g.dropDown.isOpened()&&!b.trigger(g.element,"close")){g.close()}}},highlightFirstOnFilter:function(h,g){if(h.highlightFirst){g.first().addClass("t-state-selected");h.dropDown.scrollTo(g[0])}},moveToEnd:function(h){if(h.createTextRange){var g=h.createTextRange();g.moveStart("textedit",1);g.select()}},selection:function(i,g,j){if(i.createTextRange){var h=i.createTextRange();h.collapse(true);h.moveStart("character",g);h.moveEnd("character",j-g);h.select()}else{if(i.selectionStart){i.selectionStart=g;i.selectionEnd=j}}},updateTextAndValue:function(h,i,g){h.text(i);if(g||g==0){h.$input.val(g)}else{h.$input.val(i)}},getZIndex:function(h){var g="auto";c(h).parents().andSelf().each(function(){g=c(this).css("zIndex");if(Number(g)){g=Number(g)+1;return false}});return g},keycodes:[8,9,13,27,37,38,39,40,35,36,46]};function e(g,h){return function(m,o,n){if(!o||o.length==0){return}var l=c.map(o,function(p,q){if(h(n,p.Text||p)){return q}});var i=l.length;var k=new RegExp("(?![^&;]+;)(?!<[^<>]*)("+n.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)",g?"ig":"i");m.filteredDataIndexes=l;m.selectedIndex=-1;m.dropDown.onItemCreate=function(p){p.html=p.html.replace(k,"<strong>$1</strong>")};m.dropDown.dataBind(c.map(l,function(p,q){return o[p]}));var j=m.dropDown.$items;j.removeClass("t-state-selected");b.list.highlightFirstOnFilter(m,j)}}function d(m,j,h){if(!m||!j){return null}var g=h.length;h=h.toLowerCase();for(var k=0,l=m.length;k<l;k++){if(m[k].Text.slice(0,g).toLowerCase()==h){return j[k]}}}b.dropDownList=function(j,k){c.extend(this,k);var g="";var h=c(j);if(!h.attr("tabIndex")){h.attr("tabIndex",0)}this.element=j;this.$element=h;this.loader=new b.list.loader(this);this.trigger=new b.list.trigger(this);this.$text=h.find("> .t-dropdown-wrap > .t-input");this.dropDown=new b.dropDown({outerHeight:h.outerHeight(),outerWidth:h.outerWidth(),zIndex:b.list.getZIndex(h),attr:this.dropDownAttr,effects:this.effects,onOpen:c.proxy(function(){var n=this.dropDown;var o=h.offset();n.position(o.top,o.left);if(!n.outerHeight){n.outerHeight=h.outerHeight()}if(!n.outerWidth){n.outerWidth=h.outerWidth();n.$element.css("width",n.outerWidth-2)}return true},this),onClick:c.proxy(function(n){this.select(n.item);this.trigger.change();this.trigger.close()},this)});this.fill=function(q){function p(t){var s=t.dropDown.$items;var r=t.index;var v=s.filter(".t-state-selected");var w=v.length;var u=r!=-1&&r<s.length?s[r]:w>0?v[w-1]:s[0];t.select(u)}var o=this.dropDown;var n=this.loader;if(!o.$items&&!n.ajaxError){if(n.isAjax()){n.ajaxRequest(function(r){this.data=r;o.dataBind(r);p(this);b.trigger(this.element,"dataBound");this.trigger.change();if(q){q()}})}else{o.dataBind(this.data);p(this);if(q){q()}}}};this.reload=function(){this.dropDown.$items=null;this.fill()};this.select=function(n){var o=this.highlight(n);if(o==-1){return o}this.selectedIndex=o;b.list.updateTextAndValue(this,c(this.dropDown.$items[o]).text(),this.data[o].Value)},this.text=function(n){return this.$text.html(n)};this.value=function(n){if(arguments.length){var n=arguments[0];var o=this.select(function(p){return n==p.Value});if(o!=-1){this.previousValue=n}}else{return this.$input.val()}};b.list.common.call(this);b.list.initialize.call(this);h.bind({keydown:c.proxy(i,this),keypress:c.proxy(l,this),click:c.proxy(function(o){var p=this.trigger;var n=this.dropDown;h.focus();if(n.isOpened()){p.close()}else{if(!n.$items){this.fill(p.open)}else{p.open()}}},this)});function m(){clearTimeout(this.timeout);this.timeout=setTimeout(c.proxy(function(){g=""},this),1000)}function i(t){var o=this.trigger;var u=this.dropDown;var r=t.keyCode||t.which;if(t.altKey&&r==38){o.close();return}if(t.altKey&&r==40){o.open();return}if(r>34&&r<41){t.preventDefault();if(!u.$items){this.fill();return}var q=u.$items;var p=c(q[this.selectedIndex]);var s=(r==35)?q.last():(r==36)?q.first():(r==37||r==38)?p.prev():(r==39||r==40)?p.next():[];if(s.length){var n=s[0];this.select(n);u.scrollTo(n);if(!u.isOpened()){o.change()}}}if(r==8){m();t.preventDefault();g=g.slice(0,-1)}if(r==9||r==13||r==27){o.change();o.close()}}function l(r){var p=this.dropDown;var o=r.keyCode||r.charCode;if(o==0||c.inArray(o,b.list.keycodes)!=-1||r.ctrlKey||r.altKey||r.shiftKey){return}if(!p.$items){this.fill();return}var n=g;n+=String.fromCharCode(o);if(n){var q=d(this.data,p.$items,n);if(q){this.select(q);p.scrollTo(q)}g=n}m()}};c.fn.tDropDownList=function(g){return b.create(this,{name:"tDropDownList",init:function(h,i){return new b.dropDownList(h,i)},options:g})};c.fn.tDropDownList.defaults={effects:b.fx.slide.defaults(),index:0}})(jQuery);